2025-07-01 13:35:21,888 - INFO - Starting RF measurement script
2025-07-01 13:35:21,891 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 13:35:21,891 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 13:35:21,892 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.481, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 13:35:21,892 - INFO - Generated 5 frequencies: [2.4, 2.42025, 2.4405, 2.46075, 2.481] GHz
2025-07-01 13:35:21,893 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 13:35:21,893 - DEBUG - Initializing new STN instrument
2025-07-01 13:35:21,893 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 13:35:21,900 - INFO - Connected to 192.168.200.20:5025
2025-07-01 13:35:21,900 - INFO - Query: *IDN?
2025-07-01 13:35:21,918 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 13:35:21,921 - INFO - Connected to 192.168.200.10:5025
2025-07-01 13:35:21,921 - INFO - Query: *IDN?
2025-07-01 13:35:21,922 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 13:35:21,922 - INFO - Write: OUTP:STAT OFF
2025-07-01 13:35:21,922 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 13:35:21,922 - DEBUG - Calling VSA_Config
2025-07-01 13:35:21,922 - INFO - Configuring VSA for STN
2025-07-01 13:35:21,922 - INFO - Query: *RST;*OPC?
2025-07-01 13:35:22,122 - INFO - Response: 1
2025-07-01 13:35:22,122 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:35:22,123 - INFO - Response: 1
2025-07-01 13:35:22,123 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 13:35:22,123 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:35:22,124 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:35:22,124 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:35:22,124 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:35:22,124 - INFO - Write: :INP:ATT 0
2025-07-01 13:35:22,124 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:35:22,124 - INFO - Configuring noise marker for STN
2025-07-01 13:35:22,124 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:35:22,124 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:35:22,124 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:35:22,124 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:35:22,124 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:35:22,125 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 13:35:22,125 - INFO - Clearing error queue
2025-07-01 13:35:22,125 - INFO - Query: :SYST:ERR?
2025-07-01 13:35:22,255 - INFO - Response: 0,"No error"
2025-07-01 13:35:22,256 - DEBUG - Running STN iteration 1
2025-07-01 13:35:22,256 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:35:22,256 - INFO - Write: INIT:CONT OFF
2025-07-01 13:35:22,256 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:35:23,302 - INFO - Response: 1
2025-07-01 13:35:23,303 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:35:23,306 - INFO - Response: -165.412015915
2025-07-01 13:35:23,307 - INFO - Noise marker measured: -165.41 dBm
2025-07-01 13:35:23,307 - INFO - STN iteration 1: marker=-165.41dBm, meas_time=1.051sec
2025-07-01 13:35:23,307 - INFO - Preparing STN test set 2 at 2.420 GHz
2025-07-01 13:35:23,307 - DEBUG - Reusing STN instrument, setting freq to 2420250000.000 Hz
2025-07-01 13:35:23,307 - INFO - Setting STN frequency to 2.420GHz
2025-07-01 13:35:23,307 - INFO - Write: :SENS:FREQ:CENT 2420250000.0
2025-07-01 13:35:23,307 - INFO - Write: :CALC1:MARK1:X 2420250000.0
2025-07-01 13:35:23,307 - INFO - Query: *OPC?
2025-07-01 13:35:23,349 - INFO - Response: 1
2025-07-01 13:35:23,350 - DEBUG - Starting STN test set 2: freq=2.420GHz, iterations=1
2025-07-01 13:35:23,350 - DEBUG - Calling VSA_Config
2025-07-01 13:35:23,350 - INFO - Configuring VSA for STN
2025-07-01 13:35:23,350 - INFO - Query: *RST;*OPC?
2025-07-01 13:35:23,562 - INFO - Response: 1
2025-07-01 13:35:23,563 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:35:23,564 - INFO - Response: 1
2025-07-01 13:35:23,564 - INFO - Write: :SENS:FREQ:CENT 2420250000.0
2025-07-01 13:35:23,564 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:35:23,564 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:35:23,564 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:35:23,565 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:35:23,565 - INFO - Write: :INP:ATT 0
2025-07-01 13:35:23,565 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:35:23,565 - INFO - Configuring noise marker for STN
2025-07-01 13:35:23,565 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:35:23,565 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:35:23,565 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:35:23,565 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:35:23,565 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:35:23,565 - INFO - Write: :CALC1:MARK1:X 2420250000.0
2025-07-01 13:35:23,565 - INFO - Clearing error queue
2025-07-01 13:35:23,565 - INFO - Query: :SYST:ERR?
2025-07-01 13:35:23,701 - INFO - Response: 0,"No error"
2025-07-01 13:35:23,702 - DEBUG - Running STN iteration 1
2025-07-01 13:35:23,702 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:35:23,702 - INFO - Write: INIT:CONT OFF
2025-07-01 13:35:23,702 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:35:24,761 - INFO - Response: 1
2025-07-01 13:35:24,761 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:35:24,762 - INFO - Response: -165.74505806
2025-07-01 13:35:24,762 - INFO - Noise marker measured: -165.75 dBm
2025-07-01 13:35:24,762 - INFO - STN iteration 1: marker=-165.75dBm, meas_time=1.060sec
2025-07-01 13:35:24,762 - INFO - Preparing STN test set 3 at 2.441 GHz
2025-07-01 13:35:24,762 - DEBUG - Reusing STN instrument, setting freq to 2440500000.000 Hz
2025-07-01 13:35:24,762 - INFO - Setting STN frequency to 2.441GHz
2025-07-01 13:35:24,762 - INFO - Write: :SENS:FREQ:CENT 2440500000.0
2025-07-01 13:35:24,762 - INFO - Write: :CALC1:MARK1:X 2440500000.0
2025-07-01 13:35:24,762 - INFO - Query: *OPC?
2025-07-01 13:35:24,819 - INFO - Response: 1
2025-07-01 13:35:24,820 - DEBUG - Starting STN test set 3: freq=2.441GHz, iterations=1
2025-07-01 13:35:24,820 - DEBUG - Calling VSA_Config
2025-07-01 13:35:24,820 - INFO - Configuring VSA for STN
2025-07-01 13:35:24,820 - INFO - Query: *RST;*OPC?
2025-07-01 13:35:25,031 - INFO - Response: 1
2025-07-01 13:35:25,032 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:35:25,033 - INFO - Response: 1
2025-07-01 13:35:25,033 - INFO - Write: :SENS:FREQ:CENT 2440500000.0
2025-07-01 13:35:25,033 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:35:25,034 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:35:25,034 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:35:25,034 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:35:25,034 - INFO - Write: :INP:ATT 0
2025-07-01 13:35:25,034 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:35:25,034 - INFO - Configuring noise marker for STN
2025-07-01 13:35:25,034 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:35:25,034 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:35:25,034 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:35:25,034 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:35:25,034 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:35:25,034 - INFO - Write: :CALC1:MARK1:X 2440500000.0
2025-07-01 13:35:25,035 - INFO - Clearing error queue
2025-07-01 13:35:25,035 - INFO - Query: :SYST:ERR?
2025-07-01 13:35:25,170 - INFO - Response: 0,"No error"
2025-07-01 13:35:25,171 - DEBUG - Running STN iteration 1
2025-07-01 13:35:25,171 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:35:25,171 - INFO - Write: INIT:CONT OFF
2025-07-01 13:35:25,171 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:35:26,216 - INFO - Response: 1
2025-07-01 13:35:26,217 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:35:26,218 - INFO - Response: -165.582208633
2025-07-01 13:35:26,218 - INFO - Noise marker measured: -165.58 dBm
2025-07-01 13:35:26,219 - INFO - STN iteration 1: marker=-165.58dBm, meas_time=1.048sec
2025-07-01 13:35:26,219 - INFO - Preparing STN test set 4 at 2.461 GHz
2025-07-01 13:35:26,219 - DEBUG - Reusing STN instrument, setting freq to 2460750000.000 Hz
2025-07-01 13:35:26,219 - INFO - Setting STN frequency to 2.461GHz
2025-07-01 13:35:26,219 - INFO - Write: :SENS:FREQ:CENT 2460750000.0
2025-07-01 13:35:26,219 - INFO - Write: :CALC1:MARK1:X 2460750000.0
2025-07-01 13:35:26,219 - INFO - Query: *OPC?
2025-07-01 13:35:26,269 - INFO - Response: 1
2025-07-01 13:35:26,269 - DEBUG - Starting STN test set 4: freq=2.461GHz, iterations=1
2025-07-01 13:35:26,269 - DEBUG - Calling VSA_Config
2025-07-01 13:35:26,269 - INFO - Configuring VSA for STN
2025-07-01 13:35:26,269 - INFO - Query: *RST;*OPC?
2025-07-01 13:35:26,495 - INFO - Response: 1
2025-07-01 13:35:26,496 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:35:26,531 - INFO - Response: 1
2025-07-01 13:35:26,531 - INFO - Write: :SENS:FREQ:CENT 2460750000.0
2025-07-01 13:35:26,531 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:35:26,531 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:35:26,532 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:35:26,532 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:35:26,532 - INFO - Write: :INP:ATT 0
2025-07-01 13:35:26,532 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:35:26,532 - INFO - Configuring noise marker for STN
2025-07-01 13:35:26,532 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:35:26,532 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:35:26,532 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:35:26,532 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:35:26,532 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:35:26,532 - INFO - Write: :CALC1:MARK1:X 2460750000.0
2025-07-01 13:35:26,532 - INFO - Clearing error queue
2025-07-01 13:35:26,532 - INFO - Query: :SYST:ERR?
2025-07-01 13:35:26,672 - INFO - Response: 0,"No error"
2025-07-01 13:35:26,672 - DEBUG - Running STN iteration 1
2025-07-01 13:35:26,672 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:35:26,672 - INFO - Write: INIT:CONT OFF
2025-07-01 13:35:26,672 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:35:27,730 - INFO - Response: 1
2025-07-01 13:35:27,730 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:35:27,732 - INFO - Response: -165.492506027
2025-07-01 13:35:27,732 - INFO - Noise marker measured: -165.49 dBm
2025-07-01 13:35:27,732 - INFO - STN iteration 1: marker=-165.49dBm, meas_time=1.060sec
2025-07-01 13:35:27,732 - INFO - Preparing STN test set 5 at 2.481 GHz
2025-07-01 13:35:27,732 - DEBUG - Reusing STN instrument, setting freq to 2481000000.000 Hz
2025-07-01 13:35:27,732 - INFO - Setting STN frequency to 2.481GHz
2025-07-01 13:35:27,732 - INFO - Write: :SENS:FREQ:CENT 2481000000.0
2025-07-01 13:35:27,732 - INFO - Write: :CALC1:MARK1:X 2481000000.0
2025-07-01 13:35:27,732 - INFO - Query: *OPC?
2025-07-01 13:35:27,778 - INFO - Response: 1
2025-07-01 13:35:27,778 - DEBUG - Starting STN test set 5: freq=2.481GHz, iterations=1
2025-07-01 13:35:27,778 - DEBUG - Calling VSA_Config
2025-07-01 13:35:27,778 - INFO - Configuring VSA for STN
2025-07-01 13:35:27,778 - INFO - Query: *RST;*OPC?
2025-07-01 13:35:27,998 - INFO - Response: 1
2025-07-01 13:35:27,998 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:35:28,034 - INFO - Response: 1
2025-07-01 13:35:28,034 - INFO - Write: :SENS:FREQ:CENT 2481000000.0
2025-07-01 13:35:28,035 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:35:28,035 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:35:28,035 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:35:28,035 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:35:28,035 - INFO - Write: :INP:ATT 0
2025-07-01 13:35:28,035 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:35:28,035 - INFO - Configuring noise marker for STN
2025-07-01 13:35:28,035 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:35:28,036 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:35:28,036 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:35:28,036 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:35:28,036 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:35:28,036 - INFO - Write: :CALC1:MARK1:X 2481000000.0
2025-07-01 13:35:28,036 - INFO - Clearing error queue
2025-07-01 13:35:28,036 - INFO - Query: :SYST:ERR?
2025-07-01 13:35:28,164 - INFO - Response: 0,"No error"
2025-07-01 13:35:28,164 - DEBUG - Running STN iteration 1
2025-07-01 13:35:28,164 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:35:28,164 - INFO - Write: INIT:CONT OFF
2025-07-01 13:35:28,164 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:35:29,216 - INFO - Response: 1
2025-07-01 13:35:29,216 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:35:29,217 - INFO - Response: -165.433425903
2025-07-01 13:35:29,218 - INFO - Noise marker measured: -165.43 dBm
2025-07-01 13:35:29,218 - INFO - STN iteration 1: marker=-165.43dBm, meas_time=1.053sec
2025-07-01 13:35:29,218 - INFO - Closing VSA and VSG connections
2025-07-01 13:35:29,218 - INFO - Socket closed
2025-07-01 13:35:29,218 - INFO - Socket closed
2025-07-01 13:35:29,218 - INFO - Connections closed successfully
2025-07-01 13:35:29,220 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 13:35:29,501 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 13:35:29,553 - INFO - Socket closed
2025-07-01 13:35:29,554 - INFO - Socket closed
2025-07-01 13:55:13,596 - INFO - Starting RF measurement script
2025-07-01 13:55:13,598 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 13:55:13,598 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 13:55:13,598 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.481, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 13:55:13,598 - INFO - Generated 5 frequencies: [2.4, 2.42025, 2.4405, 2.46075, 2.481] GHz
2025-07-01 13:55:13,598 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 13:55:13,598 - DEBUG - Initializing new STN instrument
2025-07-01 13:55:13,598 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 13:55:13,602 - INFO - Connected to 192.168.200.20:5025
2025-07-01 13:55:13,602 - INFO - Query: *IDN?
2025-07-01 13:55:13,613 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 13:55:13,615 - INFO - Connected to 192.168.200.10:5025
2025-07-01 13:55:13,615 - INFO - Query: *IDN?
2025-07-01 13:55:13,616 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 13:55:13,616 - INFO - Write: OUTP:STAT OFF
2025-07-01 13:55:13,616 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 13:55:13,616 - DEBUG - Calling VSA_Config
2025-07-01 13:55:13,616 - INFO - Configuring VSA for STN
2025-07-01 13:55:13,616 - INFO - Query: *RST;*OPC?
2025-07-01 13:55:13,962 - INFO - Response: 1
2025-07-01 13:55:13,962 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:55:13,963 - INFO - Response: 1
2025-07-01 13:55:13,963 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 13:55:13,963 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:55:13,964 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:55:13,964 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:55:13,964 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:55:13,964 - INFO - Write: :INP:ATT 0
2025-07-01 13:55:13,964 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:55:13,964 - INFO - Configuring noise marker for STN
2025-07-01 13:55:13,964 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:55:13,964 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:55:13,964 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:55:13,964 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:55:13,964 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:55:13,964 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 13:55:13,964 - INFO - Clearing error queue
2025-07-01 13:55:13,964 - INFO - Query: :SYST:ERR?
2025-07-01 13:55:14,099 - INFO - Response: 0,"No error"
2025-07-01 13:55:14,099 - DEBUG - Running STN iteration 1
2025-07-01 13:55:14,099 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:55:14,099 - INFO - Write: INIT:CONT OFF
2025-07-01 13:55:14,100 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:55:15,158 - INFO - Response: 1
2025-07-01 13:55:15,158 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:55:15,160 - INFO - Response: -165.41893959
2025-07-01 13:55:15,160 - INFO - Noise marker measured: -165.42 dBm
2025-07-01 13:55:15,160 - INFO - STN iteration 1: marker=-165.42dBm, meas_time=1.061sec
2025-07-01 13:55:15,161 - INFO - Preparing STN test set 2 at 2.420 GHz
2025-07-01 13:55:15,161 - DEBUG - Reusing STN instrument, setting freq to 2420250000.000 Hz
2025-07-01 13:55:15,161 - INFO - Setting STN frequency to 2.420GHz
2025-07-01 13:55:15,161 - INFO - Write: :SENS:FREQ:CENT 2420250000.0
2025-07-01 13:55:15,161 - INFO - Write: :CALC1:MARK1:X 2420250000.0
2025-07-01 13:55:15,162 - INFO - Query: *OPC?
2025-07-01 13:55:15,205 - INFO - Response: 1
2025-07-01 13:55:15,205 - DEBUG - Starting STN test set 2: freq=2.420GHz, iterations=1
2025-07-01 13:55:15,205 - DEBUG - Calling VSA_Config
2025-07-01 13:55:15,205 - INFO - Configuring VSA for STN
2025-07-01 13:55:15,205 - INFO - Query: *RST;*OPC?
2025-07-01 13:55:15,452 - INFO - Response: 1
2025-07-01 13:55:15,453 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:55:15,454 - INFO - Response: 1
2025-07-01 13:55:15,454 - INFO - Write: :SENS:FREQ:CENT 2420250000.0
2025-07-01 13:55:15,454 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:55:15,454 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:55:15,454 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:55:15,454 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:55:15,454 - INFO - Write: :INP:ATT 0
2025-07-01 13:55:15,455 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:55:15,455 - INFO - Configuring noise marker for STN
2025-07-01 13:55:15,455 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:55:15,455 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:55:15,455 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:55:15,455 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:55:15,455 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:55:15,455 - INFO - Write: :CALC1:MARK1:X 2420250000.0
2025-07-01 13:55:15,455 - INFO - Clearing error queue
2025-07-01 13:55:15,455 - INFO - Query: :SYST:ERR?
2025-07-01 13:55:15,590 - INFO - Response: 0,"No error"
2025-07-01 13:55:15,591 - DEBUG - Running STN iteration 1
2025-07-01 13:55:15,591 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:55:15,591 - INFO - Write: INIT:CONT OFF
2025-07-01 13:55:15,591 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:55:16,683 - INFO - Response: 1
2025-07-01 13:55:16,683 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:55:16,685 - INFO - Response: -165.720014572
2025-07-01 13:55:16,685 - INFO - Noise marker measured: -165.72 dBm
2025-07-01 13:55:16,685 - INFO - STN iteration 1: marker=-165.72dBm, meas_time=1.094sec
2025-07-01 13:55:16,686 - INFO - Preparing STN test set 3 at 2.441 GHz
2025-07-01 13:55:16,686 - DEBUG - Reusing STN instrument, setting freq to 2440500000.000 Hz
2025-07-01 13:55:16,686 - INFO - Setting STN frequency to 2.441GHz
2025-07-01 13:55:16,686 - INFO - Write: :SENS:FREQ:CENT 2440500000.0
2025-07-01 13:55:16,687 - INFO - Write: :CALC1:MARK1:X 2440500000.0
2025-07-01 13:55:16,687 - INFO - Query: *OPC?
2025-07-01 13:55:16,731 - INFO - Response: 1
2025-07-01 13:55:16,731 - DEBUG - Starting STN test set 3: freq=2.441GHz, iterations=1
2025-07-01 13:55:16,731 - DEBUG - Calling VSA_Config
2025-07-01 13:55:16,731 - INFO - Configuring VSA for STN
2025-07-01 13:55:16,731 - INFO - Query: *RST;*OPC?
2025-07-01 13:55:16,977 - INFO - Response: 1
2025-07-01 13:55:16,977 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:55:16,978 - INFO - Response: 1
2025-07-01 13:55:16,979 - INFO - Write: :SENS:FREQ:CENT 2440500000.0
2025-07-01 13:55:16,979 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:55:16,979 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:55:16,979 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:55:16,979 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:55:16,979 - INFO - Write: :INP:ATT 0
2025-07-01 13:55:16,979 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:55:16,980 - INFO - Configuring noise marker for STN
2025-07-01 13:55:16,980 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:55:16,980 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:55:16,980 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:55:16,980 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:55:16,980 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:55:16,980 - INFO - Write: :CALC1:MARK1:X 2440500000.0
2025-07-01 13:55:16,980 - INFO - Clearing error queue
2025-07-01 13:55:16,980 - INFO - Query: :SYST:ERR?
2025-07-01 13:55:17,118 - INFO - Response: 0,"No error"
2025-07-01 13:55:17,118 - DEBUG - Running STN iteration 1
2025-07-01 13:55:17,118 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:55:17,118 - INFO - Write: INIT:CONT OFF
2025-07-01 13:55:17,119 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:55:18,197 - INFO - Response: 1
2025-07-01 13:55:18,197 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:55:18,199 - INFO - Response: -165.57050705
2025-07-01 13:55:18,199 - INFO - Noise marker measured: -165.57 dBm
2025-07-01 13:55:18,199 - INFO - STN iteration 1: marker=-165.57dBm, meas_time=1.081sec
2025-07-01 13:55:18,199 - INFO - Preparing STN test set 4 at 2.461 GHz
2025-07-01 13:55:18,199 - DEBUG - Reusing STN instrument, setting freq to 2460750000.000 Hz
2025-07-01 13:55:18,200 - INFO - Setting STN frequency to 2.461GHz
2025-07-01 13:55:18,200 - INFO - Write: :SENS:FREQ:CENT 2460750000.0
2025-07-01 13:55:18,200 - INFO - Write: :CALC1:MARK1:X 2460750000.0
2025-07-01 13:55:18,200 - INFO - Query: *OPC?
2025-07-01 13:55:18,242 - INFO - Response: 1
2025-07-01 13:55:18,243 - DEBUG - Starting STN test set 4: freq=2.461GHz, iterations=1
2025-07-01 13:55:18,243 - DEBUG - Calling VSA_Config
2025-07-01 13:55:18,243 - INFO - Configuring VSA for STN
2025-07-01 13:55:18,243 - INFO - Query: *RST;*OPC?
2025-07-01 13:55:18,490 - INFO - Response: 1
2025-07-01 13:55:18,490 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:55:18,492 - INFO - Response: 1
2025-07-01 13:55:18,492 - INFO - Write: :SENS:FREQ:CENT 2460750000.0
2025-07-01 13:55:18,492 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:55:18,493 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:55:18,493 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:55:18,493 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:55:18,493 - INFO - Write: :INP:ATT 0
2025-07-01 13:55:18,494 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:55:18,494 - INFO - Configuring noise marker for STN
2025-07-01 13:55:18,494 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:55:18,495 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:55:18,495 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:55:18,495 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:55:18,495 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:55:18,495 - INFO - Write: :CALC1:MARK1:X 2460750000.0
2025-07-01 13:55:18,496 - INFO - Clearing error queue
2025-07-01 13:55:18,496 - INFO - Query: :SYST:ERR?
2025-07-01 13:55:18,629 - INFO - Response: 0,"No error"
2025-07-01 13:55:18,629 - DEBUG - Running STN iteration 1
2025-07-01 13:55:18,630 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:55:18,630 - INFO - Write: INIT:CONT OFF
2025-07-01 13:55:18,630 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:55:19,721 - INFO - Response: 1
2025-07-01 13:55:19,721 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:55:19,723 - INFO - Response: -165.482273102
2025-07-01 13:55:19,723 - INFO - Noise marker measured: -165.48 dBm
2025-07-01 13:55:19,723 - INFO - STN iteration 1: marker=-165.48dBm, meas_time=1.093sec
2025-07-01 13:55:19,723 - INFO - Preparing STN test set 5 at 2.481 GHz
2025-07-01 13:55:19,723 - DEBUG - Reusing STN instrument, setting freq to 2481000000.000 Hz
2025-07-01 13:55:19,723 - INFO - Setting STN frequency to 2.481GHz
2025-07-01 13:55:19,723 - INFO - Write: :SENS:FREQ:CENT 2481000000.0
2025-07-01 13:55:19,724 - INFO - Write: :CALC1:MARK1:X 2481000000.0
2025-07-01 13:55:19,724 - INFO - Query: *OPC?
2025-07-01 13:55:19,767 - INFO - Response: 1
2025-07-01 13:55:19,767 - DEBUG - Starting STN test set 5: freq=2.481GHz, iterations=1
2025-07-01 13:55:19,767 - DEBUG - Calling VSA_Config
2025-07-01 13:55:19,768 - INFO - Configuring VSA for STN
2025-07-01 13:55:19,768 - INFO - Query: *RST;*OPC?
2025-07-01 13:55:20,015 - INFO - Response: 1
2025-07-01 13:55:20,015 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:55:20,017 - INFO - Response: 1
2025-07-01 13:55:20,017 - INFO - Write: :SENS:FREQ:CENT 2481000000.0
2025-07-01 13:55:20,017 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:55:20,017 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:55:20,017 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:55:20,018 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:55:20,018 - INFO - Write: :INP:ATT 0
2025-07-01 13:55:20,018 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:55:20,018 - INFO - Configuring noise marker for STN
2025-07-01 13:55:20,018 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:55:20,018 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:55:20,018 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:55:20,018 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:55:20,018 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:55:20,018 - INFO - Write: :CALC1:MARK1:X 2481000000.0
2025-07-01 13:55:20,019 - INFO - Clearing error queue
2025-07-01 13:55:20,019 - INFO - Query: :SYST:ERR?
2025-07-01 13:55:20,152 - INFO - Response: 0,"No error"
2025-07-01 13:55:20,152 - DEBUG - Running STN iteration 1
2025-07-01 13:55:20,152 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:55:20,153 - INFO - Write: INIT:CONT OFF
2025-07-01 13:55:20,153 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:55:21,244 - INFO - Response: 1
2025-07-01 13:55:21,244 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:55:21,246 - INFO - Response: -165.426645279
2025-07-01 13:55:21,246 - INFO - Noise marker measured: -165.43 dBm
2025-07-01 13:55:21,246 - INFO - STN iteration 1: marker=-165.43dBm, meas_time=1.094sec
2025-07-01 13:55:21,246 - INFO - Closing VSA and VSG connections
2025-07-01 13:55:21,246 - INFO - Socket closed
2025-07-01 13:55:21,247 - INFO - Socket closed
2025-07-01 13:55:21,247 - INFO - Connections closed successfully
2025-07-01 13:55:21,252 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 13:55:21,523 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 13:55:21,570 - INFO - Socket closed
2025-07-01 13:55:21,571 - INFO - Socket closed
2025-07-01 13:56:22,287 - INFO - Starting RF measurement script
2025-07-01 13:56:22,290 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 13:56:22,290 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 13:56:22,290 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 13:56:22,291 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 13:56:22,291 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 13:56:22,291 - DEBUG - Initializing new STN instrument
2025-07-01 13:56:22,291 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 13:56:22,296 - INFO - Connected to 192.168.200.20:5025
2025-07-01 13:56:22,296 - INFO - Query: *IDN?
2025-07-01 13:56:22,301 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 13:56:22,304 - INFO - Connected to 192.168.200.10:5025
2025-07-01 13:56:22,304 - INFO - Query: *IDN?
2025-07-01 13:56:22,304 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 13:56:22,305 - INFO - Write: OUTP:STAT OFF
2025-07-01 13:56:22,305 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 13:56:22,305 - DEBUG - Calling VSA_Config
2025-07-01 13:56:22,305 - INFO - Configuring VSA for STN
2025-07-01 13:56:22,305 - INFO - Query: *RST;*OPC?
2025-07-01 13:56:22,559 - INFO - Response: 1
2025-07-01 13:56:22,560 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 13:56:22,561 - INFO - Response: 1
2025-07-01 13:56:22,561 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 13:56:22,561 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 13:56:22,561 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 13:56:22,561 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 13:56:22,561 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 13:56:22,561 - INFO - Write: :INP:ATT 0
2025-07-01 13:56:22,561 - INFO - Write: :DISP:WIND:TRAC:Y:SCAL:RLEV -40
2025-07-01 13:56:22,561 - INFO - Configuring noise marker for STN
2025-07-01 13:56:22,561 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-01 13:56:22,561 - INFO - Write: :SENS:SWE:TIME:AUTO OFF
2025-07-01 13:56:22,561 - INFO - Write: :SENS:SWE:TIME 1.0
2025-07-01 13:56:22,562 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 13:56:22,562 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 13:56:22,562 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 13:56:22,562 - INFO - Clearing error queue
2025-07-01 13:56:22,562 - INFO - Query: :SYST:ERR?
2025-07-01 13:56:22,696 - INFO - Response: 0,"No error"
2025-07-01 13:56:22,696 - DEBUG - Running STN iteration 1
2025-07-01 13:56:22,696 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 13:56:22,696 - INFO - Write: INIT:CONT OFF
2025-07-01 13:56:22,696 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 13:56:23,748 - INFO - Response: 1
2025-07-01 13:56:23,749 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 13:56:23,750 - INFO - Response: -165.443496704
2025-07-01 13:56:23,750 - INFO - Noise marker measured: -165.44 dBm
2025-07-01 13:56:23,751 - INFO - STN iteration 1: marker=-165.44dBm, meas_time=1.054sec
2025-07-01 13:56:23,751 - INFO - Closing VSA and VSG connections
2025-07-01 13:56:23,751 - INFO - Socket closed
2025-07-01 13:56:23,751 - INFO - Socket closed
2025-07-01 13:56:23,751 - INFO - Connections closed successfully
2025-07-01 13:56:23,755 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 13:56:24,012 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 13:56:24,061 - INFO - Socket closed
2025-07-01 13:56:24,062 - INFO - Socket closed
2025-07-01 14:18:37,634 - INFO - Starting RF measurement script
2025-07-01 14:18:37,637 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:18:37,638 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:18:37,638 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:18:37,639 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:18:37,639 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:18:37,639 - DEBUG - Initializing new STN instrument
2025-07-01 14:18:37,639 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:18:37,652 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:18:37,652 - INFO - Query: *IDN?
2025-07-01 14:18:37,656 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:18:37,659 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:18:37,659 - INFO - Query: *IDN?
2025-07-01 14:18:37,660 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:18:37,660 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:18:37,660 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:18:37,661 - DEBUG - Calling VSA_Config
2025-07-01 14:18:37,661 - INFO - Configuring VSA for STN
2025-07-01 14:18:37,661 - INFO - Query: *RST;*OPC?
2025-07-01 14:18:38,058 - INFO - Response: 1
2025-07-01 14:18:38,058 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:18:38,059 - INFO - Response: 1
2025-07-01 14:18:38,059 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:18:38,060 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 14:18:38,060 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:18:38,060 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:18:38,060 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:18:38,060 - INFO - Write: :INP:ATT 0
2025-07-01 14:18:38,060 - INFO - Write: SENS:BAND:RES 500
2025-07-01 14:18:38,060 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:18:38,060 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:18:38,192 - INFO - Response: 1
2025-07-01 14:18:38,192 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:18:38,192 - INFO - Write: SENS:AVER:COUN 10
2025-07-01 14:18:38,192 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-01 14:18:38,192 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:18:38,192 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:18:38,286 - INFO - Response: 1
2025-07-01 14:18:38,287 - INFO - Configuring noise marker for STN
2025-07-01 14:18:38,287 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:18:38,287 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:18:38,288 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:18:38,288 - INFO - Clearing error queue
2025-07-01 14:18:38,288 - INFO - Query: :SYST:ERR?
2025-07-01 14:18:38,396 - INFO - Response: -113,"Undefined header;&GTL"
2025-07-01 14:18:38,396 - DEBUG - Running STN iteration 1
2025-07-01 14:18:38,396 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:18:38,396 - INFO - Write: INIT:CONT OFF
2025-07-01 14:18:38,397 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:18:47,891 - INFO - Response: 1
2025-07-01 14:18:47,891 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:18:47,893 - INFO - Response: -167.812103271
2025-07-01 14:18:47,893 - INFO - Noise marker measured: -167.81 dBm
2025-07-01 14:18:47,893 - INFO - STN iteration 1: marker=-167.81dBm, meas_time=9.496sec
2025-07-01 14:18:47,893 - INFO - Closing VSA and VSG connections
2025-07-01 14:18:47,893 - INFO - Socket closed
2025-07-01 14:18:47,893 - INFO - Socket closed
2025-07-01 14:18:47,893 - INFO - Connections closed successfully
2025-07-01 14:18:47,895 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:18:48,109 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:18:48,155 - INFO - Socket closed
2025-07-01 14:18:48,156 - INFO - Socket closed
2025-07-01 14:19:37,526 - INFO - Starting RF measurement script
2025-07-01 14:19:37,529 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:19:37,529 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:19:37,529 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:19:37,529 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:19:37,529 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:19:37,530 - DEBUG - Initializing new STN instrument
2025-07-01 14:19:37,530 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:19:37,534 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:19:37,534 - INFO - Query: *IDN?
2025-07-01 14:19:37,535 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:19:37,538 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:19:37,538 - INFO - Query: *IDN?
2025-07-01 14:19:37,539 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:19:37,539 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:19:37,539 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:19:37,539 - DEBUG - Calling VSA_Config
2025-07-01 14:19:37,540 - INFO - Configuring VSA for STN
2025-07-01 14:19:37,540 - INFO - Query: *RST;*OPC?
2025-07-01 14:19:37,879 - INFO - Response: 1
2025-07-01 14:19:37,879 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:19:37,919 - INFO - Response: 1
2025-07-01 14:19:37,919 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:19:37,919 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 14:19:37,919 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:19:37,919 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:19:37,919 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:19:37,920 - INFO - Write: :INP:ATT 0
2025-07-01 14:19:37,920 - INFO - Write: SENS:BAND:RES 500
2025-07-01 14:19:37,920 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:19:37,920 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:19:38,061 - INFO - Response: 1
2025-07-01 14:19:38,061 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:19:38,061 - INFO - Write: SENS:AVER:COUN 10
2025-07-01 14:19:38,061 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:19:38,302 - INFO - Response: 1
2025-07-01 14:19:38,302 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:19:38,302 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:19:38,405 - INFO - Response: 1
2025-07-01 14:19:38,406 - INFO - Configuring noise marker for STN
2025-07-01 14:19:38,406 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:19:38,406 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:19:38,406 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:19:38,406 - INFO - Clearing error queue
2025-07-01 14:19:38,406 - INFO - Query: :SYST:ERR?
2025-07-01 14:19:38,654 - INFO - Response: -113,"Undefined header;&GTL"
2025-07-01 14:19:38,655 - DEBUG - Running STN iteration 1
2025-07-01 14:19:38,655 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:19:38,655 - INFO - Write: INIT:CONT OFF
2025-07-01 14:19:38,656 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:19:48,339 - INFO - Response: 1
2025-07-01 14:19:48,340 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:19:48,341 - INFO - Response: -168.482223511
2025-07-01 14:19:48,342 - INFO - Noise marker measured: -168.48 dBm
2025-07-01 14:19:48,342 - INFO - STN iteration 1: marker=-168.48dBm, meas_time=9.686sec
2025-07-01 14:19:48,342 - INFO - Closing VSA and VSG connections
2025-07-01 14:19:48,342 - INFO - Socket closed
2025-07-01 14:19:48,343 - INFO - Socket closed
2025-07-01 14:19:48,343 - INFO - Connections closed successfully
2025-07-01 14:19:48,346 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:19:48,637 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:19:48,684 - INFO - Socket closed
2025-07-01 14:19:48,685 - INFO - Socket closed
2025-07-01 14:20:03,710 - INFO - Starting RF measurement script
2025-07-01 14:20:03,712 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:20:03,712 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:20:03,712 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:20:03,712 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:20:03,712 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:20:03,712 - DEBUG - Initializing new STN instrument
2025-07-01 14:20:03,713 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:20:03,718 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:20:03,718 - INFO - Query: *IDN?
2025-07-01 14:20:03,719 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:20:03,722 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:20:03,722 - INFO - Query: *IDN?
2025-07-01 14:20:03,723 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:20:03,723 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:20:03,723 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:20:03,723 - DEBUG - Calling VSA_Config
2025-07-01 14:20:03,723 - INFO - Configuring VSA for STN
2025-07-01 14:20:03,723 - INFO - Query: *RST;*OPC?
2025-07-01 14:20:04,093 - INFO - Response: 1
2025-07-01 14:20:04,093 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:20:04,094 - INFO - Response: 1
2025-07-01 14:20:04,094 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:20:04,095 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 14:20:04,095 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:20:04,095 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:20:04,095 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:20:04,095 - INFO - Write: :INP:ATT 0
2025-07-01 14:20:04,095 - INFO - Write: SENS:BAND:RES 500
2025-07-01 14:20:04,095 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:20:04,095 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:20:04,095 - INFO - Write: SENS:AVER:COUN 10
2025-07-01 14:20:04,095 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:20:04,221 - INFO - Response: 1
2025-07-01 14:20:04,221 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:20:04,222 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:20:04,276 - INFO - Response: 1
2025-07-01 14:20:04,276 - INFO - Configuring noise marker for STN
2025-07-01 14:20:04,276 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:20:04,277 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:20:04,277 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:20:04,277 - INFO - Clearing error queue
2025-07-01 14:20:04,277 - INFO - Query: :SYST:ERR?
2025-07-01 14:20:04,415 - INFO - Response: -113,"Undefined header;&GTL"
2025-07-01 14:20:04,415 - DEBUG - Running STN iteration 1
2025-07-01 14:20:04,415 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:20:04,415 - INFO - Write: INIT:CONT OFF
2025-07-01 14:20:04,416 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:20:13,847 - INFO - Response: 1
2025-07-01 14:20:13,848 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:20:13,849 - INFO - Response: -168.385543823
2025-07-01 14:20:13,849 - INFO - Noise marker measured: -168.39 dBm
2025-07-01 14:20:13,849 - INFO - STN iteration 1: marker=-168.39dBm, meas_time=9.433sec
2025-07-01 14:20:13,849 - INFO - Closing VSA and VSG connections
2025-07-01 14:20:13,849 - INFO - Socket closed
2025-07-01 14:20:13,849 - INFO - Socket closed
2025-07-01 14:20:13,849 - INFO - Connections closed successfully
2025-07-01 14:20:13,851 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:20:14,055 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:20:14,101 - INFO - Socket closed
2025-07-01 14:20:14,102 - INFO - Socket closed
2025-07-01 14:20:46,876 - INFO - Starting RF measurement script
2025-07-01 14:20:46,890 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:20:46,891 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:20:46,892 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:20:46,892 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:20:46,892 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:20:46,892 - DEBUG - Initializing new STN instrument
2025-07-01 14:20:46,893 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:20:46,899 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:20:46,899 - INFO - Query: *IDN?
2025-07-01 14:20:46,901 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:20:46,904 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:20:46,904 - INFO - Query: *IDN?
2025-07-01 14:20:46,905 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:20:46,905 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:20:46,906 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:20:46,906 - DEBUG - Calling VSA_Config
2025-07-01 14:20:46,906 - INFO - Configuring VSA for STN
2025-07-01 14:20:46,906 - INFO - Query: *RST;*OPC?
2025-07-01 14:20:47,264 - INFO - Response: 1
2025-07-01 14:20:47,264 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:20:47,265 - INFO - Response: 1
2025-07-01 14:20:47,266 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:20:47,266 - INFO - Write: :SENS:FREQ:SPAN 100e6
2025-07-01 14:20:47,266 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:20:47,266 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:20:47,266 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:20:47,267 - INFO - Write: :INP:ATT 0
2025-07-01 14:20:47,267 - INFO - Write: SENS:BAND:RES 500
2025-07-01 14:20:47,267 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:20:47,267 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:20:47,267 - INFO - Write: SENS:AVER:COUN 10
2025-07-01 14:20:47,267 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:20:47,268 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:20:47,425 - INFO - Response: 1
2025-07-01 14:20:47,425 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:20:47,431 - INFO - Response: 1
2025-07-01 14:20:47,432 - INFO - Configuring noise marker for STN
2025-07-01 14:20:47,432 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:20:47,432 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:20:47,433 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:20:47,433 - INFO - Clearing error queue
2025-07-01 14:20:47,433 - INFO - Query: :SYST:ERR?
2025-07-01 14:20:47,565 - INFO - Response: -113,"Undefined header;&GTL"
2025-07-01 14:20:47,565 - DEBUG - Running STN iteration 1
2025-07-01 14:20:47,565 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:20:47,565 - INFO - Write: INIT:CONT OFF
2025-07-01 14:20:47,566 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:20:56,418 - INFO - Response: 1
2025-07-01 14:20:56,418 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:20:56,419 - INFO - Response: -168.746841431
2025-07-01 14:20:56,419 - INFO - Noise marker measured: -168.75 dBm
2025-07-01 14:20:56,419 - INFO - STN iteration 1: marker=-168.75dBm, meas_time=8.855sec
2025-07-01 14:20:56,420 - INFO - Closing VSA and VSG connections
2025-07-01 14:20:56,420 - INFO - Socket closed
2025-07-01 14:20:56,420 - INFO - Socket closed
2025-07-01 14:20:56,420 - INFO - Connections closed successfully
2025-07-01 14:20:56,422 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:20:56,631 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:20:56,682 - INFO - Socket closed
2025-07-01 14:20:56,683 - INFO - Socket closed
2025-07-01 14:37:28,509 - INFO - Starting RF measurement script
2025-07-01 14:37:28,512 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:37:28,512 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:37:28,512 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:37:28,512 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:37:28,512 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:37:28,512 - DEBUG - Initializing new STN instrument
2025-07-01 14:37:28,512 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:37:28,518 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:37:28,518 - INFO - Query: *IDN?
2025-07-01 14:37:28,538 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:37:28,542 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:37:28,542 - INFO - Query: *IDN?
2025-07-01 14:37:28,543 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:37:28,543 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:37:28,543 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:37:28,543 - DEBUG - Calling VSA_Config
2025-07-01 14:37:28,543 - INFO - Configuring VSA for STN
2025-07-01 14:37:28,543 - INFO - Query: *RST;*OPC?
2025-07-01 14:37:28,922 - INFO - Response: 1
2025-07-01 14:37:28,922 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:37:28,923 - INFO - Response: 1
2025-07-01 14:37:28,923 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:37:28,923 - INFO - Write: :SENS:FREQ:SPAN 100e9
2025-07-01 14:37:28,923 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:37:28,923 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:37:28,923 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:37:28,923 - INFO - Write: :INP:ATT 0
2025-07-01 14:37:28,923 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:37:28,924 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:37:28,924 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:37:28,924 - INFO - Query: :SENS:SWE:OPT SPE
2025-07-01 14:37:58,927 - ERROR - Query failed: :SENS:SWE:OPT SPE, Error: timed out
2025-07-01 14:37:58,928 - ERROR - STN measurement failed for test set 1: timed out
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 228, in run_stn_measurement
    _, timings["VSA_Config"] = stn_instr.VSA_Config()  # Configure VSA for STN
                               ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\SubThermalNoise.py", line 42, in VSA_Config
    self.VSA.query(':SENS:SWE:OPT SPE')  # Set reference level to -40 dBm
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out
2025-07-01 14:37:58,933 - INFO - Closing VSA and VSG connections
2025-07-01 14:37:58,933 - INFO - Socket closed
2025-07-01 14:37:58,933 - INFO - Socket closed
2025-07-01 14:37:58,933 - INFO - Connections closed successfully
2025-07-01 14:37:58,935 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:37:59,195 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:37:59,244 - INFO - Socket closed
2025-07-01 14:37:59,245 - INFO - Socket closed
2025-07-01 14:39:06,731 - INFO - Starting RF measurement script
2025-07-01 14:39:06,734 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:39:06,735 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:39:06,735 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:39:06,735 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:39:06,735 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:39:06,736 - DEBUG - Initializing new STN instrument
2025-07-01 14:39:06,736 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:39:06,744 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:39:06,744 - INFO - Query: *IDN?
2025-07-01 14:39:06,754 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:39:06,758 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:39:06,759 - INFO - Query: *IDN?
2025-07-01 14:39:06,760 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:39:06,761 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:39:06,761 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:39:06,761 - DEBUG - Calling VSA_Config
2025-07-01 14:39:06,761 - INFO - Configuring VSA for STN
2025-07-01 14:39:06,761 - INFO - Query: *RST;*OPC?
2025-07-01 14:39:07,080 - INFO - Response: 1
2025-07-01 14:39:07,080 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:39:07,081 - INFO - Response: 1
2025-07-01 14:39:07,081 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:39:07,081 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:39:07,081 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:39:07,082 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:39:07,082 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:39:07,082 - INFO - Write: :INP:ATT 0
2025-07-01 14:39:07,082 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:39:07,082 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:39:07,082 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:39:07,082 - INFO - Query: :SENS:SWE:OPT SPE
2025-07-01 14:39:37,088 - ERROR - Query failed: :SENS:SWE:OPT SPE, Error: timed out
2025-07-01 14:39:37,088 - ERROR - STN measurement failed for test set 1: timed out
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 228, in run_stn_measurement
    _, timings["VSA_Config"] = stn_instr.VSA_Config()  # Configure VSA for STN
                               ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\SubThermalNoise.py", line 42, in VSA_Config
    self.VSA.query(':SENS:SWE:OPT SPE')  # Set reference level to -40 dBm
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out
2025-07-01 14:39:37,092 - INFO - Closing VSA and VSG connections
2025-07-01 14:39:37,093 - INFO - Socket closed
2025-07-01 14:39:37,093 - INFO - Socket closed
2025-07-01 14:39:37,093 - INFO - Connections closed successfully
2025-07-01 14:39:37,096 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:39:37,382 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:39:37,433 - INFO - Socket closed
2025-07-01 14:39:37,435 - INFO - Socket closed
2025-07-01 14:41:07,128 - INFO - Starting RF measurement script
2025-07-01 14:41:07,131 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:41:07,131 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:41:07,131 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:41:07,131 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:41:07,131 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:41:07,131 - DEBUG - Initializing new STN instrument
2025-07-01 14:41:07,131 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:41:07,136 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:41:07,137 - INFO - Query: *IDN?
2025-07-01 14:41:07,149 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:41:07,151 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:41:07,152 - INFO - Query: *IDN?
2025-07-01 14:41:07,152 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:41:07,152 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:41:07,152 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:41:07,152 - DEBUG - Calling VSA_Config
2025-07-01 14:41:07,152 - INFO - Configuring VSA for STN
2025-07-01 14:41:07,152 - INFO - Query: *RST;*OPC?
2025-07-01 14:41:07,473 - INFO - Response: 1
2025-07-01 14:41:07,473 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:41:07,474 - INFO - Response: 1
2025-07-01 14:41:07,474 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:41:07,475 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:41:07,475 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:41:07,475 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:41:07,475 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:41:07,476 - INFO - Write: :INP:ATT 0
2025-07-01 14:41:07,476 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:41:07,476 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:41:07,476 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:41:07,476 - INFO - Query: :SENS:SWE:OPT SPE
2025-07-01 14:41:37,490 - ERROR - Query failed: :SENS:SWE:OPT SPE, Error: timed out
2025-07-01 14:41:37,490 - ERROR - STN measurement failed for test set 1: timed out
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 228, in run_stn_measurement
    _, timings["VSA_Config"] = stn_instr.VSA_Config()  # Configure VSA for STN
                               ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\SubThermalNoise.py", line 42, in VSA_Config
    self.VSA.query(':SENS:SWE:OPT SPE')  # Set reference level to -40 dBm
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out
2025-07-01 14:41:37,493 - INFO - Closing VSA and VSG connections
2025-07-01 14:41:37,494 - INFO - Socket closed
2025-07-01 14:41:37,494 - INFO - Socket closed
2025-07-01 14:41:37,494 - INFO - Connections closed successfully
2025-07-01 14:41:37,496 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:41:37,821 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:41:37,882 - INFO - Socket closed
2025-07-01 14:41:37,884 - INFO - Socket closed
2025-07-01 14:41:42,650 - INFO - Starting RF measurement script
2025-07-01 14:41:42,654 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:41:42,654 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:41:42,655 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:41:42,655 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:41:42,655 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:41:42,655 - DEBUG - Initializing new STN instrument
2025-07-01 14:41:42,655 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:41:42,663 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:41:42,663 - INFO - Query: *IDN?
2025-07-01 14:41:42,665 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:41:42,669 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:41:42,669 - INFO - Query: *IDN?
2025-07-01 14:41:42,670 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:41:42,670 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:41:42,670 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:41:42,670 - DEBUG - Calling VSA_Config
2025-07-01 14:41:42,670 - INFO - Configuring VSA for STN
2025-07-01 14:41:42,670 - INFO - Query: *RST;*OPC?
2025-07-01 14:41:42,991 - INFO - Response: 1
2025-07-01 14:41:42,991 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:41:42,992 - INFO - Response: 1
2025-07-01 14:41:42,993 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:41:42,993 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:41:42,993 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:41:42,993 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:41:42,993 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:41:42,993 - INFO - Write: :INP:ATT 0
2025-07-01 14:41:42,993 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:41:42,993 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:41:42,994 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:41:42,994 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 14:41:42,994 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:41:42,994 - INFO - Write: SENS:AVER:COUN 10
2025-07-01 14:41:42,994 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:41:42,994 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:41:43,198 - INFO - Response: 1
2025-07-01 14:41:43,199 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:41:43,203 - INFO - Response: 1
2025-07-01 14:41:43,204 - INFO - Configuring noise marker for STN
2025-07-01 14:41:43,204 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:41:43,204 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:41:43,205 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:41:43,205 - INFO - Clearing error queue
2025-07-01 14:41:43,205 - INFO - Query: :SYST:ERR?
2025-07-01 14:41:43,280 - INFO - Response: -222,"Data out of range;:SENS:FREQ:SPAN 100e9"
2025-07-01 14:41:43,280 - DEBUG - Running STN iteration 1
2025-07-01 14:41:43,280 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:41:43,280 - INFO - Write: INIT:CONT OFF
2025-07-01 14:41:43,281 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:41:46,420 - INFO - Response: 1
2025-07-01 14:41:46,420 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:41:46,421 - INFO - Response: -167.1379776
2025-07-01 14:41:46,422 - INFO - Noise marker measured: -167.14 dBm
2025-07-01 14:41:46,422 - INFO - STN iteration 1: marker=-167.14dBm, meas_time=3.141sec
2025-07-01 14:41:46,422 - INFO - Closing VSA and VSG connections
2025-07-01 14:41:46,422 - INFO - Socket closed
2025-07-01 14:41:46,422 - INFO - Socket closed
2025-07-01 14:41:46,422 - INFO - Connections closed successfully
2025-07-01 14:41:46,425 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:41:46,700 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:41:46,748 - INFO - Socket closed
2025-07-01 14:41:46,749 - INFO - Socket closed
2025-07-01 14:42:14,007 - INFO - Starting RF measurement script
2025-07-01 14:42:14,009 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:42:14,009 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:42:14,009 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:42:14,009 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:42:14,009 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:42:14,009 - DEBUG - Initializing new STN instrument
2025-07-01 14:42:14,009 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:42:14,013 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:42:14,013 - INFO - Query: *IDN?
2025-07-01 14:42:14,014 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:42:14,016 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:42:14,016 - INFO - Query: *IDN?
2025-07-01 14:42:14,017 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:42:14,017 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:42:14,017 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:42:14,017 - DEBUG - Calling VSA_Config
2025-07-01 14:42:14,017 - INFO - Configuring VSA for STN
2025-07-01 14:42:14,017 - INFO - Query: *RST;*OPC?
2025-07-01 14:42:14,377 - INFO - Response: 1
2025-07-01 14:42:14,378 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:42:14,379 - INFO - Response: 1
2025-07-01 14:42:14,379 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:42:14,379 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:42:14,379 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:42:14,379 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:42:14,379 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:42:14,379 - INFO - Write: :INP:ATT 0
2025-07-01 14:42:14,379 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:42:14,379 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:42:14,379 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:42:14,379 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 14:42:14,379 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:42:14,379 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 14:42:14,379 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:42:14,379 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:42:14,577 - INFO - Response: 1
2025-07-01 14:42:14,578 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:42:14,581 - INFO - Response: 1
2025-07-01 14:42:14,581 - INFO - Configuring noise marker for STN
2025-07-01 14:42:14,581 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:42:14,581 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:42:14,582 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:42:14,582 - INFO - Clearing error queue
2025-07-01 14:42:14,582 - INFO - Query: :SYST:ERR?
2025-07-01 14:42:14,691 - INFO - Response: 0,"No error"
2025-07-01 14:42:14,691 - DEBUG - Running STN iteration 1
2025-07-01 14:42:14,691 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:42:14,692 - INFO - Write: INIT:CONT OFF
2025-07-01 14:42:14,692 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:42:40,277 - INFO - Response: 1
2025-07-01 14:42:40,277 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:42:40,278 - INFO - Response: -166.336585999
2025-07-01 14:42:40,279 - INFO - Noise marker measured: -166.34 dBm
2025-07-01 14:42:40,279 - INFO - STN iteration 1: marker=-166.34dBm, meas_time=25.586sec
2025-07-01 14:42:40,279 - INFO - Closing VSA and VSG connections
2025-07-01 14:42:40,279 - INFO - Socket closed
2025-07-01 14:42:40,279 - INFO - Socket closed
2025-07-01 14:42:40,279 - INFO - Connections closed successfully
2025-07-01 14:42:40,281 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:42:40,543 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:42:40,593 - INFO - Socket closed
2025-07-01 14:42:40,594 - INFO - Socket closed
2025-07-01 14:43:05,530 - INFO - Starting RF measurement script
2025-07-01 14:43:05,532 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:43:05,532 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:43:05,532 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:43:05,533 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:43:05,533 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:43:05,533 - DEBUG - Initializing new STN instrument
2025-07-01 14:43:05,533 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:43:05,536 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:43:05,536 - INFO - Query: *IDN?
2025-07-01 14:43:05,538 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:43:05,539 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:43:05,539 - INFO - Query: *IDN?
2025-07-01 14:43:05,540 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:43:05,540 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:43:05,540 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:43:05,540 - DEBUG - Calling VSA_Config
2025-07-01 14:43:05,540 - INFO - Configuring VSA for STN
2025-07-01 14:43:05,540 - INFO - Query: *RST;*OPC?
2025-07-01 14:43:05,901 - INFO - Response: 1
2025-07-01 14:43:05,901 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:43:05,902 - INFO - Response: 1
2025-07-01 14:43:05,903 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:43:05,903 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:43:05,903 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:43:05,903 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:43:05,903 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:43:05,903 - INFO - Write: :INP:ATT 0
2025-07-01 14:43:05,903 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:43:05,903 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:43:05,903 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:43:05,903 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 14:43:05,903 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:43:05,903 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 14:43:05,903 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:43:05,903 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:43:06,105 - INFO - Response: 1
2025-07-01 14:43:06,105 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:43:06,109 - INFO - Response: 1
2025-07-01 14:43:06,109 - INFO - Configuring noise marker for STN
2025-07-01 14:43:06,109 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:43:06,109 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:43:06,110 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:43:06,110 - INFO - Clearing error queue
2025-07-01 14:43:06,110 - INFO - Query: :SYST:ERR?
2025-07-01 14:43:06,220 - INFO - Response: 0,"No error"
2025-07-01 14:43:06,220 - DEBUG - Running STN iteration 1
2025-07-01 14:43:06,220 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:43:06,220 - INFO - Write: INIT:CONT OFF
2025-07-01 14:43:06,221 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:43:11,891 - INFO - Response: 1
2025-07-01 14:43:11,892 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:43:11,893 - INFO - Response: -172.860626221
2025-07-01 14:43:11,893 - INFO - Noise marker measured: -172.86 dBm
2025-07-01 14:43:11,893 - INFO - STN iteration 1: marker=-172.86dBm, meas_time=5.673sec
2025-07-01 14:43:11,893 - INFO - Closing VSA and VSG connections
2025-07-01 14:43:11,893 - INFO - Socket closed
2025-07-01 14:43:11,893 - INFO - Socket closed
2025-07-01 14:43:11,894 - INFO - Connections closed successfully
2025-07-01 14:43:11,896 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:43:12,141 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:43:12,194 - INFO - Socket closed
2025-07-01 14:43:12,195 - INFO - Socket closed
2025-07-01 14:43:52,959 - INFO - Starting RF measurement script
2025-07-01 14:43:52,962 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:43:52,963 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:43:52,963 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:43:52,964 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:43:52,964 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:43:52,964 - DEBUG - Initializing new STN instrument
2025-07-01 14:43:52,964 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:43:52,969 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:43:52,969 - INFO - Query: *IDN?
2025-07-01 14:43:52,970 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:43:52,972 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:43:52,972 - INFO - Query: *IDN?
2025-07-01 14:43:52,973 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:43:52,973 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:43:52,973 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:43:52,973 - DEBUG - Calling VSA_Config
2025-07-01 14:43:52,973 - INFO - Configuring VSA for STN
2025-07-01 14:43:52,973 - INFO - Query: *RST;*OPC?
2025-07-01 14:43:53,348 - INFO - Response: 1
2025-07-01 14:43:53,348 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:43:53,350 - INFO - Response: 1
2025-07-01 14:43:53,350 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:43:53,350 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:43:53,350 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:43:53,351 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:43:53,351 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:43:53,351 - INFO - Write: :INP:ATT 0
2025-07-01 14:43:53,351 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:43:53,351 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:43:53,351 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:43:53,352 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 14:43:53,352 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:43:53,352 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 14:43:53,352 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:43:53,352 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 14:43:53,353 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:43:53,568 - INFO - Response: 1
2025-07-01 14:43:53,568 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:43:53,572 - INFO - Response: 1
2025-07-01 14:43:53,572 - INFO - Configuring noise marker for STN
2025-07-01 14:43:53,572 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:43:53,572 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:43:53,572 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:43:53,572 - INFO - Clearing error queue
2025-07-01 14:43:53,573 - INFO - Query: :SYST:ERR?
2025-07-01 14:43:53,650 - INFO - Response: 0,"No error"
2025-07-01 14:43:53,650 - DEBUG - Running STN iteration 1
2025-07-01 14:43:53,650 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:43:53,650 - INFO - Write: INIT:CONT OFF
2025-07-01 14:43:53,651 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:44:22,451 - INFO - Response: 1
2025-07-01 14:44:22,451 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:44:22,455 - INFO - Response: -168.100379944
2025-07-01 14:44:22,455 - INFO - Noise marker measured: -168.10 dBm
2025-07-01 14:44:22,455 - INFO - STN iteration 1: marker=-168.10dBm, meas_time=28.803sec
2025-07-01 14:44:22,455 - INFO - Closing VSA and VSG connections
2025-07-01 14:44:22,455 - INFO - Socket closed
2025-07-01 14:44:22,455 - INFO - Socket closed
2025-07-01 14:44:22,456 - INFO - Connections closed successfully
2025-07-01 14:44:22,458 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:44:22,777 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:44:22,819 - INFO - Socket closed
2025-07-01 14:44:22,820 - INFO - Socket closed
2025-07-01 14:44:30,206 - INFO - Starting RF measurement script
2025-07-01 14:44:30,209 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 14:44:30,209 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 14:44:30,209 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 14:44:30,209 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 14:44:30,209 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 14:44:30,209 - DEBUG - Initializing new STN instrument
2025-07-01 14:44:30,209 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 14:44:30,214 - INFO - Connected to 192.168.200.20:5025
2025-07-01 14:44:30,214 - INFO - Query: *IDN?
2025-07-01 14:44:30,216 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 14:44:30,218 - INFO - Connected to 192.168.200.10:5025
2025-07-01 14:44:30,218 - INFO - Query: *IDN?
2025-07-01 14:44:30,219 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 14:44:30,219 - INFO - Write: OUTP:STAT OFF
2025-07-01 14:44:30,219 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 14:44:30,219 - DEBUG - Calling VSA_Config
2025-07-01 14:44:30,219 - INFO - Configuring VSA for STN
2025-07-01 14:44:30,220 - INFO - Query: *RST;*OPC?
2025-07-01 14:44:30,583 - INFO - Response: 1
2025-07-01 14:44:30,583 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 14:44:30,584 - INFO - Response: 1
2025-07-01 14:44:30,584 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 14:44:30,585 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 14:44:30,585 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 14:44:30,585 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 14:44:30,585 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 14:44:30,585 - INFO - Write: :INP:ATT 0
2025-07-01 14:44:30,585 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 14:44:30,585 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 14:44:30,585 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 14:44:30,585 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 14:44:30,585 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 14:44:30,585 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 14:44:30,585 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 14:44:30,586 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:44:30,790 - INFO - Response: 1
2025-07-01 14:44:30,791 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 14:44:30,795 - INFO - Response: 1
2025-07-01 14:44:30,795 - INFO - Configuring noise marker for STN
2025-07-01 14:44:30,795 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 14:44:30,795 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 14:44:30,795 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 14:44:30,795 - INFO - Clearing error queue
2025-07-01 14:44:30,795 - INFO - Query: :SYST:ERR?
2025-07-01 14:44:30,862 - INFO - Response: 0,"No error"
2025-07-01 14:44:30,863 - DEBUG - Running STN iteration 1
2025-07-01 14:44:30,863 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 14:44:30,863 - INFO - Write: INIT:CONT OFF
2025-07-01 14:44:30,863 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 14:44:36,711 - INFO - Response: 1
2025-07-01 14:44:36,711 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 14:44:36,712 - INFO - Response: -173.962257385
2025-07-01 14:44:36,712 - INFO - Noise marker measured: -173.96 dBm
2025-07-01 14:44:36,713 - INFO - STN iteration 1: marker=-173.96dBm, meas_time=5.850sec
2025-07-01 14:44:36,713 - INFO - Closing VSA and VSG connections
2025-07-01 14:44:36,713 - INFO - Socket closed
2025-07-01 14:44:36,713 - INFO - Socket closed
2025-07-01 14:44:36,713 - INFO - Connections closed successfully
2025-07-01 14:44:36,715 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 14:44:36,960 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 14:44:37,012 - INFO - Socket closed
2025-07-01 14:44:37,013 - INFO - Socket closed
2025-07-01 15:24:41,480 - INFO - Starting RF measurement script
2025-07-01 15:24:41,484 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:24:41,484 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:24:41,484 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:24:41,484 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:24:41,484 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:24:41,484 - DEBUG - Initializing new STN instrument
2025-07-01 15:24:41,484 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:24:41,489 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:24:41,489 - INFO - Query: *IDN?
2025-07-01 15:24:41,496 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:24:41,499 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:24:41,499 - INFO - Query: *IDN?
2025-07-01 15:24:41,500 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:24:41,500 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:24:41,500 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:24:41,500 - DEBUG - Calling VSA_Config
2025-07-01 15:24:41,500 - INFO - Configuring VSA for STN
2025-07-01 15:24:41,500 - INFO - Query: *RST;*OPC?
2025-07-01 15:24:41,816 - INFO - Response: 1
2025-07-01 15:24:41,816 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:24:41,818 - INFO - Response: 1
2025-07-01 15:24:41,818 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:24:41,818 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:24:41,818 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:24:41,819 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:24:41,819 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:24:41,819 - INFO - Write: :INP:ATT 0
2025-07-01 15:24:41,819 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 15:24:41,820 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:24:41,820 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 15:24:41,820 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 15:24:41,820 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:24:41,820 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 15:24:41,820 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:24:41,820 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:24:42,029 - INFO - Response: 1
2025-07-01 15:24:42,030 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:24:42,034 - INFO - Response: 1
2025-07-01 15:24:42,034 - INFO - Configuring noise marker for STN
2025-07-01 15:24:42,034 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:24:42,035 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:24:42,035 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:24:42,035 - INFO - Clearing error queue
2025-07-01 15:24:42,035 - INFO - Query: :SYST:ERR?
2025-07-01 15:24:42,141 - INFO - Response: 0,"No error"
2025-07-01 15:24:42,141 - DEBUG - Running STN iteration 1
2025-07-01 15:24:42,141 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:24:42,142 - INFO - Write: INIT:CONT OFF
2025-07-01 15:24:42,142 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:24:47,683 - INFO - Response: 1
2025-07-01 15:24:47,683 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:24:47,684 - INFO - Response: -169.990127563
2025-07-01 15:24:47,685 - INFO - Noise marker measured: -169.99 dBm
2025-07-01 15:24:47,685 - INFO - STN iteration 1: marker=-169.99dBm, meas_time=5.543sec
2025-07-01 15:24:47,685 - INFO - Closing VSA and VSG connections
2025-07-01 15:24:47,685 - INFO - Socket closed
2025-07-01 15:24:47,685 - INFO - Socket closed
2025-07-01 15:24:47,685 - INFO - Connections closed successfully
2025-07-01 15:24:47,687 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:24:47,939 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:24:47,988 - INFO - Socket closed
2025-07-01 15:24:47,989 - INFO - Socket closed
2025-07-01 15:25:25,418 - INFO - Starting RF measurement script
2025-07-01 15:25:25,421 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:25:25,421 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:25:25,421 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:25:25,422 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:25:25,422 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:25:25,422 - DEBUG - Initializing new STN instrument
2025-07-01 15:25:25,422 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:25:25,428 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:25:25,428 - INFO - Query: *IDN?
2025-07-01 15:25:25,430 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:25:25,433 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:25:25,433 - INFO - Query: *IDN?
2025-07-01 15:25:25,434 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:25:25,434 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:25:25,434 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:25:25,434 - DEBUG - Calling VSA_Config
2025-07-01 15:25:25,434 - INFO - Configuring VSA for STN
2025-07-01 15:25:25,434 - INFO - Query: *RST;*OPC?
2025-07-01 15:25:25,821 - INFO - Response: 1
2025-07-01 15:25:25,821 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:25:25,822 - INFO - Response: 1
2025-07-01 15:25:25,822 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:25:25,822 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:25:25,822 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:25:25,822 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:25:25,822 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:25:25,822 - INFO - Write: :INP:ATT 0
2025-07-01 15:25:25,822 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 15:25:25,822 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:25:25,823 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 15:25:25,823 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 15:25:25,823 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:25:25,823 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 15:25:25,823 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:25:26,019 - INFO - Response: 1
2025-07-01 15:25:26,019 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:25:26,023 - INFO - Response: 1
2025-07-01 15:25:26,024 - INFO - Configuring noise marker for STN
2025-07-01 15:25:26,024 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:25:26,024 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:25:26,024 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:25:26,024 - INFO - Clearing error queue
2025-07-01 15:25:26,025 - INFO - Query: :SYST:ERR?
2025-07-01 15:25:26,097 - INFO - Response: 0,"No error"
2025-07-01 15:25:26,097 - DEBUG - Running STN iteration 1
2025-07-01 15:25:26,097 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:25:26,097 - INFO - Write: INIT:CONT OFF
2025-07-01 15:25:26,097 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:25:27,470 - INFO - Response: 1
2025-07-01 15:25:27,470 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:25:27,471 - INFO - Response: -161.148124695
2025-07-01 15:25:27,472 - INFO - Noise marker measured: -161.15 dBm
2025-07-01 15:25:27,472 - INFO - STN iteration 1: marker=-161.15dBm, meas_time=1.374sec
2025-07-01 15:25:27,472 - INFO - Closing VSA and VSG connections
2025-07-01 15:25:27,472 - INFO - Socket closed
2025-07-01 15:25:27,472 - INFO - Socket closed
2025-07-01 15:25:27,472 - INFO - Connections closed successfully
2025-07-01 15:25:27,474 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:25:27,747 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:25:27,799 - INFO - Socket closed
2025-07-01 15:25:27,800 - INFO - Socket closed
2025-07-01 15:26:03,710 - INFO - Starting RF measurement script
2025-07-01 15:26:03,712 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:26:03,712 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:26:03,713 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:26:03,713 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:26:03,713 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:26:03,713 - DEBUG - Initializing new STN instrument
2025-07-01 15:26:03,713 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:26:03,717 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:26:03,718 - INFO - Query: *IDN?
2025-07-01 15:26:03,722 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:26:03,725 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:26:03,725 - INFO - Query: *IDN?
2025-07-01 15:26:03,726 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:26:03,726 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:26:03,726 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:26:03,726 - DEBUG - Calling VSA_Config
2025-07-01 15:26:03,726 - INFO - Configuring VSA for STN
2025-07-01 15:26:03,726 - INFO - Query: *RST;*OPC?
2025-07-01 15:26:04,109 - INFO - Response: 1
2025-07-01 15:26:04,110 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:26:04,111 - INFO - Response: 1
2025-07-01 15:26:04,111 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:26:04,111 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:26:04,112 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:26:04,112 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:26:04,112 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:26:04,112 - INFO - Write: :INP:ATT 0
2025-07-01 15:26:04,112 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 15:26:04,113 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:26:04,113 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 15:26:04,113 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 15:26:04,113 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:26:04,113 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 15:26:04,114 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:26:04,310 - INFO - Response: 1
2025-07-01 15:26:04,310 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:26:04,315 - INFO - Response: 1
2025-07-01 15:26:04,315 - INFO - Configuring noise marker for STN
2025-07-01 15:26:04,315 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:26:04,316 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:26:04,316 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:26:04,316 - INFO - Clearing error queue
2025-07-01 15:26:04,317 - INFO - Query: :SYST:ERR?
2025-07-01 15:26:04,423 - INFO - Response: 0,"No error"
2025-07-01 15:26:04,424 - DEBUG - Running STN iteration 1
2025-07-01 15:26:04,424 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:26:04,424 - INFO - Write: INIT:CONT OFF
2025-07-01 15:26:04,424 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:26:05,814 - INFO - Response: 1
2025-07-01 15:26:05,815 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:26:05,816 - INFO - Response: -162.153060913
2025-07-01 15:26:05,816 - INFO - Noise marker measured: -162.15 dBm
2025-07-01 15:26:05,816 - INFO - STN iteration 1: marker=-162.15dBm, meas_time=1.392sec
2025-07-01 15:26:05,817 - INFO - Closing VSA and VSG connections
2025-07-01 15:26:05,817 - INFO - Socket closed
2025-07-01 15:26:05,817 - INFO - Socket closed
2025-07-01 15:26:05,817 - INFO - Connections closed successfully
2025-07-01 15:26:05,821 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:26:06,064 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:26:06,111 - INFO - Socket closed
2025-07-01 15:26:06,112 - INFO - Socket closed
2025-07-01 15:27:03,977 - INFO - Starting RF measurement script
2025-07-01 15:27:03,981 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:27:03,981 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:27:03,981 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:27:03,981 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:27:03,981 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:27:03,981 - DEBUG - Initializing new STN instrument
2025-07-01 15:27:03,981 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:27:03,987 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:27:03,987 - INFO - Query: *IDN?
2025-07-01 15:27:03,992 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:27:03,994 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:27:03,994 - INFO - Query: *IDN?
2025-07-01 15:27:03,995 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:27:03,995 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:27:03,995 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:27:03,995 - DEBUG - Calling VSA_Config
2025-07-01 15:27:03,995 - INFO - Configuring VSA for STN
2025-07-01 15:27:03,995 - INFO - Query: *RST;*OPC?
2025-07-01 15:27:04,383 - INFO - Response: 1
2025-07-01 15:27:04,383 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:27:04,385 - INFO - Response: 1
2025-07-01 15:27:04,385 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:27:04,385 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:27:04,385 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:27:04,385 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:27:04,385 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:27:04,385 - INFO - Write: :INP:ATT 0
2025-07-01 15:27:04,385 - INFO - Write: :SENS:SWE:WIND:POIN 10001
2025-07-01 15:27:04,386 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:27:04,386 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 15:27:04,386 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 15:27:04,386 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:27:04,386 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 15:27:04,386 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:27:04,587 - INFO - Response: 1
2025-07-01 15:27:04,587 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:27:04,587 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:27:04,648 - INFO - Response: 1
2025-07-01 15:27:04,649 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:27:04,653 - INFO - Response: 1
2025-07-01 15:27:04,653 - INFO - Configuring noise marker for STN
2025-07-01 15:27:04,653 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:27:04,653 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:27:04,653 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:27:04,653 - INFO - Clearing error queue
2025-07-01 15:27:04,653 - INFO - Query: :SYST:ERR?
2025-07-01 15:27:04,772 - INFO - Response: 0,"No error"
2025-07-01 15:27:04,772 - DEBUG - Running STN iteration 1
2025-07-01 15:27:04,772 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:27:04,772 - INFO - Write: INIT:CONT OFF
2025-07-01 15:27:04,773 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:27:10,201 - INFO - Response: 1
2025-07-01 15:27:10,202 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:27:10,203 - INFO - Response: -174.477790833
2025-07-01 15:27:10,203 - INFO - Noise marker measured: -174.48 dBm
2025-07-01 15:27:10,203 - INFO - STN iteration 1: marker=-174.48dBm, meas_time=5.431sec
2025-07-01 15:27:10,203 - INFO - Closing VSA and VSG connections
2025-07-01 15:27:10,203 - INFO - Socket closed
2025-07-01 15:27:10,203 - INFO - Socket closed
2025-07-01 15:27:10,203 - INFO - Connections closed successfully
2025-07-01 15:27:10,205 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:27:10,450 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:27:10,511 - INFO - Socket closed
2025-07-01 15:27:10,512 - INFO - Socket closed
2025-07-01 15:39:40,042 - INFO - Starting RF measurement script
2025-07-01 15:39:40,044 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:39:40,044 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:39:40,044 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:39:40,044 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:39:40,044 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:39:40,045 - DEBUG - Initializing new STN instrument
2025-07-01 15:39:40,045 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:39:40,049 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:39:40,050 - INFO - Query: *IDN?
2025-07-01 15:39:40,062 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:39:40,065 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:39:40,065 - INFO - Query: *IDN?
2025-07-01 15:39:40,066 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:39:40,066 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:39:40,066 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:39:40,066 - DEBUG - Calling VSA_Config
2025-07-01 15:39:40,066 - INFO - Configuring VSA for STN
2025-07-01 15:39:40,066 - INFO - Query: *RST;*OPC?
2025-07-01 15:39:40,355 - INFO - Response: 1
2025-07-01 15:39:40,355 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:39:40,356 - INFO - Response: 1
2025-07-01 15:39:40,357 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:39:40,357 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:39:40,357 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:39:40,357 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:39:40,357 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:39:40,357 - INFO - Write: :INP:ATT 0
2025-07-01 15:39:40,358 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:39:40,358 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:39:40,358 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-01 15:39:40,358 - INFO - Write: :SENS:SWE:OPT SPE
2025-07-01 15:39:40,358 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:39:40,358 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 15:39:40,358 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:39:40,507 - INFO - Response: 1
2025-07-01 15:39:40,508 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:39:40,508 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:39:40,560 - INFO - Response: 1
2025-07-01 15:39:40,560 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:39:40,563 - INFO - Response: 1
2025-07-01 15:39:40,564 - INFO - Configuring noise marker for STN
2025-07-01 15:39:40,564 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:39:40,564 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:39:40,564 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:39:40,564 - INFO - Clearing error queue
2025-07-01 15:39:40,565 - INFO - Query: :SYST:ERR?
2025-07-01 15:39:40,643 - INFO - Response: 0,"No error"
2025-07-01 15:39:40,643 - DEBUG - Running STN iteration 1
2025-07-01 15:39:40,643 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:39:40,643 - INFO - Write: INIT:CONT OFF
2025-07-01 15:39:40,643 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:39:44,782 - INFO - Response: 1
2025-07-01 15:39:44,782 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:39:44,783 - INFO - Response: -165.91859436
2025-07-01 15:39:44,783 - INFO - Noise marker measured: -165.92 dBm
2025-07-01 15:39:44,783 - INFO - STN iteration 1: marker=-165.92dBm, meas_time=4.140sec
2025-07-01 15:39:44,783 - INFO - Closing VSA and VSG connections
2025-07-01 15:39:44,783 - INFO - Socket closed
2025-07-01 15:39:44,783 - INFO - Socket closed
2025-07-01 15:39:44,783 - INFO - Connections closed successfully
2025-07-01 15:39:44,786 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:39:45,052 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:39:45,104 - INFO - Socket closed
2025-07-01 15:39:45,106 - INFO - Socket closed
2025-07-01 15:40:33,214 - INFO - Starting RF measurement script
2025-07-01 15:40:33,217 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:40:33,218 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:40:33,218 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:40:33,218 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:40:33,218 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:40:33,218 - DEBUG - Initializing new STN instrument
2025-07-01 15:40:33,218 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:40:33,223 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:40:33,224 - INFO - Query: *IDN?
2025-07-01 15:40:33,228 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:40:33,231 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:40:33,231 - INFO - Query: *IDN?
2025-07-01 15:40:33,232 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:40:33,232 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:40:33,232 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:40:33,232 - DEBUG - Calling VSA_Config
2025-07-01 15:40:33,232 - INFO - Configuring VSA for STN
2025-07-01 15:40:33,232 - INFO - Query: *RST;*OPC?
2025-07-01 15:40:33,522 - INFO - Response: 1
2025-07-01 15:40:33,523 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:40:33,524 - INFO - Response: 1
2025-07-01 15:40:33,524 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:40:33,524 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:40:33,524 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:40:33,524 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:40:33,524 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:40:33,524 - INFO - Write: :INP:ATT 0
2025-07-01 15:40:33,524 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:40:33,524 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:40:33,524 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:40:33,524 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:40:33,525 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:40:33,525 - INFO - Write: SENS:AVER:COUN 20
2025-07-01 15:40:33,525 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:40:33,665 - INFO - Response: 1
2025-07-01 15:40:33,665 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:40:33,665 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:40:33,719 - INFO - Response: 1
2025-07-01 15:40:33,720 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:40:33,723 - INFO - Response: 1
2025-07-01 15:40:33,723 - INFO - Configuring noise marker for STN
2025-07-01 15:40:33,723 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:40:33,724 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:40:33,724 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:40:33,724 - INFO - Clearing error queue
2025-07-01 15:40:33,724 - INFO - Query: :SYST:ERR?
2025-07-01 15:40:33,832 - INFO - Response: 0,"No error"
2025-07-01 15:40:33,833 - DEBUG - Running STN iteration 1
2025-07-01 15:40:33,833 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:40:33,833 - INFO - Write: INIT:CONT OFF
2025-07-01 15:40:33,833 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:40:34,506 - INFO - Response: 1
2025-07-01 15:40:34,507 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:40:34,508 - INFO - Response: -167.522129059
2025-07-01 15:40:34,508 - INFO - Noise marker measured: -167.52 dBm
2025-07-01 15:40:34,508 - INFO - STN iteration 1: marker=-167.52dBm, meas_time=0.676sec
2025-07-01 15:40:34,509 - INFO - Closing VSA and VSG connections
2025-07-01 15:40:34,509 - INFO - Socket closed
2025-07-01 15:40:34,509 - INFO - Socket closed
2025-07-01 15:40:34,509 - INFO - Connections closed successfully
2025-07-01 15:40:34,512 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:40:34,901 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:40:34,970 - INFO - Socket closed
2025-07-01 15:40:34,972 - INFO - Socket closed
2025-07-01 15:40:46,820 - INFO - Starting RF measurement script
2025-07-01 15:40:46,823 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:40:46,823 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:40:46,823 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:40:46,823 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:40:46,823 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:40:46,824 - DEBUG - Initializing new STN instrument
2025-07-01 15:40:46,824 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:40:46,829 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:40:46,830 - INFO - Query: *IDN?
2025-07-01 15:40:46,831 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:40:46,834 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:40:46,834 - INFO - Query: *IDN?
2025-07-01 15:40:46,834 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:40:46,835 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:40:46,835 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:40:46,835 - DEBUG - Calling VSA_Config
2025-07-01 15:40:46,835 - INFO - Configuring VSA for STN
2025-07-01 15:40:46,835 - INFO - Query: *RST;*OPC?
2025-07-01 15:40:47,118 - INFO - Response: 1
2025-07-01 15:40:47,118 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:40:47,119 - INFO - Response: 1
2025-07-01 15:40:47,120 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:40:47,120 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:40:47,120 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:40:47,120 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:40:47,120 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:40:47,120 - INFO - Write: :INP:ATT 0
2025-07-01 15:40:47,120 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:40:47,120 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:40:47,120 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:40:47,121 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:40:47,121 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:40:47,121 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:40:47,121 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:40:47,256 - INFO - Response: 1
2025-07-01 15:40:47,257 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:40:47,257 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:40:47,311 - INFO - Response: 1
2025-07-01 15:40:47,312 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:40:47,315 - INFO - Response: 1
2025-07-01 15:40:47,315 - INFO - Configuring noise marker for STN
2025-07-01 15:40:47,315 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:40:47,316 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:40:47,316 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:40:47,316 - INFO - Clearing error queue
2025-07-01 15:40:47,316 - INFO - Query: :SYST:ERR?
2025-07-01 15:40:47,419 - INFO - Response: 0,"No error"
2025-07-01 15:40:47,419 - DEBUG - Running STN iteration 1
2025-07-01 15:40:47,419 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:40:47,419 - INFO - Write: INIT:CONT OFF
2025-07-01 15:40:47,419 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:40:50,421 - INFO - Response: 1
2025-07-01 15:40:50,422 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:40:50,423 - INFO - Response: -171.352863312
2025-07-01 15:40:50,423 - INFO - Noise marker measured: -171.35 dBm
2025-07-01 15:40:50,423 - INFO - STN iteration 1: marker=-171.35dBm, meas_time=3.004sec
2025-07-01 15:40:50,423 - INFO - Closing VSA and VSG connections
2025-07-01 15:40:50,424 - INFO - Socket closed
2025-07-01 15:40:50,424 - INFO - Socket closed
2025-07-01 15:40:50,424 - INFO - Connections closed successfully
2025-07-01 15:40:50,427 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:40:50,856 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:40:50,915 - INFO - Socket closed
2025-07-01 15:40:50,916 - INFO - Socket closed
2025-07-01 15:42:33,366 - INFO - Starting RF measurement script
2025-07-01 15:42:33,368 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:42:33,368 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.401,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:42:33,369 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.401, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:42:33,369 - INFO - Generated 1 frequencies: [2.4] GHz
2025-07-01 15:42:33,369 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:42:33,369 - DEBUG - Initializing new STN instrument
2025-07-01 15:42:33,369 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:42:33,374 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:42:33,374 - INFO - Query: *IDN?
2025-07-01 15:42:33,378 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:42:33,380 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:42:33,380 - INFO - Query: *IDN?
2025-07-01 15:42:33,381 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:42:33,381 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:42:33,381 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:42:33,381 - DEBUG - Calling VSA_Config
2025-07-01 15:42:33,381 - INFO - Configuring VSA for STN
2025-07-01 15:42:33,381 - INFO - Query: *RST;*OPC?
2025-07-01 15:42:33,627 - INFO - Response: 1
2025-07-01 15:42:33,627 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:42:33,628 - INFO - Response: 1
2025-07-01 15:42:33,628 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:42:33,628 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:42:33,628 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:42:33,629 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:42:33,629 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:42:33,629 - INFO - Write: :INP:ATT 0
2025-07-01 15:42:33,629 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:42:33,629 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:42:33,629 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:42:33,629 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:42:33,629 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:42:33,629 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:42:33,629 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:42:33,764 - INFO - Response: 1
2025-07-01 15:42:33,765 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:42:33,765 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:42:33,821 - INFO - Response: 1
2025-07-01 15:42:33,821 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:42:33,824 - INFO - Response: 1
2025-07-01 15:42:33,825 - INFO - Configuring noise marker for STN
2025-07-01 15:42:33,825 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:42:33,825 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:42:33,825 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:42:33,825 - INFO - Clearing error queue
2025-07-01 15:42:33,825 - INFO - Query: :SYST:ERR?
2025-07-01 15:42:33,893 - INFO - Response: 0,"No error"
2025-07-01 15:42:33,893 - DEBUG - Running STN iteration 1
2025-07-01 15:42:33,894 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:42:33,894 - INFO - Write: INIT:CONT OFF
2025-07-01 15:42:33,894 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:42:36,916 - INFO - Response: 1
2025-07-01 15:42:36,916 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:42:36,918 - INFO - Response: -171.61044693
2025-07-01 15:42:36,918 - INFO - Noise marker measured: -171.61 dBm
2025-07-01 15:42:36,918 - INFO - STN iteration 1: marker=-171.61dBm, meas_time=3.024sec
2025-07-01 15:42:36,918 - INFO - Closing VSA and VSG connections
2025-07-01 15:42:36,918 - INFO - Socket closed
2025-07-01 15:42:36,918 - INFO - Socket closed
2025-07-01 15:42:36,918 - INFO - Connections closed successfully
2025-07-01 15:42:36,920 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:42:37,157 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:42:37,211 - INFO - Socket closed
2025-07-01 15:42:37,212 - INFO - Socket closed
2025-07-01 15:43:04,914 - INFO - Starting RF measurement script
2025-07-01 15:43:04,923 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:43:04,924 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": true,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": false,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:43:04,924 - DEBUG - Processing STN test: {'run': True, 'center_frequency_ghz': {'range': {'start_ghz': 2.4, 'stop_ghz': 2.481, 'step_mhz': 20}}, 'iterations': 1}
2025-07-01 15:43:04,924 - INFO - Generated 5 frequencies: [2.4, 2.42025, 2.4405, 2.46075, 2.481] GHz
2025-07-01 15:43:04,924 - INFO - Preparing STN test set 1 at 2.400 GHz
2025-07-01 15:43:04,924 - DEBUG - Initializing new STN instrument
2025-07-01 15:43:04,924 - INFO - Initializing STN driver with freq=2.400GHz
2025-07-01 15:43:04,928 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:43:04,929 - INFO - Query: *IDN?
2025-07-01 15:43:04,930 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:43:04,932 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:43:04,932 - INFO - Query: *IDN?
2025-07-01 15:43:04,933 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:43:04,933 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:43:04,933 - DEBUG - Starting STN test set 1: freq=2.400GHz, iterations=1
2025-07-01 15:43:04,933 - DEBUG - Calling VSA_Config
2025-07-01 15:43:04,933 - INFO - Configuring VSA for STN
2025-07-01 15:43:04,933 - INFO - Query: *RST;*OPC?
2025-07-01 15:43:05,214 - INFO - Response: 1
2025-07-01 15:43:05,214 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:43:05,215 - INFO - Response: 1
2025-07-01 15:43:05,215 - INFO - Write: :SENS:FREQ:CENT 2400000000.0
2025-07-01 15:43:05,216 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:43:05,216 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:43:05,216 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:43:05,216 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:43:05,216 - INFO - Write: :INP:ATT 0
2025-07-01 15:43:05,216 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:43:05,216 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:43:05,216 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:43:05,216 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:43:05,216 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:43:05,216 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:43:05,217 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:05,363 - INFO - Response: 1
2025-07-01 15:43:05,364 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:43:05,364 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:05,408 - INFO - Response: 1
2025-07-01 15:43:05,408 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:05,412 - INFO - Response: 1
2025-07-01 15:43:05,412 - INFO - Configuring noise marker for STN
2025-07-01 15:43:05,412 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:43:05,412 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:43:05,412 - INFO - Write: :CALC1:MARK1:X 2400000000.0
2025-07-01 15:43:05,412 - INFO - Clearing error queue
2025-07-01 15:43:05,412 - INFO - Query: :SYST:ERR?
2025-07-01 15:43:05,520 - INFO - Response: 0,"No error"
2025-07-01 15:43:05,520 - DEBUG - Running STN iteration 1
2025-07-01 15:43:05,520 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:43:05,520 - INFO - Write: INIT:CONT OFF
2025-07-01 15:43:05,520 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:08,504 - INFO - Response: 1
2025-07-01 15:43:08,505 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:43:08,506 - INFO - Response: -171.592121124
2025-07-01 15:43:08,506 - INFO - Noise marker measured: -171.59 dBm
2025-07-01 15:43:08,506 - INFO - STN iteration 1: marker=-171.59dBm, meas_time=2.986sec
2025-07-01 15:43:08,506 - INFO - Preparing STN test set 2 at 2.420 GHz
2025-07-01 15:43:08,506 - DEBUG - Reusing STN instrument, setting freq to 2420250000.000 Hz
2025-07-01 15:43:08,506 - INFO - Setting STN frequency to 2.420GHz
2025-07-01 15:43:08,506 - INFO - Write: :SENS:FREQ:CENT 2420250000.0
2025-07-01 15:43:08,506 - INFO - Write: :CALC1:MARK1:X 2420250000.0
2025-07-01 15:43:08,506 - INFO - Query: *OPC?
2025-07-01 15:43:08,554 - INFO - Response: 1
2025-07-01 15:43:08,554 - DEBUG - Starting STN test set 2: freq=2.420GHz, iterations=1
2025-07-01 15:43:08,554 - DEBUG - Calling VSA_Config
2025-07-01 15:43:08,554 - INFO - Configuring VSA for STN
2025-07-01 15:43:08,554 - INFO - Query: *RST;*OPC?
2025-07-01 15:43:08,827 - INFO - Response: 1
2025-07-01 15:43:08,828 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:43:08,829 - INFO - Response: 1
2025-07-01 15:43:08,829 - INFO - Write: :SENS:FREQ:CENT 2420250000.0
2025-07-01 15:43:08,829 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:43:08,830 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:43:08,830 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:43:08,830 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:43:08,830 - INFO - Write: :INP:ATT 0
2025-07-01 15:43:08,830 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:43:08,831 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:43:08,831 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:43:08,831 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:43:08,831 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:43:08,831 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:43:08,832 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:08,973 - INFO - Response: 1
2025-07-01 15:43:08,974 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:43:08,974 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:09,030 - INFO - Response: 1
2025-07-01 15:43:09,030 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:09,034 - INFO - Response: 1
2025-07-01 15:43:09,034 - INFO - Configuring noise marker for STN
2025-07-01 15:43:09,035 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:43:09,035 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:43:09,035 - INFO - Write: :CALC1:MARK1:X 2420250000.0
2025-07-01 15:43:09,035 - INFO - Clearing error queue
2025-07-01 15:43:09,035 - INFO - Query: :SYST:ERR?
2025-07-01 15:43:09,138 - INFO - Response: 0,"No error"
2025-07-01 15:43:09,139 - DEBUG - Running STN iteration 1
2025-07-01 15:43:09,139 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:43:09,139 - INFO - Write: INIT:CONT OFF
2025-07-01 15:43:09,139 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:12,125 - INFO - Response: 1
2025-07-01 15:43:12,125 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:43:12,127 - INFO - Response: -169.6759758
2025-07-01 15:43:12,127 - INFO - Noise marker measured: -169.68 dBm
2025-07-01 15:43:12,127 - INFO - STN iteration 1: marker=-169.68dBm, meas_time=2.988sec
2025-07-01 15:43:12,127 - INFO - Preparing STN test set 3 at 2.441 GHz
2025-07-01 15:43:12,127 - DEBUG - Reusing STN instrument, setting freq to 2440500000.000 Hz
2025-07-01 15:43:12,127 - INFO - Setting STN frequency to 2.441GHz
2025-07-01 15:43:12,127 - INFO - Write: :SENS:FREQ:CENT 2440500000.0
2025-07-01 15:43:12,127 - INFO - Write: :CALC1:MARK1:X 2440500000.0
2025-07-01 15:43:12,127 - INFO - Query: *OPC?
2025-07-01 15:43:12,178 - INFO - Response: 1
2025-07-01 15:43:12,179 - DEBUG - Starting STN test set 3: freq=2.441GHz, iterations=1
2025-07-01 15:43:12,179 - DEBUG - Calling VSA_Config
2025-07-01 15:43:12,179 - INFO - Configuring VSA for STN
2025-07-01 15:43:12,179 - INFO - Query: *RST;*OPC?
2025-07-01 15:43:12,452 - INFO - Response: 1
2025-07-01 15:43:12,452 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:43:12,454 - INFO - Response: 1
2025-07-01 15:43:12,454 - INFO - Write: :SENS:FREQ:CENT 2440500000.0
2025-07-01 15:43:12,455 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:43:12,455 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:43:12,455 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:43:12,455 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:43:12,455 - INFO - Write: :INP:ATT 0
2025-07-01 15:43:12,455 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:43:12,456 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:43:12,456 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:43:12,456 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:43:12,456 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:43:12,456 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:43:12,456 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:12,598 - INFO - Response: 1
2025-07-01 15:43:12,599 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:43:12,599 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:12,654 - INFO - Response: 1
2025-07-01 15:43:12,655 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:12,659 - INFO - Response: 1
2025-07-01 15:43:12,659 - INFO - Configuring noise marker for STN
2025-07-01 15:43:12,660 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:43:12,660 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:43:12,660 - INFO - Write: :CALC1:MARK1:X 2440500000.0
2025-07-01 15:43:12,660 - INFO - Clearing error queue
2025-07-01 15:43:12,660 - INFO - Query: :SYST:ERR?
2025-07-01 15:43:12,747 - INFO - Response: 0,"No error"
2025-07-01 15:43:12,747 - DEBUG - Running STN iteration 1
2025-07-01 15:43:12,747 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:43:12,747 - INFO - Write: INIT:CONT OFF
2025-07-01 15:43:12,747 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:15,734 - INFO - Response: 1
2025-07-01 15:43:15,734 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:43:15,735 - INFO - Response: -169.716030121
2025-07-01 15:43:15,735 - INFO - Noise marker measured: -169.72 dBm
2025-07-01 15:43:15,736 - INFO - STN iteration 1: marker=-169.72dBm, meas_time=2.989sec
2025-07-01 15:43:15,736 - INFO - Preparing STN test set 4 at 2.461 GHz
2025-07-01 15:43:15,736 - DEBUG - Reusing STN instrument, setting freq to 2460750000.000 Hz
2025-07-01 15:43:15,736 - INFO - Setting STN frequency to 2.461GHz
2025-07-01 15:43:15,736 - INFO - Write: :SENS:FREQ:CENT 2460750000.0
2025-07-01 15:43:15,736 - INFO - Write: :CALC1:MARK1:X 2460750000.0
2025-07-01 15:43:15,736 - INFO - Query: *OPC?
2025-07-01 15:43:15,787 - INFO - Response: 1
2025-07-01 15:43:15,787 - DEBUG - Starting STN test set 4: freq=2.461GHz, iterations=1
2025-07-01 15:43:15,787 - DEBUG - Calling VSA_Config
2025-07-01 15:43:15,787 - INFO - Configuring VSA for STN
2025-07-01 15:43:15,787 - INFO - Query: *RST;*OPC?
2025-07-01 15:43:16,060 - INFO - Response: 1
2025-07-01 15:43:16,061 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:43:16,062 - INFO - Response: 1
2025-07-01 15:43:16,062 - INFO - Write: :SENS:FREQ:CENT 2460750000.0
2025-07-01 15:43:16,062 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:43:16,062 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:43:16,062 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:43:16,063 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:43:16,063 - INFO - Write: :INP:ATT 0
2025-07-01 15:43:16,063 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:43:16,063 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:43:16,063 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:43:16,063 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:43:16,063 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:43:16,064 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:43:16,064 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:16,206 - INFO - Response: 1
2025-07-01 15:43:16,207 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:43:16,207 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:16,261 - INFO - Response: 1
2025-07-01 15:43:16,261 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:16,265 - INFO - Response: 1
2025-07-01 15:43:16,266 - INFO - Configuring noise marker for STN
2025-07-01 15:43:16,266 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:43:16,266 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:43:16,266 - INFO - Write: :CALC1:MARK1:X 2460750000.0
2025-07-01 15:43:16,266 - INFO - Clearing error queue
2025-07-01 15:43:16,267 - INFO - Query: :SYST:ERR?
2025-07-01 15:43:16,389 - INFO - Response: 0,"No error"
2025-07-01 15:43:16,389 - DEBUG - Running STN iteration 1
2025-07-01 15:43:16,389 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:43:16,389 - INFO - Write: INIT:CONT OFF
2025-07-01 15:43:16,389 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:19,376 - INFO - Response: 1
2025-07-01 15:43:19,376 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:43:19,378 - INFO - Response: -170.779842377
2025-07-01 15:43:19,379 - INFO - Noise marker measured: -170.78 dBm
2025-07-01 15:43:19,379 - INFO - STN iteration 1: marker=-170.78dBm, meas_time=2.990sec
2025-07-01 15:43:19,379 - INFO - Preparing STN test set 5 at 2.481 GHz
2025-07-01 15:43:19,379 - DEBUG - Reusing STN instrument, setting freq to 2481000000.000 Hz
2025-07-01 15:43:19,379 - INFO - Setting STN frequency to 2.481GHz
2025-07-01 15:43:19,379 - INFO - Write: :SENS:FREQ:CENT 2481000000.0
2025-07-01 15:43:19,379 - INFO - Write: :CALC1:MARK1:X 2481000000.0
2025-07-01 15:43:19,379 - INFO - Query: *OPC?
2025-07-01 15:43:19,435 - INFO - Response: 1
2025-07-01 15:43:19,435 - DEBUG - Starting STN test set 5: freq=2.481GHz, iterations=1
2025-07-01 15:43:19,435 - DEBUG - Calling VSA_Config
2025-07-01 15:43:19,435 - INFO - Configuring VSA for STN
2025-07-01 15:43:19,435 - INFO - Query: *RST;*OPC?
2025-07-01 15:43:19,673 - INFO - Response: 1
2025-07-01 15:43:19,673 - INFO - Query: :INST:SEL "Spectrum";*OPC?
2025-07-01 15:43:19,674 - INFO - Response: 1
2025-07-01 15:43:19,674 - INFO - Write: :SENS:FREQ:CENT 2481000000.0
2025-07-01 15:43:19,674 - INFO - Write: :SENS:FREQ:SPAN 1e9
2025-07-01 15:43:19,675 - INFO - Write: :INP:GAIN:STAT ON
2025-07-01 15:43:19,675 - INFO - Write: :INP:GAIN:VAL 30
2025-07-01 15:43:19,675 - INFO - Write: :INP:ATT:AUTO OFF
2025-07-01 15:43:19,675 - INFO - Write: :INP:ATT 0
2025-07-01 15:43:19,675 - INFO - Write: :SENS:SWE:WIND:POIN 2001
2025-07-01 15:43:19,675 - INFO - Write: SENS:BAND:RES 1e6
2025-07-01 15:43:19,675 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-01 15:43:19,675 - INFO - Write: :SENS:SWE:OPT AUTO
2025-07-01 15:43:19,675 - INFO - Write: DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-01 15:43:19,676 - INFO - Write: SENS:AVER:COUN 100
2025-07-01 15:43:19,676 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:19,807 - INFO - Response: 1
2025-07-01 15:43:19,807 - INFO - Write: SENS:POW:NCOR ON
2025-07-01 15:43:19,808 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:19,865 - INFO - Response: 1
2025-07-01 15:43:19,865 - INFO - Query: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE;*OPC?
2025-07-01 15:43:19,868 - INFO - Response: 1
2025-07-01 15:43:19,869 - INFO - Configuring noise marker for STN
2025-07-01 15:43:19,869 - INFO - Write: :CALC1:DELT1:FUNC:PNO:STAT OFF
2025-07-01 15:43:19,869 - INFO - Write: :CALC1:MARK1:FUNC:NOIS:STAT ON
2025-07-01 15:43:19,870 - INFO - Write: :CALC1:MARK1:X 2481000000.0
2025-07-01 15:43:19,870 - INFO - Clearing error queue
2025-07-01 15:43:19,871 - INFO - Query: :SYST:ERR?
2025-07-01 15:43:19,937 - INFO - Response: 0,"No error"
2025-07-01 15:43:19,937 - DEBUG - Running STN iteration 1
2025-07-01 15:43:19,938 - INFO - Performing VSA sweep for STN noise marker
2025-07-01 15:43:19,938 - INFO - Write: INIT:CONT OFF
2025-07-01 15:43:19,938 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:43:22,938 - INFO - Response: 1
2025-07-01 15:43:22,939 - INFO - Query: :CALC:MARK:FUNC:NOIS:RES?
2025-07-01 15:43:22,940 - INFO - Response: -168.572223663
2025-07-01 15:43:22,940 - INFO - Noise marker measured: -168.57 dBm
2025-07-01 15:43:22,940 - INFO - STN iteration 1: marker=-168.57dBm, meas_time=3.002sec
2025-07-01 15:43:22,940 - INFO - Closing VSA and VSG connections
2025-07-01 15:43:22,940 - INFO - Socket closed
2025-07-01 15:43:22,940 - INFO - Socket closed
2025-07-01 15:43:22,940 - INFO - Connections closed successfully
2025-07-01 15:43:22,943 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:43:23,194 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:43:23,256 - INFO - Socket closed
2025-07-01 15:43:23,257 - INFO - Socket closed
2025-07-01 15:46:50,086 - INFO - Starting RF measurement script
2025-07-01 15:46:50,096 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 15:46:50,096 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 15:46:50,096 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.01, 'spur_limit_dbm': -95}
2025-07-01 15:46:50,102 - INFO - Connected to 192.168.200.20:5025
2025-07-01 15:46:50,103 - INFO - Query: *IDN?
2025-07-01 15:46:50,104 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 15:46:50,106 - INFO - Connected to 192.168.200.10:5025
2025-07-01 15:46:50,106 - INFO - Query: *IDN?
2025-07-01 15:46:50,107 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 15:46:50,107 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.01 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 15:46:50,107 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.010 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 15:46:50,107 - INFO - Write: *RST
2025-07-01 15:46:50,107 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 15:46:50,107 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 15:46:50,107 - INFO - Write: OUTP:STAT ON
2025-07-01 15:46:50,107 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 15:46:50,107 - INFO - Write: *RST
2025-07-01 15:46:50,107 - INFO - FSW reset for spur search
2025-07-01 15:46:50,107 - INFO - Write: INST:SEL 'SPUR'
2025-07-01 15:46:50,108 - INFO - Selected FSW-K50 Spurious application
2025-07-01 15:46:50,108 - INFO - Write: SENS:SSE:STYP WIDE
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:CLE
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG1:BAND:RES 10000
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 15:46:50,108 - INFO - Range 1: 1.2252.449 GHz
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG2:BAND:RES 10000
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-01 15:46:50,108 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-01 15:46:50,109 - INFO - Range 2: 2.4514.900 GHz
2025-07-01 15:46:50,109 - INFO - Spur detection table configured
2025-07-01 15:46:50,109 - INFO - Write: :INIT:CONT OFF
2025-07-01 15:46:50,109 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 15:47:10,296 - INFO - Response: 1
2025-07-01 15:47:10,297 - INFO - Spur search measurement completed
2025-07-01 15:47:10,297 - INFO - Query: TRAC3:DATA? LIST
2025-07-01 15:47:10,298 - INFO - Response: 4900000000.0,-48.77,46.23,9997.2,2451000000.0,4900000000.0,1,0,---,0
2025-07-01 15:47:10,299 - INFO - Spur: 4.900000 GHz, -48.77 dBm
2025-07-01 15:47:10,299 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-01 15:47:10,299 - INFO - Socket closed
2025-07-01 15:47:10,300 - INFO - FSW connection closed
2025-07-01 15:47:10,300 - INFO - Write: OUTP:STAT OFF
2025-07-01 15:47:10,300 - INFO - Socket closed
2025-07-01 15:47:10,300 - INFO - VSG connection closed
2025-07-01 15:47:10,303 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 15:47:10,567 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 15:47:10,627 - INFO - Socket closed
2025-07-01 15:47:10,629 - INFO - Socket closed
2025-07-01 16:14:46,270 - INFO - Starting RF measurement script
2025-07-01 16:14:46,274 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:14:46,274 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:14:46,275 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.01, 'spur_limit_dbm': -95}
2025-07-01 16:14:46,285 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:14:46,285 - INFO - Query: *IDN?
2025-07-01 16:14:46,344 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:14:46,349 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:14:46,349 - INFO - Query: *IDN?
2025-07-01 16:14:46,350 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:14:46,350 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.01 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:14:46,350 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.010 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:14:46,351 - INFO - Write: *RST
2025-07-01 16:14:46,351 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:14:46,352 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:14:46,352 - INFO - Write: OUTP:STAT ON
2025-07-01 16:14:46,352 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:14:46,352 - INFO - Write: *RST
2025-07-01 16:14:46,353 - INFO - FSW reset for spur search
2025-07-01 16:14:46,353 - INFO - Write: INST:SEL 'Spectrum'
2025-07-01 16:14:46,353 - INFO - Write: :INIT:SPUR
2025-07-01 16:14:46,353 - INFO - Selected Spurious application
2025-07-01 16:14:46,353 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:14:46,354 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:14:46,354 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:14:46,354 - INFO - Write: SENS:LIST:RANG1:BAND:RES 10000
2025-07-01 16:14:46,355 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:14:46,355 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:14:46,355 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:14:46,355 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:14:46,356 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:14:46,356 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:14:46,356 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:14:46,357 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:14:46,357 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:14:46,357 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:14:46,357 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 16:14:46,358 - INFO - Range 1: 1.2252.449 GHz
2025-07-01 16:14:46,358 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-01 16:14:46,358 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-01 16:14:46,358 - INFO - Write: SENS:LIST:RANG2:BAND:RES 10000
2025-07-01 16:14:46,359 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-01 16:14:46,359 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-01 16:14:46,359 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-01 16:14:46,359 - INFO - Range 2: 2.4514.900 GHz
2025-07-01 16:14:46,360 - INFO - Spur detection table configured
2025-07-01 16:14:46,360 - INFO - Write: :INIT:CONT OFF
2025-07-01 16:14:46,360 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 16:14:47,245 - INFO - Response: 1
2025-07-01 16:14:47,245 - INFO - Spur search measurement completed
2025-07-01 16:14:47,245 - INFO - Query: TRAC3:DATA? LIST
2025-07-01 16:14:47,310 - INFO - Response: +1.000000000,+9.000000000E+003,+1.500000000E+005,+1.000000000E+003,+2.559415121E+004,-9.966899109E+001,+0.000000000,-8.666899109E+001,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+9.000000000E+003,+1.500000000E+005,+1.000000000E+003,+1.388366619E+005,-1.020543289E+002,+0.000000000,-8.905432892E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+9.000000000E+003,+1.500000000E+005,+1.000000000E+003,+2.297931526E+004,-1.023911972E+002,+0.000000000,-8.939119720E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+9.000000000E+003,+1.500000000E+005,+1.000000000E+003,+4.007631954E+004,-1.025177688E+002,+0.000000000,-8.951776886E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+9.000000000E+003,+1.500000000E+005,+1.000000000E+003,+1.217396576E+005,-1.027126464E+002,+0.000000000,-8.971264648E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+9.000000000E+003,+1.500000000E+005,+1.000000000E+003,+7.527603424E+004,-1.039365158E+002,+0.000000000,-9.093651581E+001,+0.000000000,+0.000000000
2025-07-01 16:14:47,310 - INFO - Spur: 0.000000 GHz, 9000.00 dBm
2025-07-01 16:14:47,310 - INFO - Spur: 0.000000 GHz, -86.67 dBm
2025-07-01 16:14:47,310 - INFO - Spur: 0.000009 GHz, 150000.00 dBm
2025-07-01 16:14:47,311 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-01 16:14:47,311 - INFO - Spur: 0.000150 GHz, 1000.00 dBm
2025-07-01 16:14:47,311 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-01 16:14:47,311 - INFO - Spur: 0.000001 GHz, 40076.32 dBm
2025-07-01 16:14:47,311 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-01 16:14:47,311 - INFO - Spur: 0.000122 GHz, -102.71 dBm
2025-07-01 16:14:47,311 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-01 16:14:47,311 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-01 16:14:47,312 - INFO - Socket closed
2025-07-01 16:14:47,312 - INFO - FSW connection closed
2025-07-01 16:14:47,312 - INFO - Write: OUTP:STAT OFF
2025-07-01 16:14:47,312 - INFO - Socket closed
2025-07-01 16:14:47,312 - INFO - VSG connection closed
2025-07-01 16:14:47,315 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 16:14:47,849 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 16:14:47,899 - INFO - Socket closed
2025-07-01 16:14:47,900 - INFO - Socket closed
2025-07-01 16:16:00,135 - INFO - Starting RF measurement script
2025-07-01 16:16:00,140 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:16:00,141 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:16:00,141 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.01, 'spur_limit_dbm': -95}
2025-07-01 16:16:00,145 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:16:00,146 - INFO - Query: *IDN?
2025-07-01 16:16:00,173 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:16:00,176 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:16:00,177 - INFO - Query: *IDN?
2025-07-01 16:16:00,178 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:16:00,178 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.01 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:16:00,179 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.010 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:16:00,179 - INFO - Write: *RST
2025-07-01 16:16:00,180 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:16:00,181 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:16:00,181 - INFO - Write: OUTP:STAT ON
2025-07-01 16:16:00,181 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:16:00,182 - INFO - Write: *RST
2025-07-01 16:16:00,183 - INFO - FSW reset for spur search
2025-07-01 16:16:00,183 - INFO - Write: INST:SEL 'Spectrum'
2025-07-01 16:16:00,183 - INFO - Write: :INIT:SPUR
2025-07-01 16:16:00,183 - INFO - Selected Spurious application
2025-07-01 16:16:00,184 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:16:00,184 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:16:00,184 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:16:00,185 - INFO - Write: SENS:LIST:RANG1:BAND:RES 10000
2025-07-01 16:16:00,185 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:16:00,185 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:16:00,185 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:16:00,186 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:16:00,186 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:16:00,186 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:16:00,187 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:16:00,187 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:16:00,188 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:16:00,188 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:16:00,188 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 16:18:18,565 - INFO - Starting RF measurement script
2025-07-01 16:18:18,568 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:18:18,568 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:18:18,569 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.01, 'spur_limit_dbm': -95}
2025-07-01 16:18:18,573 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:18:18,573 - INFO - Query: *IDN?
2025-07-01 16:18:18,611 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:18:18,615 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:18:18,616 - INFO - Query: *IDN?
2025-07-01 16:18:18,617 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:18:18,617 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.01 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:18:18,617 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.010 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:18:18,618 - INFO - Write: *RST
2025-07-01 16:18:18,618 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:18:18,618 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:18:18,619 - INFO - Write: OUTP:STAT ON
2025-07-01 16:18:18,619 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:18:18,619 - INFO - Query: *RST;*OPC?
2025-07-01 16:18:18,878 - INFO - Response: 1
2025-07-01 16:18:18,879 - INFO - FSW reset for spur search
2025-07-01 16:18:18,879 - INFO - Write: INST:SEL 'Spectrum'
2025-07-01 16:18:18,880 - INFO - Write: :INIT:SPUR
2025-07-01 16:18:28,650 - INFO - Selected Spurious application
2025-07-01 16:18:28,651 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:18:28,651 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:18:28,651 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:18:28,652 - INFO - Write: SENS:LIST:RANG1:BAND:RES 10000
2025-07-01 16:18:28,652 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:18:28,652 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:18:28,652 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:18:28,652 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:18:28,652 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:18:28,652 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:18:28,653 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:18:28,653 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:18:28,653 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:18:28,653 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:18:28,653 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 16:19:02,166 - INFO - Range 1: 1.2252.449 GHz
2025-07-01 16:19:02,167 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-01 16:19:02,168 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-01 16:19:02,168 - INFO - Write: SENS:LIST:RANG2:BAND:RES 10000
2025-07-01 16:19:02,168 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-01 16:19:02,168 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-01 16:19:02,169 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-01 16:19:54,481 - INFO - Starting RF measurement script
2025-07-01 16:19:54,483 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:19:54,484 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:19:54,484 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.01, 'spur_limit_dbm': -95}
2025-07-01 16:19:54,488 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:19:54,488 - INFO - Query: *IDN?
2025-07-01 16:19:54,564 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:19:54,567 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:19:54,567 - INFO - Query: *IDN?
2025-07-01 16:19:54,568 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:19:54,568 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.01 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:19:54,568 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.010 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:19:54,569 - INFO - Write: *RST
2025-07-01 16:19:54,569 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:19:54,569 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:19:54,569 - INFO - Write: OUTP:STAT ON
2025-07-01 16:19:54,569 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:19:54,570 - INFO - Query: *RST;*OPC?
2025-07-01 16:19:54,870 - INFO - Response: 1
2025-07-01 16:19:54,871 - INFO - FSW reset for spur search
2025-07-01 16:19:54,871 - INFO - Write: INST:SEL 'Spectrum'
2025-07-01 16:19:54,871 - INFO - Write: :INIT:SPUR
2025-07-01 16:20:07,186 - INFO - Selected Spurious application
2025-07-01 16:20:07,186 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:20:23,488 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:41:40,135 - INFO - Starting RF measurement script
2025-07-01 16:41:40,138 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:41:40,139 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.01,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:41:40,139 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.01, 'spur_limit_dbm': -95}
2025-07-01 16:41:40,142 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:41:40,142 - INFO - Query: *IDN?
2025-07-01 16:41:40,213 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:41:40,218 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:41:40,218 - INFO - Query: *IDN?
2025-07-01 16:41:40,219 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:41:40,220 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.01 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:41:40,220 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.010 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:41:40,220 - INFO - Write: *RST
2025-07-01 16:41:40,221 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:41:40,221 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:41:40,221 - INFO - Write: OUTP:STAT ON
2025-07-01 16:41:40,221 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:41:40,222 - INFO - Query: *RST;*OPC?
2025-07-01 16:41:40,578 - INFO - Response: 1
2025-07-01 16:41:40,578 - INFO - FSW reset for spur search
2025-07-01 16:41:40,579 - INFO - Write: :INIT:SPUR
2025-07-01 16:43:09,567 - INFO - Selected Spurious application
2025-07-01 16:43:09,567 - INFO - Write: INIT:CONT OFF
2025-07-01 16:43:09,568 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 16:43:10,084 - INFO - Response: 1
2025-07-01 16:43:10,084 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:43:10,085 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:43:10,085 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:43:10,085 - INFO - Write: SENS:LIST:RANG1:BAND:RES 10000
2025-07-01 16:43:10,086 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:44:33,082 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:44:33,083 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:44:33,083 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:44:33,084 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:44:33,084 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:44:33,084 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:44:33,084 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:44:33,085 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:44:33,085 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:44:33,085 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 16:45:41,054 - INFO - Starting RF measurement script
2025-07-01 16:45:41,058 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:45:41,059 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1000,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:45:41,059 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1000, 'spur_limit_dbm': -95}
2025-07-01 16:45:41,062 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:45:41,062 - INFO - Query: *IDN?
2025-07-01 16:45:41,089 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:45:41,094 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:45:41,094 - INFO - Query: *IDN?
2025-07-01 16:45:41,096 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:45:41,096 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1000 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:45:41,096 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1000.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:45:41,097 - INFO - Write: *RST
2025-07-01 16:45:41,097 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:45:41,097 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:45:41,098 - INFO - Write: OUTP:STAT ON
2025-07-01 16:45:41,098 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:45:41,098 - INFO - Query: *RST;*OPC?
2025-07-01 16:45:41,486 - INFO - Response: 1
2025-07-01 16:45:41,486 - INFO - FSW reset for spur search
2025-07-01 16:45:41,486 - INFO - Write: :INIT:SPUR
2025-07-01 16:45:48,945 - INFO - Selected Spurious application
2025-07-01 16:45:48,946 - INFO - Write: INIT:CONT OFF
2025-07-01 16:45:48,946 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 16:45:49,382 - INFO - Response: 1
2025-07-01 16:45:49,382 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:45:49,382 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:45:49,382 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:45:49,383 - INFO - Write: SENS:LIST:RANG1:BAND:RES 1000000000
2025-07-01 16:45:49,383 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:45:52,138 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:45:52,138 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:45:52,138 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:45:52,139 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:45:52,139 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:45:52,139 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:45:52,139 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:45:52,139 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:45:52,139 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:45:52,139 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 16:47:04,901 - INFO - Starting RF measurement script
2025-07-01 16:47:04,902 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:47:04,902 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1000,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:47:04,902 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1000, 'spur_limit_dbm': -95}
2025-07-01 16:47:04,906 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:47:04,906 - INFO - Query: *IDN?
2025-07-01 16:47:04,933 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:47:04,937 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:47:04,937 - INFO - Query: *IDN?
2025-07-01 16:47:04,937 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:47:04,938 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1000 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:47:04,938 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1000.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:47:04,938 - INFO - Write: *RST
2025-07-01 16:47:04,938 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:47:04,938 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:47:04,938 - INFO - Write: OUTP:STAT ON
2025-07-01 16:47:04,939 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:47:04,939 - INFO - Query: *RST;*OPC?
2025-07-01 16:47:05,325 - INFO - Response: 1
2025-07-01 16:47:05,326 - INFO - FSW reset for spur search
2025-07-01 16:47:05,326 - INFO - Write: :INIT:SPUR
2025-07-01 16:47:05,326 - INFO - Selected Spurious application
2025-07-01 16:47:05,326 - INFO - Write: INIT:CONT OFF
2025-07-01 16:47:05,326 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 16:47:05,907 - INFO - Response: 1
2025-07-01 16:47:05,907 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:47:05,907 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:47:05,908 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:BAND:RES 1000000000.0
2025-07-01 16:47:05,908 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:47:05,908 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-01 16:47:05,908 - INFO - Range 1: 1.2252.449 GHz
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-01 16:47:05,908 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000000
2025-07-01 16:47:05,909 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-01 16:47:05,909 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-01 16:47:05,909 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-01 16:47:05,909 - INFO - Range 2: 2.4514.900 GHz
2025-07-01 16:47:05,909 - INFO - Spur detection table configured
2025-07-01 16:47:05,909 - INFO - Write: :INIT:CONT OFF
2025-07-01 16:47:05,909 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 16:47:22,782 - INFO - Response: 1
2025-07-01 16:47:22,782 - INFO - Spur search measurement completed
2025-07-01 16:47:22,782 - INFO - Query: TRAC3:DATA? LIST
2025-07-01 16:47:22,818 - INFO - Response: +1.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+003,+2.448694153E+009,-1.141004943E+002,+0.000000000,-1.011004943E+002,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+004,+4.899693952E+009,-6.925862885E+001,+0.000000000,-5.625862885E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+004,+2.453754436E+009,-9.697620392E+001,+0.000000000,-8.397620392E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+004,+3.831584729E+009,-9.875411987E+001,+0.000000000,-8.575411987E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+4.900000000E+009,+4.900000020E+009,+1.000000000E+005,+4.900000000E+009,-4.876739502E+001,+0.000000000,-3.576739502E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+4.900000020E+009,+1.275000000E+010,+1.000000000E+006,+4.900122672E+009,-4.916971970E+001,+0.000000000,-3.616971970E+001,+0.000000000,+0.000000000
2025-07-01 16:47:22,819 - INFO - Spur: 0.000000 GHz, 1225000000.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 0.000000 GHz, -101.10 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 2.451000 GHz, 4900000000.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 4.900000 GHz, 10000.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 0.000010 GHz, 3831584729.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 4.900000 GHz, -48.77 dBm
2025-07-01 16:47:22,819 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-01 16:47:22,819 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-01 16:47:22,819 - INFO - Socket closed
2025-07-01 16:47:22,819 - INFO - FSW connection closed
2025-07-01 16:47:22,819 - INFO - Write: OUTP:STAT OFF
2025-07-01 16:47:22,819 - INFO - Socket closed
2025-07-01 16:47:22,819 - INFO - VSG connection closed
2025-07-01 16:47:22,821 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-01 16:47:23,063 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-01 16:47:23,103 - INFO - Socket closed
2025-07-01 16:47:23,104 - INFO - Socket closed
2025-07-01 16:47:33,563 - INFO - Starting RF measurement script
2025-07-01 16:47:33,565 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-01 16:47:33,566 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1000,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-01 16:47:33,566 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1000, 'spur_limit_dbm': -95}
2025-07-01 16:47:33,569 - INFO - Connected to 192.168.200.20:5025
2025-07-01 16:47:33,569 - INFO - Query: *IDN?
2025-07-01 16:47:33,570 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-01 16:47:33,572 - INFO - Connected to 192.168.200.10:5025
2025-07-01 16:47:33,572 - INFO - Query: *IDN?
2025-07-01 16:47:33,573 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-01 16:47:33,573 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1000 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-01 16:47:33,573 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1000.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-01 16:47:33,573 - INFO - Write: *RST
2025-07-01 16:47:33,573 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-01 16:47:33,574 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-01 16:47:33,574 - INFO - Write: OUTP:STAT ON
2025-07-01 16:47:33,574 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-01 16:47:33,574 - INFO - Query: *RST;*OPC?
2025-07-01 16:47:33,961 - INFO - Response: 1
2025-07-01 16:47:33,961 - INFO - FSW reset for spur search
2025-07-01 16:47:33,961 - INFO - Write: :INIT:SPUR
2025-07-01 16:47:33,962 - INFO - Selected Spurious application
2025-07-01 16:47:33,962 - INFO - Write: INIT:CONT OFF
2025-07-01 16:47:33,962 - INFO - Query: INIT:IMM;*OPC?
2025-07-01 16:47:34,534 - INFO - Response: 1
2025-07-01 16:47:34,535 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-01 16:47:34,535 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-01 16:47:34,535 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-01 16:47:34,535 - INFO - Write: SENS:LIST:RANG1:BAND:RES 1000000000.0
2025-07-01 16:47:34,535 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-01 16:47:48,699 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-01 16:47:48,700 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-01 16:47:48,700 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-01 16:47:48,700 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-01 16:47:48,700 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-01 16:47:48,700 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-01 16:47:48,700 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-01 16:47:48,701 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-01 16:47:48,701 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-01 16:47:48,701 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:07:07,905 - INFO - Starting RF measurement script
2025-07-02 09:07:07,918 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:07:07,919 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1000,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:07:07,919 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1000, 'spur_limit_dbm': -95}
2025-07-02 09:07:07,929 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:07:07,929 - INFO - Query: *IDN?
2025-07-02 09:07:07,952 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:07:07,957 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:07:07,958 - INFO - Query: *IDN?
2025-07-02 09:07:07,959 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:07:07,960 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1000 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:07:07,961 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1000.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:07:07,961 - INFO - Write: *RST
2025-07-02 09:07:07,962 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:07:07,962 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:07:07,963 - INFO - Write: OUTP:STAT ON
2025-07-02 09:07:07,963 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:07:07,964 - INFO - Query: *RST;*OPC?
2025-07-02 09:07:08,072 - INFO - Response: 1
2025-07-02 09:07:08,072 - INFO - FSW reset for spur search
2025-07-02 09:07:08,073 - INFO - Write: :INIT:SPUR
2025-07-02 09:07:08,073 - INFO - Selected Spurious application
2025-07-02 09:07:08,074 - INFO - Write: INIT:CONT OFF
2025-07-02 09:07:08,074 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:07:08,582 - INFO - Response: 1
2025-07-02 09:07:08,583 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:07:08,583 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:07:08,583 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:07:08,583 - INFO - Write: SENS:LIST:RANG1:BAND:RES 1000000000.0
2025-07-02 09:07:08,583 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:07:08,583 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:07:08,583 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:07:08,584 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:07:08,584 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:07:08,584 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:07:08,584 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:07:08,584 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:07:08,584 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:07:08,584 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:07:08,585 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:10:56,533 - INFO - Starting RF measurement script
2025-07-02 09:10:56,537 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:10:56,538 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1000,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:10:56,538 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1000, 'spur_limit_dbm': -95}
2025-07-02 09:10:56,541 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:10:56,541 - INFO - Query: *IDN?
2025-07-02 09:10:56,557 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:10:56,560 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:10:56,560 - INFO - Query: *IDN?
2025-07-02 09:10:56,561 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:10:56,561 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1000 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:10:56,561 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1000.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:10:56,562 - INFO - Write: *RST
2025-07-02 09:10:56,562 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:10:56,562 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:10:56,562 - INFO - Write: OUTP:STAT ON
2025-07-02 09:10:56,562 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:10:56,562 - INFO - Query: *RST;*OPC?
2025-07-02 09:10:56,660 - INFO - Response: 1
2025-07-02 09:10:56,661 - INFO - FSW reset for spur search
2025-07-02 09:10:56,661 - INFO - Write: :INIT:SPUR
2025-07-02 09:10:56,661 - INFO - Selected Spurious application
2025-07-02 09:10:56,661 - INFO - Write: INIT:CONT OFF
2025-07-02 09:10:56,661 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:10:56,661 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:10:56,661 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:10:56,661 - INFO - Write: SENS:LIST:RANG1:BAND:RES 1000000000.0
2025-07-02 09:10:56,662 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:10:56,662 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:10:56,662 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:10:56,662 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:10:56,662 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:10:56,662 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:10:56,662 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:10:56,662 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:10:56,663 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:10:56,663 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:10:56,663 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:12:49,408 - INFO - Starting RF measurement script
2025-07-02 09:12:49,412 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:12:49,412 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1000,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:12:49,412 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1000, 'spur_limit_dbm': -95}
2025-07-02 09:12:49,416 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:12:49,416 - INFO - Query: *IDN?
2025-07-02 09:12:49,431 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:12:49,435 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:12:49,435 - INFO - Query: *IDN?
2025-07-02 09:12:49,436 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:12:49,437 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1000 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:12:49,437 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1000.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:12:49,437 - INFO - Write: *RST
2025-07-02 09:12:49,437 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:12:49,438 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:12:49,438 - INFO - Write: OUTP:STAT ON
2025-07-02 09:12:49,438 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:12:49,438 - INFO - Query: *RST;*OPC?
2025-07-02 09:12:49,627 - INFO - Response: 1
2025-07-02 09:12:49,628 - INFO - FSW reset for spur search
2025-07-02 09:12:49,628 - INFO - Write: :INIT:SPUR
2025-07-02 09:12:49,628 - INFO - Selected Spurious application
2025-07-02 09:12:49,628 - INFO - Write: INIT:CONT OFF
2025-07-02 09:12:49,629 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:12:49,629 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:12:49,629 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:12:49,629 - INFO - Write: SENS:LIST:RANG1:BAND:RES 1000000000.0;*OPC
2025-07-02 09:12:49,629 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:12:49,629 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:12:49,629 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:12:49,629 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:12:49,630 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:12:49,630 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:12:49,630 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:12:49,630 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:12:49,630 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:12:49,630 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:12:49,630 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:17:17,056 - INFO - Starting RF measurement script
2025-07-02 09:17:17,059 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:17:17,060 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:17:17,060 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:17:17,064 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:17:17,064 - INFO - Query: *IDN?
2025-07-02 09:17:17,079 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:17:17,083 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:17:17,083 - INFO - Query: *IDN?
2025-07-02 09:17:17,084 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:17:17,085 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:17:17,085 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:17:17,085 - INFO - Write: *RST
2025-07-02 09:17:17,085 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:17:17,085 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:17:17,085 - INFO - Write: OUTP:STAT ON
2025-07-02 09:17:17,086 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:17:17,086 - INFO - Query: *RST;*OPC?
2025-07-02 09:17:17,182 - INFO - Response: 1
2025-07-02 09:17:17,182 - INFO - FSW reset for spur search
2025-07-02 09:17:17,182 - INFO - Write: :INIT:SPUR
2025-07-02 09:17:17,182 - INFO - Selected Spurious application
2025-07-02 09:17:17,183 - INFO - Write: INIT:CONT OFF
2025-07-02 09:17:17,183 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:17:17,183 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:17:17,183 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:17:17,183 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:35:56,134 - INFO - Starting RF measurement script
2025-07-02 09:35:56,136 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:35:56,137 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:35:56,138 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:35:56,143 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:35:56,144 - INFO - Query: *IDN?
2025-07-02 09:35:56,245 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:35:56,248 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:35:56,248 - INFO - Query: *IDN?
2025-07-02 09:35:56,249 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:35:56,249 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:35:56,249 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:35:56,249 - INFO - Write: *RST
2025-07-02 09:35:56,249 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:35:56,249 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:35:56,250 - INFO - Write: OUTP:STAT ON
2025-07-02 09:35:56,250 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:35:56,250 - INFO - Query: *RST;*OPC?
2025-07-02 09:35:56,342 - INFO - Response: 1
2025-07-02 09:35:56,343 - INFO - FSW reset for spur search
2025-07-02 09:35:56,343 - INFO - Write: :INIT:SPUR
2025-07-02 09:35:56,343 - INFO - Selected Spurious application
2025-07-02 09:35:56,343 - INFO - Write: INIT:CONT OFF
2025-07-02 09:35:56,343 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:35:56,343 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:35:56,343 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:35:56,343 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:35:56,344 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:35:56,344 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:35:56,344 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:35:56,344 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:35:56,344 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:35:56,344 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:35:56,344 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:35:56,345 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:35:56,345 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:35:56,345 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:35:56,345 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:35:56,345 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:35:56,345 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:35:56,345 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:35:56,345 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:35:56,346 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:35:56,346 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:35:56,346 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:35:56,346 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:35:56,346 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:35:56,346 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:35:56,346 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:35:56,346 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:35:56,347 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:35:56,347 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:35:56,347 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:35:56,347 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:35:56,347 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:35:56,347 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:35:56,348 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:35:56,348 - INFO - Write: :SENS:LIST:RANG3 DEL
2025-07-02 09:35:56,348 - INFO - Write: :SENS:LIST:RANG4 DEL
2025-07-02 09:35:56,348 - INFO - Spur detection table configured
2025-07-02 09:35:56,348 - INFO - Write: :INIT:CONT OFF
2025-07-02 09:35:56,348 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:35:58,112 - INFO - Response: 1
2025-07-02 09:35:58,112 - INFO - Spur search measurement completed
2025-07-02 09:35:58,113 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 09:35:58,153 - INFO - Response: +1.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.448694153E+009,-2.304372025E+001,+0.000000000,-1.004372024E+001,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.347764618E+009,-3.530027771E+001,+0.000000000,-2.230027771E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.451611944E+009,-2.672497749E+001,+0.000000000,-1.372497749E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.460179160E+009,-4.533184814E+001,+0.000000000,-3.233184814E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.467522489E+009,-4.936742783E+001,+0.000000000,-3.636742783E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.455283608E+009,-5.153886032E+001,+0.000000000,-3.853886032E+001,+0.000000000,+0.000000000
2025-07-02 09:35:58,154 - INFO - Spur: 0.000000 GHz, 1225000000.00 dBm
2025-07-02 09:35:58,154 - INFO - Spur: 0.000000 GHz, -10.04 dBm
2025-07-02 09:35:58,154 - INFO - Spur: 1.225000 GHz, 2449000000.00 dBm
2025-07-02 09:35:58,154 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:35:58,154 - INFO - Spur: 4.900000 GHz, 1000000.00 dBm
2025-07-02 09:35:58,154 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:35:58,154 - INFO - Spur: 0.001000 GHz, 2460179160.00 dBm
2025-07-02 09:35:58,155 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:35:58,155 - INFO - Spur: 2.467522 GHz, -49.37 dBm
2025-07-02 09:35:58,155 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-02 09:35:58,155 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:35:58,156 - INFO - Socket closed
2025-07-02 09:35:58,156 - INFO - FSW connection closed
2025-07-02 09:35:58,156 - INFO - Write: OUTP:STAT OFF
2025-07-02 09:35:58,157 - INFO - Socket closed
2025-07-02 09:35:58,157 - INFO - VSG connection closed
2025-07-02 09:35:58,161 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 09:35:59,422 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 09:35:59,475 - INFO - Socket closed
2025-07-02 09:35:59,477 - INFO - Socket closed
2025-07-02 09:37:03,100 - INFO - Starting RF measurement script
2025-07-02 09:37:03,103 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:37:03,104 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:37:03,104 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:37:03,107 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:37:03,108 - INFO - Query: *IDN?
2025-07-02 09:37:03,123 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:37:03,126 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:37:03,126 - INFO - Query: *IDN?
2025-07-02 09:37:03,127 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:37:03,127 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:37:03,128 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:37:03,128 - INFO - Write: *RST
2025-07-02 09:37:03,128 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:37:03,128 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:37:03,129 - INFO - Write: OUTP:STAT ON
2025-07-02 09:37:03,129 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:37:03,129 - INFO - Query: *RST;*OPC?
2025-07-02 09:37:03,212 - INFO - Response: 1
2025-07-02 09:37:03,212 - INFO - FSW reset for spur search
2025-07-02 09:37:03,212 - INFO - Write: :INIT:SPUR
2025-07-02 09:37:03,212 - INFO - Selected Spurious application
2025-07-02 09:37:03,212 - INFO - Write: INIT:CONT OFF
2025-07-02 09:37:03,213 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:37:03,213 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:37:03,213 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:37:03,213 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:37:03,213 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:37:03,213 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:37:03,213 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:37:03,214 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:37:03,214 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:37:03,214 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:37:03,214 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:37:03,214 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:37:03,214 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:37:03,214 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:37:03,215 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:37:03,215 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:37:03,215 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:37:03,215 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:37:03,215 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:37:03,215 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:37:03,215 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:37:03,216 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:37:03,216 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:37:03,216 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:37:03,216 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:37:03,216 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:37:03,216 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:37:03,216 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:37:03,217 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:37:03,217 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:37:03,217 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:37:03,217 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:37:03,217 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:37:03,217 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:37:03,217 - INFO - Write: :SENS:LIST:RANG3:DEL
2025-07-02 09:37:03,218 - INFO - Write: :SENS:LIST:RANG4:DEL
2025-07-02 09:37:40,713 - INFO - Spur detection table configured
2025-07-02 09:37:40,713 - INFO - Write: :INIT:CONT OFF
2025-07-02 09:37:40,714 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:37:42,049 - INFO - Response: 1
2025-07-02 09:37:42,049 - INFO - Spur search measurement completed
2025-07-02 09:37:42,050 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 09:37:42,081 - INFO - Response: +1.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.448694153E+009,-2.305050850E+001,+0.000000000,-1.005050849E+001,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.444412294E+009,-3.611516190E+001,+0.000000000,-2.311516190E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.439518741E+009,-5.411767197E+001,+0.000000000,-4.111767197E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.451611944E+009,-2.672501755E+001,+0.000000000,-1.372501755E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.460179160E+009,-4.557437515E+001,+0.000000000,-3.257437515E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.467522489E+009,-4.979297638E+001,+0.000000000,-3.679297638E+001,+0.000000000,+0.000000000
2025-07-02 09:37:42,081 - INFO - Spur: 0.000000 GHz, 1225000000.00 dBm
2025-07-02 09:37:42,081 - INFO - Spur: 0.000000 GHz, -10.05 dBm
2025-07-02 09:37:42,081 - INFO - Spur: 1.225000 GHz, 2449000000.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: 2.449000 GHz, 1000000.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: 0.001000 GHz, 2451611944.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: 2.460179 GHz, -45.57 dBm
2025-07-02 09:37:42,082 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-02 09:37:42,082 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:37:42,083 - INFO - Socket closed
2025-07-02 09:37:42,083 - INFO - FSW connection closed
2025-07-02 09:37:42,083 - INFO - Write: OUTP:STAT OFF
2025-07-02 09:37:42,083 - INFO - Socket closed
2025-07-02 09:37:42,083 - INFO - VSG connection closed
2025-07-02 09:37:42,086 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 09:37:42,512 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 09:37:42,552 - INFO - Socket closed
2025-07-02 09:37:42,553 - INFO - Socket closed
2025-07-02 09:39:17,992 - INFO - Starting RF measurement script
2025-07-02 09:39:17,996 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:39:17,996 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:39:17,996 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:39:18,000 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:39:18,000 - INFO - Query: *IDN?
2025-07-02 09:39:18,014 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:39:18,019 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:39:18,020 - INFO - Query: *IDN?
2025-07-02 09:39:18,022 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:39:18,022 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:39:18,022 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:39:18,023 - INFO - Write: *RST
2025-07-02 09:39:18,023 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:39:18,023 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:39:18,024 - INFO - Write: OUTP:STAT ON
2025-07-02 09:39:18,024 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:39:18,024 - INFO - Query: *RST;*OPC?
2025-07-02 09:39:18,211 - INFO - Response: 1
2025-07-02 09:39:18,212 - INFO - FSW reset for spur search
2025-07-02 09:39:18,212 - INFO - Write: :INIT:SPUR
2025-07-02 09:39:18,213 - INFO - Selected Spurious application
2025-07-02 09:39:18,214 - INFO - Write: INIT:CONT OFF
2025-07-02 09:39:18,214 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:39:18,215 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:39:18,215 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:39:18,216 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:39:18,216 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:39:18,217 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:39:18,218 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:39:18,219 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:39:18,219 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:39:18,220 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:39:18,221 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:39:18,221 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:39:18,222 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:39:18,223 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:39:18,223 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:39:18,224 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:39:18,225 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:39:18,225 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:39:18,226 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:39:18,226 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:39:18,227 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:39:18,227 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:39:18,228 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:39:18,228 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:39:18,229 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:39:18,229 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:39:18,229 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:39:18,230 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:39:18,230 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:39:18,231 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:39:18,231 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:39:18,231 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:39:18,232 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:39:26,480 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:39:28,806 - INFO - Write: :SENS:LIST:RANG3:DEL
2025-07-02 09:39:31,018 - INFO - Write: :SENS:LIST:RANG4:DEL
2025-07-02 09:40:18,327 - INFO - Starting RF measurement script
2025-07-02 09:40:18,329 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:40:18,329 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:40:18,329 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:40:18,332 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:40:18,332 - INFO - Query: *IDN?
2025-07-02 09:40:18,383 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:40:18,386 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:40:18,387 - INFO - Query: *IDN?
2025-07-02 09:40:18,387 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:40:18,387 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:40:18,388 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:40:18,388 - INFO - Write: *RST
2025-07-02 09:40:18,388 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:40:18,388 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:40:18,388 - INFO - Write: OUTP:STAT ON
2025-07-02 09:40:18,388 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:40:18,388 - INFO - Query: *RST;*OPC?
2025-07-02 09:40:18,570 - INFO - Response: 1
2025-07-02 09:40:18,571 - INFO - FSW reset for spur search
2025-07-02 09:40:18,571 - INFO - Write: :INIT:SPUR
2025-07-02 09:40:18,571 - INFO - Selected Spurious application
2025-07-02 09:40:18,571 - INFO - Write: INIT:CONT OFF
2025-07-02 09:40:18,571 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:40:18,572 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:40:18,572 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:40:18,572 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:40:18,572 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:40:18,572 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:40:18,572 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:40:18,572 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:40:18,573 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:40:18,573 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:40:18,573 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:40:18,573 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:40:18,573 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:40:18,573 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:40:18,573 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:40:18,574 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:40:18,574 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:40:18,574 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:40:18,574 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:40:18,574 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:40:18,574 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:40:18,574 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:40:18,574 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:40:18,575 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:40:18,575 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:40:18,575 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:40:18,575 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:40:18,575 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:40:18,575 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:40:18,575 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:40:18,576 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:40:18,576 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:40:18,576 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:40:18,576 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:40:18,576 - INFO - Write: :SENS:LIST:RANG3:DEL
2025-07-02 09:40:18,576 - INFO - Write: :SENS:LIST:RANG4:DEL
2025-07-02 09:40:26,243 - INFO - Spur detection table configured
2025-07-02 09:40:26,244 - INFO - Write: :INIT:CONT OFF
2025-07-02 09:40:26,244 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:40:27,592 - INFO - Response: 1
2025-07-02 09:40:27,592 - INFO - Spur search measurement completed
2025-07-02 09:40:27,593 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 09:40:27,595 - INFO - Response: +1.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.448694153E+009,-2.305177689E+001,+0.000000000,-1.005177688E+001,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.444412294E+009,-3.639606094E+001,+0.000000000,-2.339606094E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.439518741E+009,-5.400326157E+001,+0.000000000,-4.100326157E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.440742129E+009,-5.688596344E+001,+0.000000000,-4.388596344E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.451611944E+009,-2.672414780E+001,+0.000000000,-1.372414780E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.460179160E+009,-4.553532410E+001,+0.000000000,-3.253532410E+001,+0.000000000,+0.000000000
2025-07-02 09:40:27,596 - INFO - Spur: 0.000000 GHz, 1225000000.00 dBm
2025-07-02 09:40:27,596 - INFO - Spur: 0.000000 GHz, -10.05 dBm
2025-07-02 09:40:27,596 - INFO - Spur: 1.225000 GHz, 2449000000.00 dBm
2025-07-02 09:40:27,597 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:40:27,597 - INFO - Spur: 2.449000 GHz, 1000000.00 dBm
2025-07-02 09:40:27,597 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:40:27,598 - INFO - Spur: 0.001000 GHz, 2440742129.00 dBm
2025-07-02 09:40:27,598 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:40:27,598 - INFO - Spur: 2.451612 GHz, -26.72 dBm
2025-07-02 09:40:27,599 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-02 09:40:27,599 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:40:27,600 - INFO - Socket closed
2025-07-02 09:40:27,600 - INFO - FSW connection closed
2025-07-02 09:40:27,600 - INFO - Write: OUTP:STAT OFF
2025-07-02 09:40:27,601 - INFO - Socket closed
2025-07-02 09:40:27,601 - INFO - VSG connection closed
2025-07-02 09:40:27,605 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 09:40:28,105 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 09:40:28,155 - INFO - Socket closed
2025-07-02 09:40:28,157 - INFO - Socket closed
2025-07-02 09:41:50,559 - INFO - Starting RF measurement script
2025-07-02 09:41:50,562 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:41:50,562 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:41:50,562 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:41:50,565 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:41:50,566 - INFO - Query: *IDN?
2025-07-02 09:41:50,581 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:41:50,584 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:41:50,585 - INFO - Query: *IDN?
2025-07-02 09:41:50,585 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:41:50,585 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:41:50,585 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:41:50,586 - INFO - Write: *RST
2025-07-02 09:41:50,586 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:41:50,586 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:41:50,586 - INFO - Write: OUTP:STAT ON
2025-07-02 09:41:50,586 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:41:50,586 - INFO - Query: *RST;*OPC?
2025-07-02 09:41:50,666 - INFO - Response: 1
2025-07-02 09:41:50,667 - INFO - FSW reset for spur search
2025-07-02 09:41:50,667 - INFO - Write: :INIT:SPUR
2025-07-02 09:41:50,667 - INFO - Selected Spurious application
2025-07-02 09:41:50,668 - INFO - Write: INIT:CONT OFF
2025-07-02 09:41:50,668 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:41:50,668 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:41:50,668 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:41:50,668 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:41:50,668 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:41:50,669 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:41:50,669 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:41:50,669 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:41:50,669 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:41:50,670 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:41:50,670 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:41:50,670 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:41:50,670 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:41:50,671 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:41:50,671 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:41:50,671 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:41:50,671 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:41:50,671 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:41:50,672 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:41:50,672 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:41:50,672 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:41:50,672 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:41:50,672 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:41:50,672 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:41:50,672 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:41:50,672 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:41:50,673 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:41:50,673 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:41:50,673 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:41:50,673 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:41:50,673 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:41:50,673 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:41:50,673 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:41:50,673 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:41:50,674 - INFO - Query: :SENS:LIST:RANG3:DEL;*OPC?
2025-07-02 09:41:50,994 - INFO - Response: 1
2025-07-02 09:41:58,465 - INFO - Spur detection table configured
2025-07-02 09:41:58,466 - INFO - Write: :INIT:CONT OFF
2025-07-02 09:41:58,466 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:41:59,779 - INFO - Response: 1
2025-07-02 09:41:59,780 - INFO - Spur search measurement completed
2025-07-02 09:41:59,781 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 09:41:59,812 - INFO - Response: +1.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.448694153E+009,-2.305217361E+001,+0.000000000,-1.005217361E+001,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.444412294E+009,-3.629558945E+001,+0.000000000,-2.329558945E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.439518741E+009,-5.350672150E+001,+0.000000000,-4.050672150E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.441353823E+009,-5.693131256E+001,+0.000000000,-4.393131256E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.451611944E+009,-2.672630501E+001,+0.000000000,-1.372630501E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.460179160E+009,-4.594826126E+001,+0.000000000,-3.294826126E+001,+0.000000000,+0.000000000
2025-07-02 09:41:59,813 - INFO - Spur: 0.000000 GHz, 1225000000.00 dBm
2025-07-02 09:41:59,814 - INFO - Spur: 0.000000 GHz, -10.05 dBm
2025-07-02 09:41:59,814 - INFO - Spur: 1.225000 GHz, 2449000000.00 dBm
2025-07-02 09:41:59,815 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:41:59,815 - INFO - Spur: 2.449000 GHz, 1000000.00 dBm
2025-07-02 09:41:59,815 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:41:59,816 - INFO - Spur: 0.001000 GHz, 2441353823.00 dBm
2025-07-02 09:41:59,816 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:41:59,816 - INFO - Spur: 2.451612 GHz, -26.73 dBm
2025-07-02 09:41:59,817 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-02 09:41:59,817 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:41:59,818 - INFO - Socket closed
2025-07-02 09:41:59,818 - INFO - FSW connection closed
2025-07-02 09:41:59,819 - INFO - Write: OUTP:STAT OFF
2025-07-02 09:41:59,820 - INFO - Socket closed
2025-07-02 09:41:59,820 - INFO - VSG connection closed
2025-07-02 09:41:59,824 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 09:42:00,340 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 09:42:00,381 - INFO - Socket closed
2025-07-02 09:42:00,383 - INFO - Socket closed
2025-07-02 09:43:41,824 - INFO - Starting RF measurement script
2025-07-02 09:43:41,829 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:43:41,830 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:43:41,830 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:43:41,834 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:43:41,835 - INFO - Query: *IDN?
2025-07-02 09:43:41,849 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:43:41,852 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:43:41,853 - INFO - Query: *IDN?
2025-07-02 09:43:41,854 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:43:41,854 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:43:41,855 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:43:41,855 - INFO - Write: *RST
2025-07-02 09:43:41,856 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:43:41,857 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:43:41,858 - INFO - Write: OUTP:STAT ON
2025-07-02 09:43:41,858 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:43:41,858 - INFO - Query: *RST;*OPC?
2025-07-02 09:43:42,048 - INFO - Response: 1
2025-07-02 09:43:42,048 - INFO - FSW reset for spur search
2025-07-02 09:43:42,049 - INFO - Write: :INIT:SPUR
2025-07-02 09:43:42,049 - INFO - Selected Spurious application
2025-07-02 09:43:42,050 - INFO - Write: INIT:CONT OFF
2025-07-02 09:43:42,050 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:43:42,051 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:43:42,051 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:43:42,051 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:43:42,052 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:43:42,052 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:43:42,053 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:43:42,053 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:43:42,054 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:43:42,054 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:43:42,054 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:43:42,055 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:43:42,055 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:43:42,056 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:43:42,056 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:43:42,056 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:43:42,057 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:43:42,057 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:43:42,057 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:43:42,058 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:43:42,058 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:43:42,058 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:43:42,059 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:43:42,059 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:43:42,059 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:43:42,060 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:43:42,060 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:43:42,060 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:43:42,061 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:43:42,061 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:43:42,061 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:43:42,061 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:43:42,062 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:43:42,062 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:43:42,062 - INFO - Query: :SENSe:LIST:RANGe3:DELete;*OPC?
2025-07-02 09:43:42,355 - INFO - Response: 1
2025-07-02 09:43:47,672 - INFO - Spur detection table configured
2025-07-02 09:43:47,673 - INFO - Write: :INIT:CONT OFF
2025-07-02 09:43:47,674 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:43:49,027 - INFO - Response: 1
2025-07-02 09:43:49,028 - INFO - Spur search measurement completed
2025-07-02 09:43:49,028 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 09:43:49,031 - INFO - Response: +1.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.448694153E+009,-2.305218506E+001,+0.000000000,-1.005218505E+001,+0.000000000,+0.000000000,+0.000000000,+2.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.444412294E+009,-3.526939774E+001,+0.000000000,-2.226939774E+001,+0.000000000,+0.000000000,+0.000000000,+3.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.439518741E+009,-5.308105087E+001,+0.000000000,-4.008105087E+001,+0.000000000,+0.000000000,+0.000000000,+4.000000000,+1.225000000E+009,+2.449000000E+009,+1.000000000E+006,+2.440742129E+009,-5.766540146E+001,+0.000000000,-4.466540146E+001,+0.000000000,+0.000000000,+0.000000000,+5.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.451611944E+009,-2.672494698E+001,+0.000000000,-1.372494698E+001,+0.000000000,+0.000000000,+0.000000000,+6.000000000,+2.451000000E+009,+4.900000000E+009,+1.000000000E+006,+2.460179160E+009,-4.566233826E+001,+0.000000000,-3.266233826E+001,+0.000000000,+0.000000000
2025-07-02 09:43:49,032 - INFO - Spur: 0.000000 GHz, 1225000000.00 dBm
2025-07-02 09:43:49,032 - INFO - Spur: 0.000000 GHz, -10.05 dBm
2025-07-02 09:43:49,032 - INFO - Spur: 1.225000 GHz, 2449000000.00 dBm
2025-07-02 09:43:49,033 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:43:49,033 - INFO - Spur: 2.449000 GHz, 1000000.00 dBm
2025-07-02 09:43:49,033 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:43:49,033 - INFO - Spur: 0.001000 GHz, 2440742129.00 dBm
2025-07-02 09:43:49,034 - INFO - Spur: 0.000000 GHz, 0.00 dBm
2025-07-02 09:43:49,034 - INFO - Spur: 2.451612 GHz, -26.72 dBm
2025-07-02 09:43:49,034 - INFO - Spur: 0.000000 GHz, 6.00 dBm
2025-07-02 09:43:49,035 - INFO - Spur: -0.000000 GHz, 0.00 dBm
2025-07-02 09:43:49,036 - INFO - Socket closed
2025-07-02 09:43:49,036 - INFO - FSW connection closed
2025-07-02 09:43:49,036 - INFO - Write: OUTP:STAT OFF
2025-07-02 09:43:49,037 - INFO - Socket closed
2025-07-02 09:43:49,037 - INFO - VSG connection closed
2025-07-02 09:43:49,041 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 09:43:49,574 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 09:43:49,628 - INFO - Socket closed
2025-07-02 09:43:49,630 - INFO - Socket closed
2025-07-02 09:46:41,672 - INFO - Starting RF measurement script
2025-07-02 09:46:41,675 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:46:41,676 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:46:41,676 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:46:41,680 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:46:41,680 - INFO - Query: *IDN?
2025-07-02 09:46:41,693 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:46:41,697 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:46:41,697 - INFO - Query: *IDN?
2025-07-02 09:46:41,698 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:46:41,698 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:46:41,698 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:46:41,698 - INFO - Write: *RST
2025-07-02 09:46:41,699 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:46:41,700 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:46:41,700 - INFO - Write: OUTP:STAT ON
2025-07-02 09:46:41,700 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:46:41,700 - INFO - Query: *RST;*OPC?
2025-07-02 09:46:41,885 - INFO - Response: 1
2025-07-02 09:46:41,885 - INFO - FSW reset for spur search
2025-07-02 09:46:41,886 - INFO - Write: :INIT:SPUR
2025-07-02 09:46:41,886 - INFO - Selected Spurious application
2025-07-02 09:46:41,886 - INFO - Write: INIT:CONT OFF
2025-07-02 09:46:41,886 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:46:41,887 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:46:41,887 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:46:41,887 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:46:41,887 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:46:41,887 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:46:41,887 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:46:41,887 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:46:41,888 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:46:41,888 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:46:41,888 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:46:41,888 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:46:41,888 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:46:41,888 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:46:41,888 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:46:41,889 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:46:41,889 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:46:41,889 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:46:41,889 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:46:41,889 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:46:41,889 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:46:41,889 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:46:41,890 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:46:41,890 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:46:41,890 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:46:41,890 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:46:41,890 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:46:41,890 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:46:41,890 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:46:41,891 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:46:41,891 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:46:41,891 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:46:41,891 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:46:41,891 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:46:41,891 - INFO - Query: :SENSe:LIST:RANGe3:DELete;*OPC?
2025-07-02 09:46:42,197 - INFO - Response: 1
2025-07-02 09:46:42,197 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:46:42,323 - INFO - Response: 1
2025-07-02 09:46:42,323 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:46:43,456 - INFO - Response: 1
2025-07-02 09:47:21,353 - INFO - Starting RF measurement script
2025-07-02 09:47:21,378 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:47:21,379 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:47:21,381 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:47:21,386 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:47:21,386 - INFO - Query: *IDN?
2025-07-02 09:47:21,411 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:47:21,414 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:47:21,414 - INFO - Query: *IDN?
2025-07-02 09:47:21,415 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:47:21,415 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:47:21,416 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:47:21,416 - INFO - Write: *RST
2025-07-02 09:47:21,416 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:47:21,416 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:47:21,417 - INFO - Write: OUTP:STAT ON
2025-07-02 09:47:21,417 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:47:21,417 - INFO - Query: *RST;*OPC?
2025-07-02 09:47:21,511 - INFO - Response: 1
2025-07-02 09:47:21,511 - INFO - FSW reset for spur search
2025-07-02 09:47:21,511 - INFO - Write: :INIT:SPUR
2025-07-02 09:47:21,512 - INFO - Selected Spurious application
2025-07-02 09:47:21,512 - INFO - Write: INIT:CONT OFF
2025-07-02 09:47:21,512 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:47:21,512 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:47:21,512 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:47:21,513 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:47:21,513 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:47:21,513 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:47:21,513 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:47:21,514 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:47:21,514 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:47:21,514 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:47:21,514 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:47:21,514 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:47:21,514 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:47:21,515 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:47:21,515 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:47:21,515 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:47:21,515 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:47:21,515 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:47:21,516 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:47:21,516 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:47:21,516 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:47:21,516 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:47:21,517 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:47:21,517 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:47:21,517 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:47:21,517 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:47:21,517 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:47:21,518 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:47:21,518 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:47:21,518 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:47:21,518 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:47:21,518 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:47:21,519 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:47:21,519 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:47:21,519 - INFO - Query: :SENSe1:LIST:RANGe3:DELete;*OPC?
2025-07-02 09:47:21,836 - INFO - Response: 1
2025-07-02 09:47:21,836 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:47:21,967 - INFO - Response: 1
2025-07-02 09:47:21,968 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:47:23,128 - INFO - Response: 1
2025-07-02 09:48:08,060 - INFO - Starting RF measurement script
2025-07-02 09:48:08,062 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:48:08,063 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:48:08,063 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:48:08,066 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:48:08,066 - INFO - Query: *IDN?
2025-07-02 09:48:08,068 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:48:08,070 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:48:08,070 - INFO - Query: *IDN?
2025-07-02 09:48:08,070 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:48:08,070 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:48:08,070 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:48:08,071 - INFO - Write: *RST
2025-07-02 09:48:08,071 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:48:08,071 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:48:08,071 - INFO - Write: OUTP:STAT ON
2025-07-02 09:48:08,071 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:48:08,071 - INFO - Query: *RST;*OPC?
2025-07-02 09:48:08,172 - INFO - Response: 1
2025-07-02 09:48:08,172 - INFO - FSW reset for spur search
2025-07-02 09:48:08,172 - INFO - Write: :INIT:SPUR
2025-07-02 09:48:08,173 - INFO - Selected Spurious application
2025-07-02 09:48:08,173 - INFO - Write: INIT:CONT OFF
2025-07-02 09:48:08,173 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:48:08,173 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:48:08,173 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:48:08,174 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:48:08,174 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:48:08,174 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:48:08,174 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:48:08,175 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:48:08,175 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:48:08,176 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:48:08,176 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:48:08,176 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:48:08,176 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:48:08,176 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:48:08,176 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:48:08,176 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:48:08,177 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:48:08,177 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:48:08,177 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:48:08,177 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:48:08,177 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:48:08,177 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:48:08,177 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:48:08,177 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:48:08,178 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:48:08,178 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:48:08,178 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:48:08,178 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:48:08,178 - INFO - Query: :SENSe1:LIST:RANGe1:DELete;*OPC?
2025-07-02 09:48:08,501 - INFO - Response: 1
2025-07-02 09:48:08,501 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:48:08,640 - INFO - Response: 1
2025-07-02 09:48:08,640 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:48:09,140 - INFO - Response: 1
2025-07-02 09:48:21,434 - INFO - Starting RF measurement script
2025-07-02 09:48:21,438 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:48:21,439 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:48:21,439 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:48:21,444 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:48:21,444 - INFO - Query: *IDN?
2025-07-02 09:48:21,446 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:48:21,450 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:48:21,450 - INFO - Query: *IDN?
2025-07-02 09:48:21,451 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:48:21,451 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:48:21,451 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:48:21,452 - INFO - Write: *RST
2025-07-02 09:48:21,452 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:48:21,452 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:48:21,453 - INFO - Write: OUTP:STAT ON
2025-07-02 09:48:21,453 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:48:21,453 - INFO - Query: *RST;*OPC?
2025-07-02 09:48:21,553 - INFO - Response: 1
2025-07-02 09:48:21,553 - INFO - FSW reset for spur search
2025-07-02 09:48:21,554 - INFO - Write: :INIT:SPUR
2025-07-02 09:48:21,554 - INFO - Selected Spurious application
2025-07-02 09:48:21,555 - INFO - Write: INIT:CONT OFF
2025-07-02 09:48:21,555 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:48:21,555 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:48:21,555 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:48:21,556 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:48:21,557 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:48:21,557 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:48:21,557 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:48:21,558 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:48:21,558 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:48:21,558 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:48:21,558 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:48:21,559 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:48:21,559 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:48:21,559 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:48:21,559 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:48:21,559 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:48:21,559 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:48:21,560 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:48:21,560 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:48:21,560 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:48:21,560 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:48:21,560 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:48:21,560 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:48:21,560 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:48:21,560 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:48:21,561 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:48:21,561 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:48:21,561 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:48:21,561 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:48:21,561 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:48:21,561 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:48:21,561 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:48:21,562 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:48:21,562 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:48:21,562 - INFO - Query: :SENSe1:LIST:RANGe2:DELete;*OPC?
2025-07-02 09:48:21,916 - INFO - Response: 1
2025-07-02 09:48:21,916 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:48:22,049 - INFO - Response: 1
2025-07-02 09:48:22,049 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:48:23,220 - INFO - Response: 1
2025-07-02 09:48:38,870 - INFO - Starting RF measurement script
2025-07-02 09:48:38,872 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:48:38,873 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:48:38,873 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:48:38,876 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:48:38,876 - INFO - Query: *IDN?
2025-07-02 09:48:38,877 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:48:38,879 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:48:38,879 - INFO - Query: *IDN?
2025-07-02 09:48:38,880 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:48:38,880 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:48:38,880 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:48:38,880 - INFO - Write: *RST
2025-07-02 09:48:38,880 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:48:38,881 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:48:38,881 - INFO - Write: OUTP:STAT ON
2025-07-02 09:48:38,881 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:48:38,881 - INFO - Query: *RST;*OPC?
2025-07-02 09:48:38,985 - INFO - Response: 1
2025-07-02 09:48:38,986 - INFO - FSW reset for spur search
2025-07-02 09:48:38,986 - INFO - Write: :INIT:SPUR
2025-07-02 09:48:38,986 - INFO - Selected Spurious application
2025-07-02 09:48:38,986 - INFO - Write: INIT:CONT OFF
2025-07-02 09:48:38,986 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:48:38,986 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:48:38,987 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:48:38,987 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:48:38,987 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:48:38,987 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:48:38,987 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:48:38,987 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:48:38,987 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:48:38,988 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:48:38,988 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 1225000000
2025-07-02 09:48:38,989 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2449000000
2025-07-02 09:48:38,989 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:48:38,989 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2451000000
2025-07-02 09:48:38,990 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 4900000000
2025-07-02 09:48:38,990 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:48:38,990 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:48:38,991 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 0
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:48:38,991 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:48:38,992 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:48:38,992 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:48:38,992 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:48:38,992 - INFO - Query: :SENSe1:LIST:RANGe3:DELete;*OPC?
2025-07-02 09:48:39,303 - INFO - Response: 1
2025-07-02 09:48:39,303 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:48:39,428 - INFO - Response: 1
2025-07-02 09:48:39,428 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:48:40,578 - INFO - Response: 1
2025-07-02 09:57:47,380 - INFO - Starting RF measurement script
2025-07-02 09:57:47,384 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:57:47,384 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:57:47,385 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:57:47,388 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:57:47,388 - INFO - Query: *IDN?
2025-07-02 09:57:47,479 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:57:47,482 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:57:47,482 - INFO - Query: *IDN?
2025-07-02 09:57:47,483 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:57:47,483 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:57:47,483 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:57:47,483 - INFO - Write: *RST
2025-07-02 09:57:47,484 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:57:47,484 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:57:47,484 - INFO - Write: OUTP:STAT ON
2025-07-02 09:57:47,484 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:57:47,484 - INFO - Query: *RST;*OPC?
2025-07-02 09:57:47,573 - INFO - Response: 1
2025-07-02 09:57:47,574 - INFO - FSW reset for spur search
2025-07-02 09:57:47,574 - INFO - Write: :INIT:SPUR
2025-07-02 09:57:47,574 - INFO - Selected Spurious application
2025-07-02 09:57:47,575 - INFO - Write: INIT:CONT OFF
2025-07-02 09:57:47,575 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:57:47,575 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:57:47,575 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:57:47,575 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:57:47,575 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:57:47,575 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:57:47,576 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:57:47,576 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:57:47,577 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:57:47,577 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:57:47,577 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2449000000
2025-07-02 09:57:47,577 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2451000000
2025-07-02 09:57:47,577 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:57:47,577 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:57:47,577 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:57:47,577 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:57:47,578 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:57:47,578 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:57:47,578 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 60
2025-07-02 09:57:47,578 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:57:47,578 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:57:47,578 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:57:47,578 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:57:47,579 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:57:47,579 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:57:47,579 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:57:47,579 - INFO - Write: SENS:LIST:RANG3:FREQ:STAR 1225000000
2025-07-02 09:57:47,580 - INFO - Write: SENS:LIST:RANG3:FREQ:STOP 2449000000
2025-07-02 09:57:47,580 - INFO - Write: :SENS:LIST:RANG3:FILT:TYPE NORM
2025-07-02 09:57:47,580 - INFO - Write: SENS:LIST:RANG3:FREQ:STAR 2451000000
2025-07-02 09:57:47,580 - INFO - Write: SENS:LIST:RANG3:FREQ:STOP 4900000000
2025-07-02 09:57:47,580 - INFO - Write: SENS:LIST:RANG3:BAND:RES 1000000
2025-07-02 09:57:47,580 - INFO - Write: :SENS:LIST:RANG3:SWE:TIME:AUTO ON
2025-07-02 09:57:47,580 - INFO - Write: SENS:LIST:RANG3:DET RMS
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:RLEV -40
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:INP:ATT:AUTO OFF
2025-07-02 09:57:47,581 - INFO - Write: :SENS:LIST:RANG3:INP:ATT 0
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:POIN:VAL 2001
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:BRE OFF
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:POW:NCOR ON
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:THR:STAR -95.00
2025-07-02 09:57:47,581 - INFO - Write: SENS:LIST:RANG3:THR:STOP -95.00
2025-07-02 09:57:47,582 - INFO - Write: SENS:LIST:RANG3:BAND:AUTO OFF
2025-07-02 09:57:47,582 - INFO - Range 3: 2.4514.900 GHz
2025-07-02 09:57:47,582 - INFO - Query: :SENSe1:LIST:RANGe3:DELete;*OPC?
2025-07-02 09:57:47,896 - INFO - Response: 1
2025-07-02 09:57:47,896 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:57:48,020 - INFO - Response: 1
2025-07-02 09:57:48,020 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:57:49,124 - INFO - Response: 1
2025-07-02 09:58:03,782 - INFO - Starting RF measurement script
2025-07-02 09:58:03,786 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 09:58:03,787 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 09:58:03,787 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 09:58:03,790 - INFO - Connected to 192.168.200.20:5025
2025-07-02 09:58:03,790 - INFO - Query: *IDN?
2025-07-02 09:58:03,792 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 09:58:03,795 - INFO - Connected to 192.168.200.10:5025
2025-07-02 09:58:03,795 - INFO - Query: *IDN?
2025-07-02 09:58:03,796 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 09:58:03,796 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 09:58:03,796 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 09:58:03,796 - INFO - Write: *RST
2025-07-02 09:58:03,796 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 09:58:03,796 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 09:58:03,796 - INFO - Write: OUTP:STAT ON
2025-07-02 09:58:03,797 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 09:58:03,797 - INFO - Query: *RST;*OPC?
2025-07-02 09:58:03,897 - INFO - Response: 1
2025-07-02 09:58:03,897 - INFO - FSW reset for spur search
2025-07-02 09:58:03,897 - INFO - Write: :INIT:SPUR
2025-07-02 09:58:03,898 - INFO - Selected Spurious application
2025-07-02 09:58:03,898 - INFO - Write: INIT:CONT OFF
2025-07-02 09:58:03,898 - INFO - Write: SENS:LIST:RANG1:FREQ:STAR 1225000000
2025-07-02 09:58:03,898 - INFO - Write: SENS:LIST:RANG1:FREQ:STOP 2449000000
2025-07-02 09:58:03,899 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 09:58:03,899 - INFO - Write: :SENS:LIST:RANG1:BAND:RES 1000000.0;*OPC
2025-07-02 09:58:03,899 - INFO - Write: :SENS:LIST:RANG1:SWE:TIME:AUTO ON
2025-07-02 09:58:03,899 - INFO - Write: SENS:LIST:RANG1:DET RMS
2025-07-02 09:58:03,900 - INFO - Write: SENS:LIST:RANG1:RLEV -40
2025-07-02 09:58:03,900 - INFO - Write: SENS:LIST:RANG1:INP:ATT:AUTO OFF
2025-07-02 09:58:03,900 - INFO - Write: :SENS:LIST:RANG1:INP:ATT 0
2025-07-02 09:58:03,900 - INFO - Write: SENS:LIST:RANG1:POIN:VAL 2001
2025-07-02 09:58:03,900 - INFO - Write: SENS:LIST:RANG1:BRE OFF
2025-07-02 09:58:03,901 - INFO - Write: SENS:LIST:RANG1:POW:NCOR ON
2025-07-02 09:58:03,901 - INFO - Write: SENS:LIST:RANG1:THR:STAR -95.00
2025-07-02 09:58:03,901 - INFO - Write: SENS:LIST:RANG1:THR:STOP -95.00
2025-07-02 09:58:03,901 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 09:58:03,902 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 09:58:03,902 - INFO - Write: SENS:LIST:RANG2:FREQ:STAR 2449000000
2025-07-02 09:58:03,902 - INFO - Write: SENS:LIST:RANG2:FREQ:STOP 2451000000
2025-07-02 09:58:03,902 - INFO - Write: :SENS:LIST:RANG2:FILT:TYPE NORM
2025-07-02 09:58:03,903 - INFO - Write: SENS:LIST:RANG2:BAND:RES 1000000
2025-07-02 09:58:03,903 - INFO - Write: :SENS:LIST:RANG2:SWE:TIME:AUTO ON
2025-07-02 09:58:03,903 - INFO - Write: SENS:LIST:RANG2:DET RMS
2025-07-02 09:58:03,904 - INFO - Write: SENS:LIST:RANG2:RLEV -40
2025-07-02 09:58:03,904 - INFO - Write: SENS:LIST:RANG2:INP:ATT:AUTO OFF
2025-07-02 09:58:03,904 - INFO - Write: :SENS:LIST:RANG2:INP:ATT 60
2025-07-02 09:58:03,904 - INFO - Write: SENS:LIST:RANG2:POIN:VAL 2001
2025-07-02 09:58:03,905 - INFO - Write: SENS:LIST:RANG2:BRE OFF
2025-07-02 09:58:03,905 - INFO - Write: SENS:LIST:RANG2:POW:NCOR ON
2025-07-02 09:58:03,905 - INFO - Write: SENS:LIST:RANG2:THR:STAR -95.00
2025-07-02 09:58:03,906 - INFO - Write: SENS:LIST:RANG2:THR:STOP -95.00
2025-07-02 09:58:03,906 - INFO - Write: SENS:LIST:RANG2:BAND:AUTO OFF
2025-07-02 09:58:03,906 - INFO - Range 2: 2.4514.900 GHz
2025-07-02 09:58:03,906 - INFO - Write: SENS:LIST:RANG3:FREQ:STAR 1225000000
2025-07-02 09:58:03,906 - INFO - Write: SENS:LIST:RANG3:FREQ:STOP 2449000000
2025-07-02 09:58:03,907 - INFO - Write: :SENS:LIST:RANG3:FILT:TYPE NORM
2025-07-02 09:58:03,907 - INFO - Write: SENS:LIST:RANG3:FREQ:STAR 2451000000
2025-07-02 09:58:03,907 - INFO - Write: SENS:LIST:RANG3:FREQ:STOP 4900000000
2025-07-02 09:58:03,907 - INFO - Write: SENS:LIST:RANG3:BAND:RES 1000000
2025-07-02 09:58:03,907 - INFO - Write: :SENS:LIST:RANG3:SWE:TIME:AUTO ON
2025-07-02 09:58:03,907 - INFO - Write: SENS:LIST:RANG3:DET RMS
2025-07-02 09:58:03,907 - INFO - Write: SENS:LIST:RANG3:RLEV -40
2025-07-02 09:58:03,908 - INFO - Write: SENS:LIST:RANG3:INP:ATT:AUTO OFF
2025-07-02 09:58:03,908 - INFO - Write: :SENS:LIST:RANG3:INP:ATT 0
2025-07-02 09:58:03,908 - INFO - Write: SENS:LIST:RANG3:POIN:VAL 2001
2025-07-02 09:58:03,908 - INFO - Write: SENS:LIST:RANG3:BRE OFF
2025-07-02 09:58:03,908 - INFO - Write: SENS:LIST:RANG3:POW:NCOR ON
2025-07-02 09:58:03,908 - INFO - Write: SENS:LIST:RANG3:THR:STAR -95.00
2025-07-02 09:58:03,909 - INFO - Write: SENS:LIST:RANG3:THR:STOP -95.00
2025-07-02 09:58:03,909 - INFO - Write: SENS:LIST:RANG3:BAND:AUTO OFF
2025-07-02 09:58:03,909 - INFO - Range 3: 2.4514.900 GHz
2025-07-02 09:58:03,909 - INFO - Query: :SENS:LIST:XADJ;*OPC?
2025-07-02 09:58:04,346 - INFO - Response: 1
2025-07-02 09:58:04,347 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 09:58:05,530 - INFO - Response: 1
2025-07-02 10:21:50,813 - INFO - Starting RF measurement script
2025-07-02 10:21:50,817 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 10:21:50,818 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 10:21:50,818 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 10:21:50,823 - INFO - Connected to 192.168.200.20:5025
2025-07-02 10:21:50,823 - INFO - Query: *IDN?
2025-07-02 10:21:50,836 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 10:21:50,839 - INFO - Connected to 192.168.200.10:5025
2025-07-02 10:21:50,840 - INFO - Query: *IDN?
2025-07-02 10:21:50,841 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 10:21:50,842 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 10:21:50,842 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 10:21:50,842 - INFO - Write: *RST
2025-07-02 10:21:50,843 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 10:21:50,843 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 10:21:50,843 - INFO - Write: OUTP:STAT ON
2025-07-02 10:21:50,843 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 10:21:50,844 - INFO - Query: *RST;*OPC?
2025-07-02 10:21:50,933 - INFO - Response: 1
2025-07-02 10:21:50,933 - INFO - FSW reset for spur search
2025-07-02 10:21:50,933 - INFO - Write: INIT:CONT OFF
2025-07-02 10:21:50,933 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 10:21:50,934 - INFO - Write: SENS:FREQ:STOP 2449000000
2025-07-02 10:21:50,934 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 10:21:50,934 - INFO - Write: :SENS:AVER:COUN 100
2025-07-02 10:21:50,934 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 10:21:50,935 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 10:21:50,935 - INFO - Write: :SENS:BAND:RES 1000000.0
2025-07-02 10:21:50,935 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 10:21:50,935 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 10:21:50,935 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 10:21:50,935 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 10:21:50,936 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 10:21:50,936 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 10:21:50,936 - INFO - Write: :INP:ATT 0
2025-07-02 10:21:50,936 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 10:21:50,936 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 10:21:50,937 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 10:21:50,937 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 10:21:50,937 - INFO - Write: CALC1:DLIN1 -95
2025-07-02 10:21:50,937 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 10:25:33,350 - INFO - Starting RF measurement script
2025-07-02 10:25:33,352 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 10:25:33,353 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 10:25:33,353 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 10:25:33,356 - INFO - Connected to 192.168.200.20:5025
2025-07-02 10:25:33,356 - INFO - Query: *IDN?
2025-07-02 10:25:33,362 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 10:25:33,365 - INFO - Connected to 192.168.200.10:5025
2025-07-02 10:25:33,365 - INFO - Query: *IDN?
2025-07-02 10:25:33,365 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 10:25:33,365 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 10:25:33,366 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=0.00 dBm
2025-07-02 10:25:33,366 - INFO - Write: *RST
2025-07-02 10:25:33,366 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 10:25:33,366 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 10:25:33,366 - INFO - Write: OUTP:STAT ON
2025-07-02 10:25:33,366 - INFO - VSG set: frequency=2.450 GHz, power=0.00 dBm
2025-07-02 10:25:33,366 - INFO - Query: *RST;*OPC?
2025-07-02 10:25:33,451 - INFO - Response: 1
2025-07-02 10:25:33,452 - INFO - FSW reset for spur search
2025-07-02 10:25:33,452 - INFO - Write: INIT:CONT OFF
2025-07-02 10:25:33,452 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 10:25:33,452 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 10:25:33,452 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 10:25:33,452 - INFO - Write: :SENS:AVER:COUN 100
2025-07-02 10:25:33,453 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 10:25:33,453 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 10:25:33,453 - INFO - Write: :SENS:BAND:RES 1000000.0
2025-07-02 10:25:33,453 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 10:25:33,453 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 10:25:33,453 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 10:25:33,453 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 10:25:33,453 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 10:25:33,454 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 10:25:33,454 - INFO - Write: :INP:ATT 0
2025-07-02 10:25:33,454 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 10:25:33,454 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 10:25:33,454 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 10:25:33,454 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 10:25:33,454 - INFO - Write: CALC1:DLIN1 -95
2025-07-02 10:25:33,455 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 10:25:33,455 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 10:25:47,026 - INFO - Response: 1
2025-07-02 11:09:53,953 - INFO - Starting RF measurement script
2025-07-02 11:09:53,958 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:09:53,958 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:09:53,959 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 11:09:53,963 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:09:53,964 - INFO - Query: *IDN?
2025-07-02 11:09:53,975 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:09:53,980 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:09:53,980 - INFO - Query: *IDN?
2025-07-02 11:09:53,981 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:09:53,982 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:09:53,982 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:09:53,982 - INFO - Query: *RST;*OPC?
2025-07-02 11:09:55,046 - INFO - Response: 1
2025-07-02 11:09:55,046 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:09:55,046 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:09:55,046 - INFO - Write: OUTP:STAT ON
2025-07-02 11:09:55,046 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:09:55,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CLOad
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:09:55,048 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:09:55,048 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:09:55,048 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:09:55,049 - INFO - Query: *RST;*OPC?
2025-07-02 11:09:55,144 - INFO - Response: 1
2025-07-02 11:09:55,144 - INFO - FSW reset for spur search
2025-07-02 11:09:55,144 - INFO - Write: INIT:CONT OFF
2025-07-02 11:09:55,145 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:09:55,145 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:09:55,145 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:09:55,146 - INFO - Write: :SENS:AVER:COUN 100
2025-07-02 11:09:55,146 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:09:55,147 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:09:55,147 - INFO - Write: :SENS:BAND:RES 1000000.0
2025-07-02 11:09:55,147 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:09:55,147 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:09:55,147 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:09:55,148 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:09:55,148 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:09:55,148 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:09:55,149 - INFO - Write: :INP:ATT 0
2025-07-02 11:09:55,149 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:09:55,149 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:09:55,149 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:09:55,149 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:09:55,150 - INFO - Write: CALC1:DLIN1 -95
2025-07-02 11:09:55,150 - INFO - Write: SENS:LIST:RANG1:BAND:AUTO OFF
2025-07-02 11:09:55,150 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:10:08,753 - INFO - Response: 1
2025-07-02 11:10:14,723 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 11:10:14,723 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:10:19,030 - INFO - Response: 1
2025-07-02 11:10:27,017 - INFO - Spur detection table configured
2025-07-02 11:10:27,018 - INFO - Write: :INIT:CONT OFF
2025-07-02 11:10:27,018 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:10:31,387 - INFO - Response: 1
2025-07-02 11:10:31,387 - INFO - Spur search measurement completed
2025-07-02 11:10:31,388 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 11:11:01,395 - ERROR - Query failed: TRAC3:DATA? LIST, Error: timed out
2025-07-02 11:11:01,395 - ERROR - Failed to retrieve spur results: timed out
2025-07-02 11:11:01,395 - INFO - Socket closed
2025-07-02 11:11:01,395 - INFO - FSW connection closed
2025-07-02 11:11:01,395 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:11:01,396 - INFO - Socket closed
2025-07-02 11:11:01,396 - INFO - VSG connection closed
2025-07-02 11:11:01,397 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:11:01,880 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:11:01,932 - INFO - Socket closed
2025-07-02 11:11:01,933 - INFO - Socket closed
2025-07-02 11:15:57,282 - INFO - Starting RF measurement script
2025-07-02 11:15:57,285 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:15:57,285 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 1,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:15:57,285 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 1, 'spur_limit_dbm': -95}
2025-07-02 11:15:57,289 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:15:57,289 - INFO - Query: *IDN?
2025-07-02 11:15:57,290 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:15:57,293 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:15:57,293 - INFO - Query: *IDN?
2025-07-02 11:15:57,294 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:15:57,295 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=1 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:15:57,295 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=1.000 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:15:57,295 - INFO - Query: *RST;*OPC?
2025-07-02 11:15:58,341 - INFO - Response: 1
2025-07-02 11:15:58,341 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:15:58,342 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:15:58,343 - INFO - Write: OUTP:STAT ON
2025-07-02 11:15:58,343 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:15:58,344 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:15:58,344 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:15:58,345 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:15:58,346 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:15:58,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:15:58,348 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:15:58,349 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:15:58,349 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:15:58,350 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:15:58,350 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:15:58,351 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:15:58,351 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:15:58,352 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:15:58,352 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CLOad
2025-07-02 11:15:58,352 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:15:58,352 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:15:58,353 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:15:58,353 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:15:58,353 - INFO - Query: *RST;*OPC?
2025-07-02 11:15:58,444 - INFO - Response: 1
2025-07-02 11:15:58,444 - INFO - FSW reset for spur search
2025-07-02 11:15:58,444 - INFO - Write: INIT:CONT OFF
2025-07-02 11:15:58,445 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:15:58,445 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:15:58,445 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:15:58,445 - INFO - Write: :SENS:AVER:COUN 100
2025-07-02 11:15:58,445 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:15:58,445 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:15:58,446 - INFO - Write: :SENS:BAND:RES 1000000.0
2025-07-02 11:15:58,446 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:15:58,446 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:15:58,446 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:15:58,446 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:15:58,447 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:15:58,447 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:15:58,448 - INFO - Write: :INP:ATT 0
2025-07-02 11:15:58,448 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:15:58,448 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:15:58,448 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:15:58,448 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:15:58,448 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:15:58,449 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:15:58,449 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:15:58,449 - INFO - Write: CALC1:THR -120
2025-07-02 11:15:58,449 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:15:58,449 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:15:58,449 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:15:58,450 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:15:58,450 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:16:12,106 - INFO - Response: 1
2025-07-02 11:17:39,035 - INFO - Starting RF measurement script
2025-07-02 11:17:39,038 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:17:39,039 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:17:39,039 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:17:39,042 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:17:39,042 - INFO - Query: *IDN?
2025-07-02 11:17:39,052 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:17:39,055 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:17:39,055 - INFO - Query: *IDN?
2025-07-02 11:17:39,056 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:17:39,056 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:17:39,056 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:17:39,056 - INFO - Query: *RST;*OPC?
2025-07-02 11:17:40,395 - INFO - Response: 1
2025-07-02 11:17:40,396 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:17:40,397 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:17:40,397 - INFO - Write: OUTP:STAT ON
2025-07-02 11:17:40,398 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:17:40,398 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:17:40,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:17:40,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:17:40,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:17:40,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:17:40,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:17:40,401 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:17:40,401 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:17:40,401 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:17:40,402 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:17:40,403 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:17:40,404 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:17:40,404 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:17:40,404 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CLOad
2025-07-02 11:17:40,405 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:17:40,405 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:17:40,406 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:17:40,406 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:17:40,407 - INFO - Query: *RST;*OPC?
2025-07-02 11:17:40,488 - INFO - Response: 1
2025-07-02 11:17:40,489 - INFO - FSW reset for spur search
2025-07-02 11:17:40,489 - INFO - Write: INIT:CONT OFF
2025-07-02 11:17:40,489 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:17:40,490 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:17:40,490 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:17:40,490 - INFO - Write: :SENS:AVER:COUN 100
2025-07-02 11:17:40,490 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:17:40,491 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:17:40,491 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 11:17:40,491 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:17:40,491 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:17:40,492 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:17:40,492 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:17:40,492 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:17:40,492 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:17:40,492 - INFO - Write: :INP:ATT 0
2025-07-02 11:17:40,493 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:17:40,493 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:17:40,493 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:17:40,493 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:17:40,494 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:17:40,494 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:17:40,495 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:17:40,495 - INFO - Write: CALC1:THR -120
2025-07-02 11:17:40,495 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:17:40,496 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:17:40,496 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:17:40,496 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:17:40,496 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:18:10,507 - ERROR - Query failed: INIT:IMM;*OPC?, Error: timed out
2025-07-02 11:18:10,507 - ERROR - Failed to configure FSW: timed out
2025-07-02 11:18:10,508 - ERROR - SpurSearch test set 1 failed: timed out
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 300, in run_spur_search_measurement
    _, timings["VSA_config"] = instr.VSA_config(fundamental_ghz=fundamental_ghz, rbw_mhz=rbw_mhz,
                               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                spur_limit_dbm=spur_limit_dbm)
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 91, in VSA_config
    self.VSA.query('INIT:IMM;*OPC?')  # Initiate sweep and wait for completion
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out
2025-07-02 11:18:10,524 - ERROR - SpurSearch test set 1 failed: cannot access local variable 'config' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 300, in run_spur_search_measurement
    _, timings["VSA_config"] = instr.VSA_config(fundamental_ghz=fundamental_ghz, rbw_mhz=rbw_mhz,
                               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                spur_limit_dbm=spur_limit_dbm)
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 91, in VSA_config
    self.VSA.query('INIT:IMM;*OPC?')  # Initiate sweep and wait for completion
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 500, in <module>
    run_spur_search_measurement(test, test_set, spur_instr)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 331, in run_spur_search_measurement
    "config": config,
              ^^^^^^
UnboundLocalError: cannot access local variable 'config' where it is not associated with a value
2025-07-02 11:18:10,529 - INFO - Socket closed
2025-07-02 11:18:10,529 - INFO - FSW connection closed
2025-07-02 11:18:10,529 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:18:10,530 - INFO - Socket closed
2025-07-02 11:18:10,530 - INFO - VSG connection closed
2025-07-02 11:18:10,532 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:18:10,532 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 11:18:11,148 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:18:11,217 - INFO - Socket closed
2025-07-02 11:18:11,218 - INFO - Socket closed
2025-07-02 11:18:22,455 - INFO - Starting RF measurement script
2025-07-02 11:18:22,458 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:18:22,458 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:18:22,459 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:18:22,463 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:18:22,463 - INFO - Query: *IDN?
2025-07-02 11:18:36,406 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:18:36,411 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:18:36,411 - INFO - Query: *IDN?
2025-07-02 11:18:36,412 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:18:36,413 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:18:36,413 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:18:36,413 - INFO - Query: *RST;*OPC?
2025-07-02 11:18:37,467 - INFO - Response: 1
2025-07-02 11:18:37,468 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:18:37,469 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:18:37,470 - INFO - Write: OUTP:STAT ON
2025-07-02 11:18:37,470 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:18:37,471 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:18:37,471 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:18:37,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:18:37,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:18:37,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:18:37,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:18:37,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:18:37,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:18:37,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:18:37,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:18:37,475 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:18:37,475 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:18:37,476 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:18:37,477 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CLOad
2025-07-02 11:18:37,477 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:18:37,478 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:18:37,478 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:18:37,478 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:18:37,479 - INFO - Query: *RST;*OPC?
2025-07-02 11:18:37,560 - INFO - Response: 1
2025-07-02 11:18:37,561 - INFO - FSW reset for spur search
2025-07-02 11:18:37,561 - INFO - Write: INIT:CONT OFF
2025-07-02 11:18:37,562 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:18:37,562 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:18:37,563 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:18:37,563 - INFO - Write: :SENS:AVER:COUN 20
2025-07-02 11:18:37,563 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:18:37,564 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:18:37,564 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 11:18:37,564 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:18:37,565 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:18:37,565 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:18:37,565 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:18:37,565 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:18:37,566 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:18:37,566 - INFO - Write: :INP:ATT 0
2025-07-02 11:18:37,566 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:18:37,566 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:18:37,567 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:18:37,567 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:18:37,567 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:18:37,567 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:18:37,568 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:18:37,568 - INFO - Write: CALC1:THR -120
2025-07-02 11:18:37,568 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:18:37,568 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:18:37,568 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:18:37,569 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:18:37,569 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:18:48,893 - INFO - Response: 1
2025-07-02 11:19:07,343 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 11:19:07,343 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:19:11,064 - INFO - Response: 1
2025-07-02 11:21:26,002 - INFO - Starting RF measurement script
2025-07-02 11:21:26,004 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:21:26,005 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:21:26,005 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:21:26,009 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:21:26,010 - INFO - Query: *IDN?
2025-07-02 11:21:26,011 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:21:26,013 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:21:26,013 - INFO - Query: *IDN?
2025-07-02 11:21:26,014 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:21:26,014 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:21:26,014 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:21:26,014 - INFO - Query: *RST;*OPC?
2025-07-02 11:21:27,058 - INFO - Response: 1
2025-07-02 11:21:27,058 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:21:27,059 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:21:27,060 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:21:27,060 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:21:27,061 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:21:27,061 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:21:27,062 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:21:27,062 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:21:27,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:21:27,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:21:27,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:21:27,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:21:27,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:21:27,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:21:27,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:21:27,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:21:27,066 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?
2025-07-02 11:21:57,072 - ERROR - Query failed: SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?, Error: timed out
2025-07-02 11:21:57,074 - ERROR - Failed to configure VSG: timed out
2025-07-02 11:21:57,074 - ERROR - SpurSearch test set 1 failed: timed out
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 299, in run_spur_search_measurement
    _, timings["VSG_config"] = instr.VSG_config(frequency_ghz=fundamental_ghz, pwr=pwr)
                               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 129, in VSG_config
    self.VSG.query('SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?')
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out
2025-07-02 11:21:57,086 - ERROR - SpurSearch test set 1 failed: cannot access local variable 'config' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 299, in run_spur_search_measurement
    _, timings["VSG_config"] = instr.VSG_config(frequency_ghz=fundamental_ghz, pwr=pwr)
                               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 129, in VSG_config
    self.VSG.query('SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?')
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 500, in <module>
    run_spur_search_measurement(test, test_set, spur_instr)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 331, in run_spur_search_measurement
    "config": config,
              ^^^^^^
UnboundLocalError: cannot access local variable 'config' where it is not associated with a value
2025-07-02 11:21:57,092 - INFO - Socket closed
2025-07-02 11:21:57,092 - INFO - FSW connection closed
2025-07-02 11:21:57,092 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:21:57,093 - INFO - Socket closed
2025-07-02 11:21:57,093 - INFO - VSG connection closed
2025-07-02 11:21:57,098 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:21:57,099 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 11:21:58,140 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:21:58,225 - INFO - Socket closed
2025-07-02 11:21:58,227 - INFO - Socket closed
2025-07-02 11:23:34,644 - INFO - Starting RF measurement script
2025-07-02 11:23:34,649 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:23:34,651 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:23:34,651 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:23:34,660 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:23:34,660 - INFO - Query: *IDN?
2025-07-02 11:23:34,662 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:23:34,666 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:23:34,666 - INFO - Query: *IDN?
2025-07-02 11:23:34,667 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:23:34,668 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:23:34,668 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:23:34,669 - INFO - Query: *RST;*OPC?
2025-07-02 11:23:35,712 - INFO - Response: 1
2025-07-02 11:23:35,712 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:23:35,713 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:24:06,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:24:06,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:24:06,522 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:24:06,522 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:24:06,522 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:24:06,522 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:24:06,523 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:24:06,523 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:24:06,523 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:24:22,305 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:24:22,306 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:24:22,307 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:24:22,309 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:24:22,309 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:24:31,226 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?
2025-07-02 11:25:01,233 - ERROR - Query failed: SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?, Error: timed out
2025-07-02 11:25:01,234 - ERROR - Failed to configure VSG: timed out
2025-07-02 11:25:01,234 - ERROR - SpurSearch test set 1 failed: timed out
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 299, in run_spur_search_measurement
    _, timings["VSG_config"] = instr.VSG_config(frequency_ghz=fundamental_ghz, pwr=pwr)
                               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 129, in VSG_config
    self.VSG.query('SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?')
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out
2025-07-02 11:25:01,248 - ERROR - SpurSearch test set 1 failed: cannot access local variable 'config' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 299, in run_spur_search_measurement
    _, timings["VSG_config"] = instr.VSG_config(frequency_ghz=fundamental_ghz, pwr=pwr)
                               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\utils\utils.py", line 20, in wrapper
    result = method(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 129, in VSG_config
    self.VSG.query('SOURce1:BB:ARBitrary:MCARrier:CLOad:*OPC?')
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\instruments\iSocket.py", line 70, in query
    response = self.sock.recv(1024).decode().strip()
               ~~~~~~~~~~~~~~^^^^^^
TimeoutError: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 500, in <module>
    run_spur_search_measurement(test, test_set, spur_instr)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 331, in run_spur_search_measurement
    "config": config,
              ^^^^^^
UnboundLocalError: cannot access local variable 'config' where it is not associated with a value
2025-07-02 11:25:01,255 - INFO - Socket closed
2025-07-02 11:25:01,255 - INFO - FSW connection closed
2025-07-02 11:25:01,256 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:25:01,257 - INFO - Socket closed
2025-07-02 11:25:01,257 - INFO - VSG connection closed
2025-07-02 11:25:01,260 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:25:01,260 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 11:25:02,230 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:25:02,331 - INFO - Socket closed
2025-07-02 11:25:02,333 - INFO - Socket closed
2025-07-02 11:25:36,504 - INFO - Starting RF measurement script
2025-07-02 11:25:36,508 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:25:36,509 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:25:36,509 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:25:36,515 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:25:36,516 - INFO - Query: *IDN?
2025-07-02 11:25:36,517 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:25:36,520 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:25:36,520 - INFO - Query: *IDN?
2025-07-02 11:25:36,521 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:25:36,521 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:25:36,521 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:25:36,522 - INFO - Query: *RST;*OPC?
2025-07-02 11:25:37,563 - INFO - Response: 1
2025-07-02 11:25:37,563 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:25:37,564 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:25:42,025 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:25:42,026 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:25:42,027 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:25:42,027 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:25:42,028 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:25:42,028 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:25:42,028 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:25:42,028 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:25:42,029 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:25:45,232 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:25:45,234 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:25:45,235 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:25:45,235 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:25:45,236 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:25:48,761 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 11:25:51,559 - INFO - Response: 1
2025-07-02 11:26:01,860 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:26:01,861 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:26:01,862 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:26:07,748 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:26:07,749 - INFO - Query: *RST;*OPC?
2025-07-02 11:26:07,856 - INFO - Response: 1
2025-07-02 11:26:07,857 - INFO - FSW reset for spur search
2025-07-02 11:26:07,858 - INFO - Write: INIT:CONT OFF
2025-07-02 11:26:07,858 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:26:07,859 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:26:07,859 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:26:07,859 - INFO - Write: :SENS:AVER:COUN 20
2025-07-02 11:26:07,860 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:26:07,860 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:26:07,860 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 11:26:07,860 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:26:07,860 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:26:07,861 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:26:07,861 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:26:07,862 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:26:07,863 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:26:07,864 - INFO - Write: :INP:ATT 0
2025-07-02 11:26:07,865 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:26:07,866 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:26:07,866 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:26:07,867 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:26:07,867 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:26:07,867 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:26:07,867 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:26:07,868 - INFO - Write: CALC1:THR -120
2025-07-02 11:26:07,868 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:26:07,868 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:26:07,868 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:26:07,869 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:26:07,869 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:26:19,182 - INFO - Response: 1
2025-07-02 11:26:19,183 - INFO - Spur detection table configured
2025-07-02 11:26:19,184 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 11:26:19,184 - INFO - Write: :INIT:CONT OFF
2025-07-02 11:26:19,185 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:26:22,954 - INFO - Response: 1
2025-07-02 11:26:22,954 - INFO - Spur search measurement completed
2025-07-02 11:26:22,955 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 11:26:52,957 - ERROR - Query failed: TRAC3:DATA? LIST, Error: timed out
2025-07-02 11:26:52,957 - ERROR - Failed to retrieve spur results: timed out
2025-07-02 11:26:52,958 - INFO - Socket closed
2025-07-02 11:26:52,959 - INFO - FSW connection closed
2025-07-02 11:26:52,960 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:26:52,960 - INFO - Socket closed
2025-07-02 11:26:52,961 - INFO - VSG connection closed
2025-07-02 11:26:52,964 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:26:53,582 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:26:53,636 - INFO - Socket closed
2025-07-02 11:26:53,637 - INFO - Socket closed
2025-07-02 11:30:55,840 - INFO - Starting RF measurement script
2025-07-02 11:30:55,844 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:30:55,844 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:30:55,845 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:30:55,848 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:30:55,848 - INFO - Query: *IDN?
2025-07-02 11:30:55,852 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:30:55,854 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:30:55,854 - INFO - Query: *IDN?
2025-07-02 11:30:55,855 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:30:55,855 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:30:55,855 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:30:55,855 - INFO - Query: *RST;*OPC?
2025-07-02 11:30:56,895 - INFO - Response: 1
2025-07-02 11:30:56,896 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:30:56,897 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:31:30,457 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:31:30,458 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:31:30,459 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:31:30,459 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:31:30,459 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:31:30,460 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:31:30,460 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:31:30,460 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:31:30,460 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:31:30,461 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:31:30,461 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:31:30,461 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:31:30,461 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:31:30,462 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:31:30,462 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 11:31:33,265 - INFO - Response: 1
2025-07-02 11:31:33,266 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:31:33,267 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:31:33,267 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:33:58,128 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:33:58,129 - INFO - Query: *RST;*OPC?
2025-07-02 11:33:58,217 - INFO - Response: 1
2025-07-02 11:33:58,218 - INFO - FSW reset for spur search
2025-07-02 11:33:58,218 - INFO - Write: INIT:CONT OFF
2025-07-02 11:33:58,218 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:33:58,218 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:33:58,218 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:33:58,219 - INFO - Write: :SENS:AVER:COUN 20
2025-07-02 11:33:58,219 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:33:58,219 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:33:58,219 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 11:33:58,220 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:33:58,220 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:33:58,220 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:33:58,221 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:33:58,222 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:33:58,222 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:33:58,223 - INFO - Write: :INP:ATT 0
2025-07-02 11:33:58,223 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:33:58,223 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:33:58,223 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:33:58,223 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:33:58,223 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:33:58,224 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:33:58,224 - INFO - Write: CALC1:THR -120
2025-07-02 11:33:58,224 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:33:58,224 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:33:58,224 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:34:09,548 - INFO - Response: 1
2025-07-02 11:34:09,549 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:34:09,549 - INFO - Spur detection table configured
2025-07-02 11:34:20,789 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 11:34:20,790 - INFO - Write: :INIT:CONT OFF
2025-07-02 11:34:20,791 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:34:24,553 - INFO - Response: 1
2025-07-02 11:34:24,553 - INFO - Spur search measurement completed
2025-07-02 11:34:24,554 - INFO - Query: TRAC3:DATA? LIST
2025-07-02 11:34:54,562 - ERROR - Query failed: TRAC3:DATA? LIST, Error: timed out
2025-07-02 11:34:54,562 - ERROR - Failed to retrieve spur results: timed out
2025-07-02 11:34:54,563 - INFO - Socket closed
2025-07-02 11:34:54,564 - INFO - FSW connection closed
2025-07-02 11:34:54,565 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:34:54,565 - INFO - Socket closed
2025-07-02 11:34:54,566 - INFO - VSG connection closed
2025-07-02 11:34:54,569 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:34:55,199 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:34:55,270 - INFO - Socket closed
2025-07-02 11:34:55,272 - INFO - Socket closed
2025-07-02 11:46:17,377 - INFO - Starting RF measurement script
2025-07-02 11:46:17,380 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:46:17,380 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:46:17,380 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:46:17,385 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:46:17,386 - INFO - Query: *IDN?
2025-07-02 11:46:17,387 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:46:17,389 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:46:17,389 - INFO - Query: *IDN?
2025-07-02 11:46:17,390 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:46:17,390 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:46:17,390 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:46:17,390 - INFO - Query: *RST;*OPC?
2025-07-02 11:46:18,432 - INFO - Response: 1
2025-07-02 11:46:18,432 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:46:18,433 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:46:18,433 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:46:18,433 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:46:18,434 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:46:18,434 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:46:18,434 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:46:18,434 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:46:18,435 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:46:18,435 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:46:18,435 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:46:18,435 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:46:18,435 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:46:18,436 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:46:18,436 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:46:18,436 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:46:18,436 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 11:46:21,529 - INFO - Response: 1
2025-07-02 11:46:21,530 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:46:21,530 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:46:21,530 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:46:21,531 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:46:21,532 - INFO - Query: *RST;*OPC?
2025-07-02 11:46:21,622 - INFO - Response: 1
2025-07-02 11:46:21,622 - INFO - FSW reset for spur search
2025-07-02 11:46:21,622 - INFO - Write: INIT:CONT OFF
2025-07-02 11:46:21,623 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:46:21,623 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:46:21,624 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:46:21,624 - INFO - Write: :SENS:AVER:COUN 20
2025-07-02 11:46:21,624 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:46:21,624 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:46:21,624 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 11:46:21,625 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:46:21,625 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:46:21,625 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:46:21,625 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:46:21,626 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:46:21,626 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:46:21,626 - INFO - Write: :INP:ATT 0
2025-07-02 11:46:21,626 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:46:21,626 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:46:21,627 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:46:21,627 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:46:21,627 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:46:21,627 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:46:21,627 - INFO - Write: CALC1:THR -120
2025-07-02 11:46:21,627 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:46:21,627 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:46:21,628 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:46:32,931 - INFO - Response: 1
2025-07-02 11:46:32,931 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:46:32,931 - INFO - Spur detection table configured
2025-07-02 11:46:32,932 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 11:46:32,932 - INFO - Write: :INIT:CONT OFF
2025-07-02 11:46:32,932 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:46:36,696 - INFO - Response: 1
2025-07-02 11:46:36,696 - INFO - Spur search measurement completed
2025-07-02 11:46:36,696 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 11:46:36,698 - INFO - Response: 4
2025-07-02 11:46:36,698 - INFO - Write: :CALC:MARK1:FUNC:FPE:SEL 1
2025-07-02 11:46:36,698 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 11:46:36,753 - INFO - Response: 1450800000,1950100000,3051500000,3451700000
2025-07-02 11:46:36,753 - WARNING - Error retrieving data for spur 1: could not convert string to float: '1450800000,1950100000,3051500000,3451700000'
2025-07-02 11:46:36,753 - INFO - Write: :CALC:MARK2:FUNC:FPE:SEL 2
2025-07-02 11:46:36,754 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 11:46:36,801 - INFO - Response: 1450800000,1950100000,3051500000,3451700000
2025-07-02 11:46:36,801 - WARNING - Error retrieving data for spur 2: could not convert string to float: '1450800000,1950100000,3051500000,3451700000'
2025-07-02 11:46:36,801 - INFO - Write: :CALC:MARK3:FUNC:FPE:SEL 3
2025-07-02 11:46:36,802 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 11:46:36,849 - INFO - Response: 1450800000,1950100000,3051500000,3451700000
2025-07-02 11:46:36,850 - WARNING - Error retrieving data for spur 3: could not convert string to float: '1450800000,1950100000,3051500000,3451700000'
2025-07-02 11:46:36,850 - INFO - Write: :CALC:MARK4:FUNC:FPE:SEL 4
2025-07-02 11:46:36,851 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 11:46:36,896 - INFO - Response: 1450800000,1950100000,3051500000,3451700000
2025-07-02 11:46:36,896 - WARNING - Error retrieving data for spur 4: could not convert string to float: '1450800000,1950100000,3051500000,3451700000'
2025-07-02 11:46:36,897 - INFO - Socket closed
2025-07-02 11:46:36,897 - INFO - FSW connection closed
2025-07-02 11:46:36,897 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:46:36,898 - INFO - Socket closed
2025-07-02 11:46:36,899 - INFO - VSG connection closed
2025-07-02 11:46:36,904 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:46:37,261 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:46:37,309 - INFO - Socket closed
2025-07-02 11:46:37,310 - INFO - Socket closed
2025-07-02 11:49:30,582 - INFO - Starting RF measurement script
2025-07-02 11:49:30,584 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 11:49:30,584 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 11:49:30,584 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 11:49:30,588 - INFO - Connected to 192.168.200.20:5025
2025-07-02 11:49:30,589 - INFO - Query: *IDN?
2025-07-02 11:49:30,590 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 11:49:30,592 - INFO - Connected to 192.168.200.10:5025
2025-07-02 11:49:30,592 - INFO - Query: *IDN?
2025-07-02 11:49:30,593 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 11:49:30,593 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 11:49:30,593 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 11:49:30,593 - INFO - Query: *RST;*OPC?
2025-07-02 11:49:31,637 - INFO - Response: 1
2025-07-02 11:49:31,637 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 11:49:31,637 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 11:49:31,638 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 11:49:31,638 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 11:49:34,452 - INFO - Response: 1
2025-07-02 11:49:34,452 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 11:49:34,452 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 11:49:34,453 - INFO - Write: OUTPut1:STATe 1
2025-07-02 11:49:34,453 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 11:49:34,453 - INFO - Query: *RST;*OPC?
2025-07-02 11:49:34,540 - INFO - Response: 1
2025-07-02 11:49:34,540 - INFO - FSW reset for spur search
2025-07-02 11:49:34,540 - INFO - Write: INIT:CONT OFF
2025-07-02 11:49:34,540 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 11:49:34,540 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 11:49:34,540 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 11:49:34,540 - INFO - Write: :SENS:AVER:COUN 20
2025-07-02 11:49:34,540 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 11:49:34,540 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 11:49:34,540 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 11:49:34,541 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 11:49:34,541 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 11:49:34,541 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 11:49:34,541 - INFO - Write: SENS:POIN:VAL 2001
2025-07-02 11:49:34,541 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 11:49:34,541 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 11:49:34,541 - INFO - Write: :INP:ATT 0
2025-07-02 11:49:34,541 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 11:49:34,541 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 11:49:34,541 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 11:49:34,541 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 11:49:34,541 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 11:49:34,541 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 11:49:34,541 - INFO - Write: CALC1:THR -120
2025-07-02 11:49:34,541 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 11:49:34,541 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 11:49:34,541 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:49:45,866 - INFO - Response: 1
2025-07-02 11:49:45,867 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 11:49:45,867 - INFO - Spur detection table configured
2025-07-02 11:49:45,867 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 11:49:45,867 - INFO - Write: :INIT:CONT OFF
2025-07-02 11:49:45,867 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 11:49:49,629 - INFO - Response: 1
2025-07-02 11:49:49,629 - INFO - Spur search measurement completed
2025-07-02 11:49:49,629 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 11:49:49,630 - INFO - Response: 4
2025-07-02 11:49:49,631 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 11:49:49,631 - INFO - Response: 1450800000,1950100000,3051500000,3451700000
2025-07-02 11:49:49,631 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 11:49:49,632 - INFO - Response: -114.837738037,-90.3390731812,-95.5975646973,-119.403411865
2025-07-02 11:49:49,632 - INFO - Spur 1: 1.450800 GHz, -114.84 dBm
2025-07-02 11:49:49,632 - INFO - Spur 2: 1.950100 GHz, -90.34 dBm
2025-07-02 11:49:49,632 - INFO - Spur 3: 3.051500 GHz, -95.60 dBm
2025-07-02 11:49:49,632 - INFO - Spur 4: 3.451700 GHz, -119.40 dBm
2025-07-02 11:49:49,632 - INFO - Socket closed
2025-07-02 11:49:49,632 - INFO - FSW connection closed
2025-07-02 11:49:49,632 - INFO - Write: OUTP:STAT OFF
2025-07-02 11:49:49,632 - INFO - Socket closed
2025-07-02 11:49:49,632 - INFO - VSG connection closed
2025-07-02 11:49:49,635 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 11:49:49,880 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 11:49:49,924 - INFO - Socket closed
2025-07-02 11:49:49,925 - INFO - Socket closed
2025-07-02 12:02:06,277 - INFO - Starting RF measurement script
2025-07-02 12:02:06,282 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:02:06,282 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:02:06,283 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 12:02:06,288 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:02:06,289 - INFO - Query: *IDN?
2025-07-02 12:02:06,297 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:02:06,301 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:02:06,301 - INFO - Query: *IDN?
2025-07-02 12:02:06,302 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:02:06,302 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:02:06,302 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:02:06,303 - INFO - Query: *RST;*OPC?
2025-07-02 12:02:07,346 - INFO - Response: 1
2025-07-02 12:02:07,346 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:02:07,346 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:02:07,346 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:02:07,347 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:02:07,348 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:02:07,348 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:02:07,348 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:02:07,349 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:02:07,349 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:02:07,349 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:02:07,349 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:02:10,447 - INFO - Response: 1
2025-07-02 12:02:10,448 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:02:10,448 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:02:10,449 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:02:10,449 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:02:10,449 - INFO - Query: *RST;*OPC?
2025-07-02 12:02:10,532 - INFO - Response: 1
2025-07-02 12:02:10,532 - INFO - FSW reset for spur search
2025-07-02 12:02:10,532 - INFO - Write: INIT:CONT OFF
2025-07-02 12:02:10,532 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:02:10,532 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:02:10,532 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:02:10,533 - INFO - Write: :SENS:AVER:COUN 10
2025-07-02 12:02:10,533 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:02:10,533 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:02:10,533 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 12:02:10,533 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:02:10,533 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:02:10,533 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:02:10,533 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:02:10,533 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:02:10,534 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:02:10,534 - INFO - Write: :INP:ATT 0
2025-07-02 12:02:10,534 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:02:10,534 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:02:10,534 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:02:10,534 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:02:10,534 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:02:10,535 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:02:10,535 - INFO - Write: CALC1:THR -120
2025-07-02 12:02:10,535 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:02:10,535 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:02:10,535 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:02:16,302 - INFO - Response: 1
2025-07-02 12:02:16,303 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:02:16,303 - INFO - Spur detection table configured
2025-07-02 12:02:16,303 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:02:16,303 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:02:16,304 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:02:18,222 - INFO - Response: 1
2025-07-02 12:02:18,223 - INFO - Spur search measurement completed
2025-07-02 12:02:18,223 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:02:18,225 - INFO - Response: 13
2025-07-02 12:02:18,225 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:02:18,226 - INFO - Response: 1450000000,1949500000,3049600000,3450000000,3567600000,3811800000,3835700000,3894500000,3975300000,4057900000,4157100000,4250800000,4632800000
2025-07-02 12:02:18,226 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:02:18,227 - INFO - Response: -112.078651428,-87.314414978,-92.514289856,-116.074409485,-119.125572205,-119.208122253,-119.702102661,-118.919692993,-118.923522949,-119.609100342,-119.763626099,-119.711746216,-119.964866638
2025-07-02 12:02:18,227 - INFO - Spur 1: 1.450000 GHz, -112.08 dBm
2025-07-02 12:02:18,227 - INFO - Spur 2: 1.949500 GHz, -87.31 dBm
2025-07-02 12:02:18,227 - INFO - Spur 3: 3.049600 GHz, -92.51 dBm
2025-07-02 12:02:18,227 - INFO - Spur 4: 3.450000 GHz, -116.07 dBm
2025-07-02 12:02:18,227 - INFO - Spur 5: 3.567600 GHz, -119.13 dBm
2025-07-02 12:02:18,227 - INFO - Spur 6: 3.811800 GHz, -119.21 dBm
2025-07-02 12:02:18,228 - INFO - Spur 7: 3.835700 GHz, -119.70 dBm
2025-07-02 12:02:18,228 - INFO - Spur 8: 3.894500 GHz, -118.92 dBm
2025-07-02 12:02:18,228 - INFO - Spur 9: 3.975300 GHz, -118.92 dBm
2025-07-02 12:02:18,228 - INFO - Spur 10: 4.057900 GHz, -119.61 dBm
2025-07-02 12:02:18,228 - INFO - Spur 11: 4.157100 GHz, -119.76 dBm
2025-07-02 12:02:18,228 - INFO - Spur 12: 4.250800 GHz, -119.71 dBm
2025-07-02 12:02:18,228 - INFO - Spur 13: 4.632800 GHz, -119.96 dBm
2025-07-02 12:02:18,229 - INFO - Socket closed
2025-07-02 12:02:18,229 - INFO - FSW connection closed
2025-07-02 12:02:18,229 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:02:18,229 - INFO - Socket closed
2025-07-02 12:02:18,229 - INFO - VSG connection closed
2025-07-02 12:02:18,231 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:02:18,485 - ERROR - Error saving Excel results: [Errno 13] Permission denied: 'C:\\Users\\LINER\\Documents\\PycharmProjects\\20250701_STN_5G_LTE_Spur_tests\\src\\results_output.xlsx'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 677, in <module>
    df.to_excel(excel_path, index=False)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\core\generic.py", line 2436, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\LINER\\Documents\\PycharmProjects\\20250701_STN_5G_LTE_Spur_tests\\src\\results_output.xlsx'
2025-07-02 12:02:18,561 - INFO - Socket closed
2025-07-02 12:02:18,562 - INFO - Socket closed
2025-07-02 12:02:47,450 - INFO - Starting RF measurement script
2025-07-02 12:02:47,453 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:02:47,453 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:02:47,453 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 12:02:47,457 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:02:47,457 - INFO - Query: *IDN?
2025-07-02 12:02:47,458 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:02:47,460 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:02:47,460 - INFO - Query: *IDN?
2025-07-02 12:02:47,460 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:02:47,461 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:02:47,461 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:02:47,461 - INFO - Query: *RST;*OPC?
2025-07-02 12:02:48,512 - INFO - Response: 1
2025-07-02 12:02:48,513 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:02:48,513 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:02:48,513 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:02:48,513 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:02:48,513 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:02:48,513 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:02:48,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:02:48,515 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:02:51,324 - INFO - Response: 1
2025-07-02 12:02:51,324 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:02:51,325 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:02:51,325 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:02:51,325 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:02:51,325 - INFO - Query: *RST;*OPC?
2025-07-02 12:02:51,406 - INFO - Response: 1
2025-07-02 12:02:51,407 - INFO - FSW reset for spur search
2025-07-02 12:02:51,407 - INFO - Write: INIT:CONT OFF
2025-07-02 12:02:51,407 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:02:51,407 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:02:51,408 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:02:51,408 - INFO - Write: :SENS:AVER:COUN 10
2025-07-02 12:02:51,408 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:02:51,408 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:02:51,408 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 12:02:51,409 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:02:51,409 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:02:51,409 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:02:51,409 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:02:51,409 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:02:51,409 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:02:51,410 - INFO - Write: :INP:ATT 0
2025-07-02 12:02:51,410 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:02:51,410 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:02:51,410 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:02:51,410 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:02:51,410 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:02:51,411 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:02:51,411 - INFO - Write: CALC1:THR -115
2025-07-02 12:02:51,411 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:02:51,411 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:02:51,411 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:02:57,188 - INFO - Response: 1
2025-07-02 12:02:57,189 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:02:57,189 - INFO - Spur detection table configured
2025-07-02 12:02:57,190 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:02:57,190 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:02:57,190 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:02:59,097 - INFO - Response: 1
2025-07-02 12:02:59,097 - INFO - Spur search measurement completed
2025-07-02 12:02:59,098 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:02:59,099 - INFO - Response: 3
2025-07-02 12:02:59,099 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:02:59,100 - INFO - Response: 1450000000,1949500000,3049600000
2025-07-02 12:02:59,101 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:02:59,101 - INFO - Response: -111.963691711,-87.3051986694,-92.5142745972
2025-07-02 12:02:59,102 - INFO - Spur 1: 1.450000 GHz, -111.96 dBm
2025-07-02 12:02:59,102 - INFO - Spur 2: 1.949500 GHz, -87.31 dBm
2025-07-02 12:02:59,102 - INFO - Spur 3: 3.049600 GHz, -92.51 dBm
2025-07-02 12:02:59,102 - INFO - Socket closed
2025-07-02 12:02:59,102 - INFO - FSW connection closed
2025-07-02 12:02:59,103 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:02:59,103 - INFO - Socket closed
2025-07-02 12:02:59,103 - INFO - VSG connection closed
2025-07-02 12:02:59,105 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:02:59,356 - ERROR - Error saving Excel results: [Errno 13] Permission denied: 'C:\\Users\\LINER\\Documents\\PycharmProjects\\20250701_STN_5G_LTE_Spur_tests\\src\\results_output.xlsx'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 677, in <module>
    df.to_excel(excel_path, index=False)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\core\generic.py", line 2436, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\LINER\\Documents\\PycharmProjects\\20250701_STN_5G_LTE_Spur_tests\\src\\results_output.xlsx'
2025-07-02 12:02:59,416 - INFO - Socket closed
2025-07-02 12:02:59,425 - INFO - Socket closed
2025-07-02 12:04:14,721 - INFO - Starting RF measurement script
2025-07-02 12:04:14,723 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:04:14,724 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:04:14,724 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:04:14,728 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:04:14,729 - INFO - Query: *IDN?
2025-07-02 12:04:14,738 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:04:14,740 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:04:14,740 - INFO - Query: *IDN?
2025-07-02 12:04:14,741 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:04:14,741 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:04:14,741 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:04:14,741 - INFO - Query: *RST;*OPC?
2025-07-02 12:04:15,793 - INFO - Response: 1
2025-07-02 12:04:15,794 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:04:15,794 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:04:15,794 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:04:15,795 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:04:15,795 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:04:15,795 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:04:15,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:04:15,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:04:15,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:04:15,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:04:15,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:04:15,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:04:15,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:04:15,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:04:15,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:04:15,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:04:15,798 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:04:18,909 - INFO - Response: 1
2025-07-02 12:04:18,910 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:04:18,910 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:04:18,910 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:04:18,910 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:04:18,911 - INFO - Query: *RST;*OPC?
2025-07-02 12:04:19,101 - INFO - Response: 1
2025-07-02 12:04:19,102 - INFO - FSW reset for spur search
2025-07-02 12:04:19,102 - INFO - Write: INIT:CONT OFF
2025-07-02 12:04:19,102 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:04:19,103 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:04:19,103 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:04:19,103 - INFO - Write: :SENS:AVER:COUN 2
2025-07-02 12:04:19,103 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:04:19,103 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:04:19,103 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:04:19,103 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:04:19,104 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:04:19,104 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:04:19,104 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:04:19,104 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:04:19,104 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:04:19,104 - INFO - Write: :INP:ATT 0
2025-07-02 12:04:19,104 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:04:19,105 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:04:19,105 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:04:19,105 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:04:19,105 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:04:19,105 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:04:19,105 - INFO - Write: CALC1:THR -115
2025-07-02 12:04:19,105 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:04:19,105 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:04:19,105 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:04:31,171 - INFO - Response: 1
2025-07-02 12:04:31,171 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:04:31,172 - INFO - Spur detection table configured
2025-07-02 12:04:31,172 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:04:31,172 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:04:31,172 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:04:36,218 - INFO - Response: 1
2025-07-02 12:04:36,219 - INFO - Spur search measurement completed
2025-07-02 12:04:36,219 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:04:36,221 - INFO - Response: 3
2025-07-02 12:04:36,221 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:04:36,222 - INFO - Response: 1450000000,1949500000,3049600000
2025-07-02 12:04:36,223 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:04:36,225 - INFO - Response: -114.092529297,-89.7744369507,-94.9456634521
2025-07-02 12:04:36,225 - INFO - Spur 1: 1.450000 GHz, -114.09 dBm
2025-07-02 12:04:36,226 - INFO - Spur 2: 1.949500 GHz, -89.77 dBm
2025-07-02 12:04:36,226 - INFO - Spur 3: 3.049600 GHz, -94.95 dBm
2025-07-02 12:04:36,226 - INFO - Socket closed
2025-07-02 12:04:36,226 - INFO - FSW connection closed
2025-07-02 12:04:36,226 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:04:36,227 - INFO - Socket closed
2025-07-02 12:04:36,227 - INFO - VSG connection closed
2025-07-02 12:04:36,230 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:04:36,479 - ERROR - Error saving Excel results: [Errno 13] Permission denied: 'C:\\Users\\LINER\\Documents\\PycharmProjects\\20250701_STN_5G_LTE_Spur_tests\\src\\results_output.xlsx'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 677, in <module>
    df.to_excel(excel_path, index=False)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\core\generic.py", line 2436, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\LINER\\Documents\\PycharmProjects\\20250701_STN_5G_LTE_Spur_tests\\src\\results_output.xlsx'
2025-07-02 12:04:36,538 - INFO - Socket closed
2025-07-02 12:04:36,548 - INFO - Socket closed
2025-07-02 12:05:32,469 - INFO - Starting RF measurement script
2025-07-02 12:05:32,471 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:05:32,472 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:05:32,472 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:05:32,477 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:05:32,477 - INFO - Query: *IDN?
2025-07-02 12:05:32,478 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:05:32,480 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:05:32,480 - INFO - Query: *IDN?
2025-07-02 12:05:32,481 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:05:32,481 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:05:32,481 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:05:32,482 - INFO - Query: *RST;*OPC?
2025-07-02 12:05:33,537 - INFO - Response: 1
2025-07-02 12:05:33,537 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:05:33,537 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:05:33,537 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:05:33,537 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:05:33,538 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:05:33,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:05:33,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:05:33,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:05:33,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:05:33,539 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:05:36,365 - INFO - Response: 1
2025-07-02 12:05:36,366 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:05:36,367 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:05:36,367 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:05:36,367 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:05:36,367 - INFO - Query: *RST;*OPC?
2025-07-02 12:05:36,556 - INFO - Response: 1
2025-07-02 12:05:36,556 - INFO - FSW reset for spur search
2025-07-02 12:05:36,556 - INFO - Write: INIT:CONT OFF
2025-07-02 12:05:36,556 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:05:36,556 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:05:36,556 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:05:36,557 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:05:36,557 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:05:36,557 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:05:36,557 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:05:36,557 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:05:36,557 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:05:36,557 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:05:36,557 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:05:36,557 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:05:36,557 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:05:36,558 - INFO - Write: :INP:ATT 0
2025-07-02 12:05:36,558 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:05:36,558 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:05:36,558 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:05:36,558 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:05:36,558 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:05:36,558 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:05:36,558 - INFO - Write: CALC1:THR -115
2025-07-02 12:05:36,558 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:05:36,558 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:05:36,558 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:05:54,521 - INFO - Response: 1
2025-07-02 12:05:54,521 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:05:54,522 - INFO - Spur detection table configured
2025-07-02 12:05:54,522 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:05:54,522 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:05:54,522 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:06:02,077 - INFO - Response: 1
2025-07-02 12:06:02,077 - INFO - Spur search measurement completed
2025-07-02 12:06:02,078 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:06:02,079 - INFO - Response: 3
2025-07-02 12:06:02,079 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:06:02,080 - INFO - Response: 1450000000,1949500000,3049600000
2025-07-02 12:06:02,080 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:06:02,081 - INFO - Response: -114.793449402,-89.7331848145,-94.9708023071
2025-07-02 12:06:02,082 - INFO - Spur 1: 1.450000 GHz, -114.79 dBm
2025-07-02 12:06:02,082 - INFO - Spur 2: 1.949500 GHz, -89.73 dBm
2025-07-02 12:06:02,082 - INFO - Spur 3: 3.049600 GHz, -94.97 dBm
2025-07-02 12:06:02,082 - INFO - Socket closed
2025-07-02 12:06:02,082 - INFO - FSW connection closed
2025-07-02 12:06:02,083 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:06:02,083 - INFO - Socket closed
2025-07-02 12:06:02,083 - INFO - VSG connection closed
2025-07-02 12:06:02,085 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:06:02,354 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:06:02,410 - INFO - Socket closed
2025-07-02 12:06:02,411 - INFO - Socket closed
2025-07-02 12:06:39,750 - INFO - Starting RF measurement script
2025-07-02 12:06:39,751 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:06:39,751 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:06:39,752 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:06:39,755 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:06:39,755 - INFO - Query: *IDN?
2025-07-02 12:06:39,756 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:06:39,758 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:06:39,758 - INFO - Query: *IDN?
2025-07-02 12:06:39,759 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:06:39,759 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:06:39,759 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:06:39,759 - INFO - Query: *RST;*OPC?
2025-07-02 12:06:40,806 - INFO - Response: 1
2025-07-02 12:06:40,806 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:06:40,806 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:06:40,806 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:06:40,806 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:06:40,806 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:06:40,806 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:06:40,807 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:06:40,807 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:06:43,917 - INFO - Response: 1
2025-07-02 12:06:43,918 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:06:43,918 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:06:43,918 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:06:43,918 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:06:43,918 - INFO - Query: *RST;*OPC?
2025-07-02 12:06:44,103 - INFO - Response: 1
2025-07-02 12:06:44,103 - INFO - FSW reset for spur search
2025-07-02 12:06:44,103 - INFO - Write: INIT:CONT OFF
2025-07-02 12:06:44,103 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:06:44,103 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:06:44,103 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:06:44,103 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:06:44,104 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:06:44,104 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:06:44,104 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:06:44,104 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:06:44,104 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:06:44,104 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:06:44,104 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:06:44,104 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:06:44,104 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:06:44,104 - INFO - Write: :INP:ATT 0
2025-07-02 12:06:44,104 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:06:44,104 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:06:44,104 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:06:44,104 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:06:44,104 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:06:44,105 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:06:44,105 - INFO - Write: CALC1:THR -120
2025-07-02 12:06:44,105 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:06:44,105 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:06:44,105 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:07:02,067 - INFO - Response: 1
2025-07-02 12:07:02,067 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:07:02,068 - INFO - Spur detection table configured
2025-07-02 12:07:02,068 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:07:02,068 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:07:02,068 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:07:09,633 - INFO - Response: 1
2025-07-02 12:07:09,634 - INFO - Spur search measurement completed
2025-07-02 12:07:09,634 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:07:09,635 - INFO - Response: 4
2025-07-02 12:07:09,635 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:07:09,635 - INFO - Response: 1450000000,1949500000,3049600000,3450000000
2025-07-02 12:07:09,636 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:07:09,636 - INFO - Response: -114.354957581,-89.734703064,-94.9460220337,-119.220169067
2025-07-02 12:07:09,636 - INFO - Spur 1: 1.450000 GHz, -114.35 dBm
2025-07-02 12:07:09,636 - INFO - Spur 2: 1.949500 GHz, -89.73 dBm
2025-07-02 12:07:09,636 - INFO - Spur 3: 3.049600 GHz, -94.95 dBm
2025-07-02 12:07:09,636 - INFO - Spur 4: 3.450000 GHz, -119.22 dBm
2025-07-02 12:07:09,636 - INFO - Socket closed
2025-07-02 12:07:09,636 - INFO - FSW connection closed
2025-07-02 12:07:09,637 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:07:09,637 - INFO - Socket closed
2025-07-02 12:07:09,637 - INFO - VSG connection closed
2025-07-02 12:07:09,638 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:07:09,872 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:07:09,931 - INFO - Socket closed
2025-07-02 12:07:09,932 - INFO - Socket closed
2025-07-02 12:08:56,171 - INFO - Starting RF measurement script
2025-07-02 12:08:56,173 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:08:56,173 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:08:56,173 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:08:56,178 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:08:56,178 - INFO - Query: *IDN?
2025-07-02 12:08:56,180 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:08:56,182 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:08:56,182 - INFO - Query: *IDN?
2025-07-02 12:08:56,183 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:08:56,183 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:08:56,183 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:08:56,183 - INFO - Query: *RST;*OPC?
2025-07-02 12:08:57,227 - INFO - Response: 1
2025-07-02 12:08:57,228 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:08:57,229 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:08:57,229 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:08:57,229 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:08:57,229 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:08:57,230 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:08:57,230 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:08:57,230 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:08:57,230 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:08:57,230 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:08:57,230 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:08:57,231 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:08:57,231 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:08:57,231 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:08:57,231 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:08:57,231 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:08:57,232 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:09:00,028 - INFO - Response: 1
2025-07-02 12:09:00,029 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:09:00,029 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:09:00,029 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:09:00,029 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:09:00,030 - INFO - Query: *RST;*OPC?
2025-07-02 12:09:00,213 - INFO - Response: 1
2025-07-02 12:09:00,214 - INFO - FSW reset for spur search
2025-07-02 12:09:00,214 - INFO - Write: INIT:CONT OFF
2025-07-02 12:09:00,214 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:09:00,214 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:09:00,214 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:09:00,214 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:09:00,214 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:09:00,214 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:09:00,214 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:09:00,214 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:09:00,214 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:09:00,214 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:09:00,215 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:09:00,215 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:09:00,215 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:09:00,215 - INFO - Write: :INP:ATT 0
2025-07-02 12:09:00,215 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:09:00,215 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:09:00,215 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:09:00,215 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:09:00,215 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:09:00,215 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:09:00,215 - INFO - Write: CALC1:THR -120
2025-07-02 12:09:00,215 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:09:00,215 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:09:00,215 - INFO - Spur detection table configured
2025-07-02 12:09:00,215 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:09:00,215 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:09:00,216 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:09:18,209 - INFO - Response: 1
2025-07-02 12:09:18,210 - INFO - Spur search measurement completed
2025-07-02 12:09:18,210 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:09:18,212 - INFO - Response: 4
2025-07-02 12:09:18,212 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:09:18,212 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:09:18,259 - INFO - Response: 1450000000,1949500000,3049600000,3929400000
2025-07-02 12:09:18,259 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:09:18,260 - INFO - Response: -114.550880432,-89.7635345459,-94.963432312,-119.777770996
2025-07-02 12:09:18,261 - INFO - Spur 1: 1.450000 GHz, -114.55 dBm
2025-07-02 12:09:18,261 - INFO - Spur 2: 1.949500 GHz, -89.76 dBm
2025-07-02 12:09:18,261 - INFO - Spur 3: 3.049600 GHz, -94.96 dBm
2025-07-02 12:09:18,261 - INFO - Spur 4: 3.929400 GHz, -119.78 dBm
2025-07-02 12:09:18,261 - INFO - Socket closed
2025-07-02 12:09:18,261 - INFO - FSW connection closed
2025-07-02 12:09:18,261 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:09:18,262 - INFO - Socket closed
2025-07-02 12:09:18,262 - INFO - VSG connection closed
2025-07-02 12:09:18,264 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:09:18,514 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:09:18,557 - INFO - Socket closed
2025-07-02 12:09:18,558 - INFO - Socket closed
2025-07-02 12:14:22,990 - INFO - Starting RF measurement script
2025-07-02 12:14:22,992 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:14:22,992 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:14:22,992 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:14:22,996 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:14:22,997 - INFO - Query: *IDN?
2025-07-02 12:14:23,001 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:14:23,005 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:14:23,005 - INFO - Query: *IDN?
2025-07-02 12:14:23,005 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:14:23,005 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:14:23,006 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:14:23,006 - INFO - Query: *RST;*OPC?
2025-07-02 12:14:24,067 - INFO - Response: 1
2025-07-02 12:14:24,067 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:14:24,067 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:14:24,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:14:24,069 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:14:24,069 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:14:24,069 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:14:26,946 - INFO - Response: 1
2025-07-02 12:14:26,947 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:14:26,947 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:14:26,947 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:14:26,947 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:14:26,947 - INFO - Query: *RST;*OPC?
2025-07-02 12:14:27,134 - INFO - Response: 1
2025-07-02 12:14:27,134 - INFO - FSW reset for spur search
2025-07-02 12:14:27,134 - INFO - Write: INIT:CONT OFF
2025-07-02 12:14:27,134 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:14:27,134 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:14:27,134 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:14:27,135 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:14:27,135 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:14:27,135 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:14:27,135 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:14:27,135 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:14:27,135 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:14:27,135 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:14:27,135 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:14:27,135 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:14:27,135 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:14:27,135 - INFO - Write: :INP:ATT 0
2025-07-02 12:14:27,135 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:14:27,135 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:14:27,135 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:14:27,136 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:14:27,136 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:14:27,136 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:14:27,136 - INFO - Write: CALC1:THR -120
2025-07-02 12:14:27,136 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:14:27,136 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:14:27,136 - INFO - Spur detection table configured
2025-07-02 12:14:27,136 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:14:27,136 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:14:27,136 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:14:45,104 - INFO - Response: 1
2025-07-02 12:14:45,104 - INFO - Spur search measurement completed
2025-07-02 12:14:45,105 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:14:45,107 - INFO - Response: 4
2025-07-02 12:14:45,107 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:14:45,107 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:14:45,157 - INFO - Response: 1450000000,1949500000,3049600000,3450000000
2025-07-02 12:14:45,157 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:14:45,158 - INFO - Response: -114.418518066,-89.7663269043,-94.9999008179,-118.920799255
2025-07-02 12:14:45,159 - INFO - Spur 1: 1.450000 GHz, -114.42 dBm
2025-07-02 12:14:45,159 - INFO - Spur 2: 1.949500 GHz, -89.77 dBm
2025-07-02 12:14:45,159 - INFO - Spur 3: 3.049600 GHz, -95.00 dBm
2025-07-02 12:14:45,159 - INFO - Spur 4: 3.450000 GHz, -118.92 dBm
2025-07-02 12:14:45,159 - INFO - Socket closed
2025-07-02 12:14:45,159 - INFO - FSW connection closed
2025-07-02 12:14:45,159 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:14:45,160 - INFO - Socket closed
2025-07-02 12:14:45,160 - INFO - VSG connection closed
2025-07-02 12:14:45,164 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:14:45,400 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:14:45,435 - INFO - Socket closed
2025-07-02 12:14:45,436 - INFO - Socket closed
2025-07-02 12:16:17,332 - INFO - Starting RF measurement script
2025-07-02 12:16:17,334 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:16:17,335 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:16:17,335 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:16:17,340 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:16:17,340 - INFO - Query: *IDN?
2025-07-02 12:16:17,351 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:16:17,354 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:16:17,355 - INFO - Query: *IDN?
2025-07-02 12:16:17,355 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:16:17,355 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:16:17,355 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:16:17,355 - INFO - Query: *RST;*OPC?
2025-07-02 12:16:18,405 - INFO - Response: 1
2025-07-02 12:16:18,405 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:16:18,406 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:16:18,406 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:16:18,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:16:18,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:16:18,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:16:18,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:16:18,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:16:18,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:16:18,407 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:16:21,259 - INFO - Response: 1
2025-07-02 12:16:21,260 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:16:21,260 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:16:21,260 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:16:21,260 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:16:21,260 - INFO - Query: *RST;*OPC?
2025-07-02 12:16:21,448 - INFO - Response: 1
2025-07-02 12:16:21,448 - INFO - FSW reset for spur search
2025-07-02 12:16:21,449 - INFO - Write: INIT:CONT OFF
2025-07-02 12:16:21,449 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:16:21,449 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:16:21,450 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:16:21,450 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:16:21,450 - INFO - Write: :SENS:WIND1:DET1:FUNC AVER
2025-07-02 12:16:21,450 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:16:21,450 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:16:21,451 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:16:21,451 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:16:21,451 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:16:21,451 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:16:21,451 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:16:21,452 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:16:21,452 - INFO - Write: :INP:ATT 0
2025-07-02 12:16:21,452 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:16:21,452 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:16:21,452 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:16:21,452 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:16:21,453 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:16:21,453 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:16:21,453 - INFO - Write: CALC1:THR -120
2025-07-02 12:16:21,453 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:16:21,453 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:16:21,454 - INFO - Spur detection table configured
2025-07-02 12:16:21,454 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:16:21,454 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:16:21,454 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:16:39,427 - INFO - Response: 1
2025-07-02 12:16:39,428 - INFO - Spur search measurement completed
2025-07-02 12:16:39,428 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:16:39,430 - INFO - Response: 2
2025-07-02 12:16:39,430 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:16:39,431 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:16:39,482 - INFO - Response: 1949500000,3049600000
2025-07-02 12:16:39,482 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:16:39,483 - INFO - Response: -103.722198486,-108.030311584
2025-07-02 12:16:39,484 - INFO - Spur 1: 1.949500 GHz, -103.72 dBm
2025-07-02 12:16:39,484 - INFO - Spur 2: 3.049600 GHz, -108.03 dBm
2025-07-02 12:16:39,484 - INFO - Socket closed
2025-07-02 12:16:39,485 - INFO - FSW connection closed
2025-07-02 12:16:39,485 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:16:39,485 - INFO - Socket closed
2025-07-02 12:16:39,485 - INFO - VSG connection closed
2025-07-02 12:16:39,488 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:16:39,743 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:16:39,786 - INFO - Socket closed
2025-07-02 12:16:39,787 - INFO - Socket closed
2025-07-02 12:16:49,805 - INFO - Starting RF measurement script
2025-07-02 12:16:49,807 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:16:49,807 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.03,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:16:49,807 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.03, 'spur_limit_dbm': -95}
2025-07-02 12:16:49,811 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:16:49,811 - INFO - Query: *IDN?
2025-07-02 12:16:49,813 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:16:49,814 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:16:49,815 - INFO - Query: *IDN?
2025-07-02 12:16:49,815 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:16:49,815 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.03 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:16:49,816 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.030 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:16:49,816 - INFO - Query: *RST;*OPC?
2025-07-02 12:16:50,864 - INFO - Response: 1
2025-07-02 12:16:50,865 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:16:50,865 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:16:50,865 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:16:50,866 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:16:50,866 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:16:50,866 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:16:50,866 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:16:50,867 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:16:50,867 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:16:50,867 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:16:50,867 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:16:50,868 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:16:50,868 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:16:50,868 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:16:50,869 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:16:50,869 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:16:50,869 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:16:53,719 - INFO - Response: 1
2025-07-02 12:16:53,720 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:16:53,720 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:16:53,721 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:16:53,721 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:16:53,721 - INFO - Query: *RST;*OPC?
2025-07-02 12:16:53,909 - INFO - Response: 1
2025-07-02 12:16:53,909 - INFO - FSW reset for spur search
2025-07-02 12:16:53,910 - INFO - Write: INIT:CONT OFF
2025-07-02 12:16:53,910 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:16:53,910 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:16:53,911 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:16:53,911 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:16:53,911 - INFO - Write: :SENS:WIND1:DET1:FUNC AVER
2025-07-02 12:16:53,911 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:16:53,912 - INFO - Write: :SENS:BAND:RES 30000.0
2025-07-02 12:16:53,912 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:16:53,912 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:16:53,912 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:16:53,912 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:16:53,913 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:16:53,913 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:16:53,913 - INFO - Write: :INP:ATT 0
2025-07-02 12:16:53,913 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:16:53,913 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:16:53,913 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:16:53,914 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:16:53,914 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:16:53,914 - INFO - Write: CALC1:THR -120
2025-07-02 12:16:53,914 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:16:53,914 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:16:53,914 - INFO - Spur detection table configured
2025-07-02 12:16:53,914 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:16:53,915 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:16:53,915 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:17:01,550 - INFO - Response: 1
2025-07-02 12:17:01,550 - INFO - Spur search measurement completed
2025-07-02 12:17:01,550 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:17:01,552 - INFO - Response: 2
2025-07-02 12:17:01,552 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:17:01,553 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:17:01,594 - INFO - Response: 1949500000,3049600000
2025-07-02 12:17:01,595 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:17:01,596 - INFO - Response: -103.693603516,-107.832473755
2025-07-02 12:17:01,596 - INFO - Spur 1: 1.949500 GHz, -103.69 dBm
2025-07-02 12:17:01,596 - INFO - Spur 2: 3.049600 GHz, -107.83 dBm
2025-07-02 12:17:01,596 - INFO - Socket closed
2025-07-02 12:17:01,597 - INFO - FSW connection closed
2025-07-02 12:17:01,597 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:17:01,597 - INFO - Socket closed
2025-07-02 12:17:01,597 - INFO - VSG connection closed
2025-07-02 12:17:01,601 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:17:01,843 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:17:01,888 - INFO - Socket closed
2025-07-02 12:17:01,890 - INFO - Socket closed
2025-07-02 12:17:34,984 - INFO - Starting RF measurement script
2025-07-02 12:17:34,986 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:17:34,986 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:17:34,987 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 12:17:34,991 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:17:34,991 - INFO - Query: *IDN?
2025-07-02 12:17:34,996 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:17:34,998 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:17:34,998 - INFO - Query: *IDN?
2025-07-02 12:17:34,999 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:17:34,999 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:17:34,999 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:17:34,999 - INFO - Query: *RST;*OPC?
2025-07-02 12:17:36,052 - INFO - Response: 1
2025-07-02 12:17:36,053 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:17:36,053 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:17:36,053 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:17:36,054 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:17:36,054 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:17:36,054 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:17:36,054 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:17:36,055 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:17:36,055 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:17:36,056 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:17:36,056 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:17:36,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:17:36,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:17:36,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:17:36,058 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:17:36,058 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:17:36,058 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:17:38,886 - INFO - Response: 1
2025-07-02 12:17:38,886 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:17:38,887 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:17:38,887 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:17:38,888 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:17:38,888 - INFO - Query: *RST;*OPC?
2025-07-02 12:17:38,969 - INFO - Response: 1
2025-07-02 12:17:38,969 - INFO - FSW reset for spur search
2025-07-02 12:17:38,970 - INFO - Write: INIT:CONT OFF
2025-07-02 12:17:38,970 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:17:38,970 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:17:38,970 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:17:38,970 - INFO - Write: :SENS:AVER:COUN 3
2025-07-02 12:17:38,970 - INFO - Write: :SENS:WIND1:DET1:FUNC AVER
2025-07-02 12:17:38,970 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:17:38,970 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 12:17:38,970 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:17:38,971 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:17:38,971 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:17:38,971 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:17:38,971 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:17:38,972 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:17:38,972 - INFO - Write: :INP:ATT 0
2025-07-02 12:17:38,972 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:17:38,972 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:17:38,973 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:17:38,973 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:17:38,973 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:17:38,973 - INFO - Write: CALC1:THR -120
2025-07-02 12:17:38,973 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:17:38,973 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:17:38,974 - INFO - Spur detection table configured
2025-07-02 12:17:38,974 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:17:38,974 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:17:38,975 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:17:39,639 - INFO - Response: 1
2025-07-02 12:17:39,639 - INFO - Spur search measurement completed
2025-07-02 12:17:39,639 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:17:39,642 - INFO - Response: 2
2025-07-02 12:17:39,642 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:17:39,642 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:17:39,691 - INFO - Response: 1949500000,3049600000
2025-07-02 12:17:39,691 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:17:39,692 - INFO - Response: -99.0229492188,-103.396202087
2025-07-02 12:17:39,692 - INFO - Spur 1: 1.949500 GHz, -99.02 dBm
2025-07-02 12:17:39,692 - INFO - Spur 2: 3.049600 GHz, -103.40 dBm
2025-07-02 12:17:39,693 - INFO - Socket closed
2025-07-02 12:17:39,693 - INFO - FSW connection closed
2025-07-02 12:17:39,693 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:17:39,693 - INFO - Socket closed
2025-07-02 12:17:39,693 - INFO - VSG connection closed
2025-07-02 12:17:39,696 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:17:39,937 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:17:39,987 - INFO - Socket closed
2025-07-02 12:17:39,988 - INFO - Socket closed
2025-07-02 12:19:33,482 - INFO - Starting RF measurement script
2025-07-02 12:19:33,484 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:19:33,484 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:19:33,484 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 12:19:33,489 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:19:33,489 - INFO - Query: *IDN?
2025-07-02 12:19:33,498 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:19:33,500 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:19:33,501 - INFO - Query: *IDN?
2025-07-02 12:19:33,501 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:19:33,501 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:19:33,501 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:19:33,501 - INFO - Query: *RST;*OPC?
2025-07-02 12:19:34,542 - INFO - Response: 1
2025-07-02 12:19:34,542 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:19:34,543 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:19:34,543 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:19:34,543 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:19:34,544 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:19:34,544 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:19:34,544 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:19:34,545 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:19:34,545 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:19:34,545 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:19:34,545 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:19:34,546 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:19:34,546 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:19:34,546 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:19:34,546 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:19:34,546 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:19:34,547 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:19:37,632 - INFO - Response: 1
2025-07-02 12:19:37,633 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:19:37,633 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:19:37,634 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:19:37,634 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:19:37,634 - INFO - Query: *RST;*OPC?
2025-07-02 12:19:37,723 - INFO - Response: 1
2025-07-02 12:19:37,723 - INFO - FSW reset for spur search
2025-07-02 12:19:37,723 - INFO - Write: INIT:CONT OFF
2025-07-02 12:19:37,724 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:19:37,724 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:19:37,724 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE RMS
2025-07-02 12:19:37,724 - INFO - Write: :SENS:AVER:COUN 10
2025-07-02 12:19:37,724 - INFO - Write: :SENS:WIND1:DET1:FUNC AVER
2025-07-02 12:19:37,724 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:19:37,724 - INFO - Write: :SENS:BAND:RES 50000.0
2025-07-02 12:19:37,724 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:19:37,724 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:19:37,725 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:19:37,725 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:19:37,725 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:19:37,725 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:19:37,725 - INFO - Write: :INP:ATT 0
2025-07-02 12:19:37,725 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:19:37,725 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:19:37,725 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:19:37,725 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:19:37,726 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:19:37,726 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:19:37,726 - INFO - Write: CALC1:THR -120
2025-07-02 12:19:37,726 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:19:37,726 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:19:37,726 - INFO - Spur detection table configured
2025-07-02 12:19:37,726 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:19:37,726 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:19:37,726 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:19:40,201 - INFO - Response: 1
2025-07-02 12:19:40,201 - INFO - Spur search measurement completed
2025-07-02 12:19:40,201 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:19:40,203 - INFO - Response: 50
2025-07-02 12:19:40,203 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:19:40,203 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:19:40,253 - INFO - Response: 1450000000,1949500000,3023900000,3049600000,3148800000,3161700000,3244300000,3325100000,3367400000,3404100000,3450000000,3490400000,3497800000,3571200000,3622700000,3672200000,3749400000,3806300000,3826500000,3863200000,3927500000,3934900000,3955100000,3971600000,3990000000,4002800000,4091000000,4149800000,4182800000,4195700000,4223200000,4248900000,4283800000,4307700000,4381200000,4390300000,4414200000,4438100000,4460100000,4476700000,4487700000,4509700000,4540900000,4574000000,4627300000,4660300000,4774200000,4798100000,4840300000,4880700000
2025-07-02 12:19:40,254 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:19:40,255 - INFO - Response: -117.121131897,-98.92603302,-117.669570923,-103.403503418,-117.493713379,-117.164337158,-117.493621826,-117.361541748,-117.794502258,-116.924354553,-116.686538696,-117.422515869,-117.024742126,-116.304046631,-116.973014832,-117.878379822,-117.667755127,-117.318977356,-117.828956604,-117.432792664,-116.043251038,-116.209335327,-116.580024719,-116.88671875,-117.104507446,-117.329154968,-116.443237305,-117.696907043,-117.783958435,-117.837135315,-116.780311584,-116.88508606,-117.063423157,-116.548301697,-117.594764709,-117.292266846,-116.732192993,-116.793357849,-117.912750244,-117.791847229,-116.653388977,-116.980232239,-116.148376465,-116.929420471,-117.909248352,-117.579055786,-117.820419312,-116.884773254,-117.234298706,-117.133659363
2025-07-02 12:19:40,256 - INFO - Spur 1: 1.450000 GHz, -117.12 dBm
2025-07-02 12:19:40,256 - INFO - Spur 2: 1.949500 GHz, -98.93 dBm
2025-07-02 12:19:40,256 - INFO - Spur 3: 3.023900 GHz, -117.67 dBm
2025-07-02 12:19:40,256 - INFO - Spur 4: 3.049600 GHz, -103.40 dBm
2025-07-02 12:19:40,256 - INFO - Spur 5: 3.148800 GHz, -117.49 dBm
2025-07-02 12:19:40,256 - INFO - Spur 6: 3.161700 GHz, -117.16 dBm
2025-07-02 12:19:40,257 - INFO - Spur 7: 3.244300 GHz, -117.49 dBm
2025-07-02 12:19:40,257 - INFO - Spur 8: 3.325100 GHz, -117.36 dBm
2025-07-02 12:19:40,257 - INFO - Spur 9: 3.367400 GHz, -117.79 dBm
2025-07-02 12:19:40,257 - INFO - Spur 10: 3.404100 GHz, -116.92 dBm
2025-07-02 12:19:40,257 - INFO - Spur 11: 3.450000 GHz, -116.69 dBm
2025-07-02 12:19:40,257 - INFO - Spur 12: 3.490400 GHz, -117.42 dBm
2025-07-02 12:19:40,257 - INFO - Spur 13: 3.497800 GHz, -117.02 dBm
2025-07-02 12:19:40,257 - INFO - Spur 14: 3.571200 GHz, -116.30 dBm
2025-07-02 12:19:40,257 - INFO - Spur 15: 3.622700 GHz, -116.97 dBm
2025-07-02 12:19:40,257 - INFO - Spur 16: 3.672200 GHz, -117.88 dBm
2025-07-02 12:19:40,257 - INFO - Spur 17: 3.749400 GHz, -117.67 dBm
2025-07-02 12:19:40,257 - INFO - Spur 18: 3.806300 GHz, -117.32 dBm
2025-07-02 12:19:40,257 - INFO - Spur 19: 3.826500 GHz, -117.83 dBm
2025-07-02 12:19:40,258 - INFO - Spur 20: 3.863200 GHz, -117.43 dBm
2025-07-02 12:19:40,258 - INFO - Spur 21: 3.927500 GHz, -116.04 dBm
2025-07-02 12:19:40,258 - INFO - Spur 22: 3.934900 GHz, -116.21 dBm
2025-07-02 12:19:40,258 - INFO - Spur 23: 3.955100 GHz, -116.58 dBm
2025-07-02 12:19:40,258 - INFO - Spur 24: 3.971600 GHz, -116.89 dBm
2025-07-02 12:19:40,258 - INFO - Spur 25: 3.990000 GHz, -117.10 dBm
2025-07-02 12:19:40,258 - INFO - Spur 26: 4.002800 GHz, -117.33 dBm
2025-07-02 12:19:40,258 - INFO - Spur 27: 4.091000 GHz, -116.44 dBm
2025-07-02 12:19:40,258 - INFO - Spur 28: 4.149800 GHz, -117.70 dBm
2025-07-02 12:19:40,258 - INFO - Spur 29: 4.182800 GHz, -117.78 dBm
2025-07-02 12:19:40,258 - INFO - Spur 30: 4.195700 GHz, -117.84 dBm
2025-07-02 12:19:40,258 - INFO - Spur 31: 4.223200 GHz, -116.78 dBm
2025-07-02 12:19:40,259 - INFO - Spur 32: 4.248900 GHz, -116.89 dBm
2025-07-02 12:19:40,259 - INFO - Spur 33: 4.283800 GHz, -117.06 dBm
2025-07-02 12:19:40,259 - INFO - Spur 34: 4.307700 GHz, -116.55 dBm
2025-07-02 12:19:40,259 - INFO - Spur 35: 4.381200 GHz, -117.59 dBm
2025-07-02 12:19:40,259 - INFO - Spur 36: 4.390300 GHz, -117.29 dBm
2025-07-02 12:19:40,259 - INFO - Spur 37: 4.414200 GHz, -116.73 dBm
2025-07-02 12:19:40,259 - INFO - Spur 38: 4.438100 GHz, -116.79 dBm
2025-07-02 12:19:40,259 - INFO - Spur 39: 4.460100 GHz, -117.91 dBm
2025-07-02 12:19:40,259 - INFO - Spur 40: 4.476700 GHz, -117.79 dBm
2025-07-02 12:19:40,259 - INFO - Spur 41: 4.487700 GHz, -116.65 dBm
2025-07-02 12:19:40,259 - INFO - Spur 42: 4.509700 GHz, -116.98 dBm
2025-07-02 12:19:40,259 - INFO - Spur 43: 4.540900 GHz, -116.15 dBm
2025-07-02 12:19:40,259 - INFO - Spur 44: 4.574000 GHz, -116.93 dBm
2025-07-02 12:19:40,260 - INFO - Spur 45: 4.627300 GHz, -117.91 dBm
2025-07-02 12:19:40,260 - INFO - Spur 46: 4.660300 GHz, -117.58 dBm
2025-07-02 12:19:40,260 - INFO - Spur 47: 4.774200 GHz, -117.82 dBm
2025-07-02 12:19:40,260 - INFO - Spur 48: 4.798100 GHz, -116.88 dBm
2025-07-02 12:19:40,260 - INFO - Spur 49: 4.840300 GHz, -117.23 dBm
2025-07-02 12:19:40,260 - INFO - Spur 50: 4.880700 GHz, -117.13 dBm
2025-07-02 12:19:40,260 - INFO - Socket closed
2025-07-02 12:19:40,260 - INFO - FSW connection closed
2025-07-02 12:19:40,260 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:19:40,261 - INFO - Socket closed
2025-07-02 12:19:40,261 - INFO - VSG connection closed
2025-07-02 12:19:40,266 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:19:40,527 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:19:40,570 - INFO - Socket closed
2025-07-02 12:19:40,571 - INFO - Socket closed
2025-07-02 12:23:18,113 - INFO - Starting RF measurement script
2025-07-02 12:23:18,117 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:23:18,118 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.05,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:23:18,119 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.05, 'spur_limit_dbm': -95}
2025-07-02 12:23:18,124 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:23:18,125 - INFO - Query: *IDN?
2025-07-02 12:23:18,133 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:23:18,137 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:23:18,138 - INFO - Query: *IDN?
2025-07-02 12:23:18,139 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:23:18,139 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.05 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:23:18,139 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.050 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:23:18,140 - INFO - Query: *RST;*OPC?
2025-07-02 12:23:19,193 - INFO - Response: 1
2025-07-02 12:23:19,194 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:23:19,195 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:23:19,196 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:23:19,196 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:23:19,197 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:23:19,197 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:23:19,198 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:23:19,198 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:23:19,199 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:23:19,199 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:23:19,200 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:23:19,200 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:23:19,200 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:23:19,202 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:23:19,202 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:23:19,203 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:23:19,203 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:23:22,022 - INFO - Response: 1
2025-07-02 12:23:22,023 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:23:22,024 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:23:22,025 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:27:53,411 - INFO - Starting RF measurement script
2025-07-02 12:27:53,413 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:27:53,414 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:27:53,414 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.02, 'spur_limit_dbm': -95}
2025-07-02 12:27:53,419 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:27:53,419 - INFO - Query: *IDN?
2025-07-02 12:27:53,423 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:27:53,426 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:27:53,426 - INFO - Query: *IDN?
2025-07-02 12:27:53,427 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:27:53,427 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.02 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:27:53,427 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.020 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:27:53,427 - INFO - Query: *RST;*OPC?
2025-07-02 12:27:54,472 - INFO - Response: 1
2025-07-02 12:27:54,472 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:27:54,473 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:27:54,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:27:54,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:27:54,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:27:54,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:27:54,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:27:54,474 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:27:54,475 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:27:54,475 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:27:54,475 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:27:54,475 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:27:54,476 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:27:54,476 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:27:54,476 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:27:54,476 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:27:54,476 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:27:57,576 - INFO - Response: 1
2025-07-02 12:27:57,577 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:27:57,577 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:27:57,578 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:27:57,578 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:27:57,579 - INFO - Query: *RST;*OPC?
2025-07-02 12:27:57,767 - INFO - Response: 1
2025-07-02 12:27:57,767 - INFO - FSW reset for spur search
2025-07-02 12:27:57,767 - INFO - Write: INIT:CONT OFF
2025-07-02 12:27:57,768 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:27:57,768 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:27:57,768 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:27:57,768 - INFO - Write: :SENS:AVER:COUN 10
2025-07-02 12:27:57,769 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:27:57,769 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:27:57,769 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 12:27:57,769 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:27:57,769 - INFO - Write: SENS:SWE:TYPE AUTO
2025-07-02 12:27:57,770 - INFO - Write: SENS:SWE:OPT AUTO
2025-07-02 12:27:57,770 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:27:57,770 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:27:57,770 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:27:57,770 - INFO - Write: :INP:ATT 0
2025-07-02 12:27:57,770 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:27:57,771 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:27:57,771 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:27:57,771 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:27:57,771 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:27:57,771 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:27:57,771 - INFO - Write: CALC1:THR -122
2025-07-02 12:27:57,771 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:27:57,772 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:27:57,772 - INFO - Spur detection table configured
2025-07-02 12:27:57,772 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:27:57,772 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:27:57,772 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:28:17,762 - INFO - Socket closed
2025-07-02 12:28:17,772 - INFO - Socket closed
2025-07-02 12:30:20,632 - INFO - Starting RF measurement script
2025-07-02 12:30:20,635 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:30:20,635 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:30:20,636 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.02, 'spur_limit_dbm': -95}
2025-07-02 12:30:20,640 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:30:20,640 - INFO - Query: *IDN?
2025-07-02 12:30:20,649 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:30:20,652 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:30:20,653 - INFO - Query: *IDN?
2025-07-02 12:30:20,653 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:30:20,654 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.02 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:30:20,654 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.020 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:30:20,654 - INFO - Query: *RST;*OPC?
2025-07-02 12:30:21,707 - INFO - Response: 1
2025-07-02 12:30:21,707 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:30:21,707 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:30:21,707 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:30:21,707 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:30:21,708 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:30:21,708 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:30:24,538 - INFO - Response: 1
2025-07-02 12:30:24,538 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:30:24,538 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:30:24,539 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:30:24,539 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:30:24,539 - INFO - Query: *RST;*OPC?
2025-07-02 12:30:24,725 - INFO - Response: 1
2025-07-02 12:30:24,725 - INFO - FSW reset for spur search
2025-07-02 12:30:24,725 - INFO - Write: INIT:CONT OFF
2025-07-02 12:30:24,726 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:30:24,726 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:30:24,726 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:30:24,726 - INFO - Write: :SENS:AVER:COUN 10
2025-07-02 12:30:24,726 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:30:24,726 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:30:24,726 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 12:30:24,726 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:30:24,726 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 12:30:24,726 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 12:30:24,727 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:30:24,727 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:30:24,727 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:30:24,727 - INFO - Write: :INP:ATT 0
2025-07-02 12:30:24,727 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:30:24,727 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:30:24,727 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:30:24,727 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:30:24,727 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:30:24,727 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:30:24,727 - INFO - Write: CALC1:THR -122
2025-07-02 12:30:24,727 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:30:24,728 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:30:24,728 - INFO - Spur detection table configured
2025-07-02 12:30:24,728 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:30:24,728 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:30:24,728 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:30:33,370 - INFO - Response: 1
2025-07-02 12:30:33,371 - INFO - Spur search measurement completed
2025-07-02 12:30:33,371 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:30:33,373 - INFO - Response: 4
2025-07-02 12:30:33,373 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:30:33,373 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:30:33,429 - INFO - Response: 1450000000,1949500000,3049600000,3450000000
2025-07-02 12:30:33,429 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:30:33,430 - INFO - Response: -116.097442627,-91.5925979614,-96.7169799805,-120.632362366
2025-07-02 12:30:33,431 - INFO - Spur 1: 1.450000 GHz, -116.10 dBm
2025-07-02 12:30:33,431 - INFO - Spur 2: 1.949500 GHz, -91.59 dBm
2025-07-02 12:30:33,431 - INFO - Spur 3: 3.049600 GHz, -96.72 dBm
2025-07-02 12:30:33,431 - INFO - Spur 4: 3.450000 GHz, -120.63 dBm
2025-07-02 12:30:33,431 - INFO - Socket closed
2025-07-02 12:30:33,432 - INFO - FSW connection closed
2025-07-02 12:30:33,432 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:30:33,432 - INFO - Socket closed
2025-07-02 12:30:33,432 - INFO - VSG connection closed
2025-07-02 12:30:33,436 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:30:33,699 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:30:33,746 - INFO - Socket closed
2025-07-02 12:30:33,747 - INFO - Socket closed
2025-07-02 12:30:53,060 - INFO - Starting RF measurement script
2025-07-02 12:30:53,061 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:30:53,062 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.45,
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -95
    }
  ]
}
2025-07-02 12:30:53,062 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.45, 'rbw_mhz': 0.02, 'spur_limit_dbm': -95}
2025-07-02 12:30:53,066 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:30:53,066 - INFO - Query: *IDN?
2025-07-02 12:30:53,067 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:30:53,070 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:30:53,070 - INFO - Query: *IDN?
2025-07-02 12:30:53,071 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:30:53,071 - INFO - SpurSearch initialized: fundamental=2.45 GHz, RBW=0.02 MHz, spur_limit=-95 dBm, VSG_power=0 dBm
2025-07-02 12:30:53,071 - INFO - Starting SpurSearch test set 1: fundamental=2.450 GHz, RBW=0.020 MHz, limit=-95.00 dBm, power=-70.00 dBm
2025-07-02 12:30:53,071 - INFO - Query: *RST;*OPC?
2025-07-02 12:30:54,128 - INFO - Response: 1
2025-07-02 12:30:54,128 - INFO - Write: SOUR:FREQ:CW 2450000000
2025-07-02 12:30:54,129 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:30:54,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:30:54,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:30:54,130 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:30:56,972 - INFO - Response: 1
2025-07-02 12:30:56,972 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:30:56,972 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:30:56,973 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:30:56,973 - INFO - VSG set: frequency=2.450 GHz, power=-70.00 dBm
2025-07-02 12:30:56,973 - INFO - Query: *RST;*OPC?
2025-07-02 12:30:57,161 - INFO - Response: 1
2025-07-02 12:30:57,161 - INFO - FSW reset for spur search
2025-07-02 12:30:57,161 - INFO - Write: INIT:CONT OFF
2025-07-02 12:30:57,161 - INFO - Write: SENS:FREQ:STAR 1225000000
2025-07-02 12:30:57,162 - INFO - Write: SENS:FREQ:STOP 4900000000
2025-07-02 12:30:57,162 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:30:57,162 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 12:30:57,162 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:30:57,162 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:30:57,162 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 12:30:57,162 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:30:57,162 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 12:30:57,162 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 12:30:57,163 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:30:57,163 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:30:57,163 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:30:57,163 - INFO - Write: :INP:ATT 0
2025-07-02 12:30:57,163 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:30:57,163 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:30:57,163 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:30:57,163 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:30:57,163 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1225000000
2025-07-02 12:30:57,164 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4900000000
2025-07-02 12:30:57,164 - INFO - Write: CALC1:THR -122
2025-07-02 12:30:57,164 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:30:57,164 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:30:57,164 - INFO - Spur detection table configured
2025-07-02 12:30:57,164 - INFO - Range 1: 1.2252.449 GHz
2025-07-02 12:30:57,164 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:30:57,164 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:31:01,609 - INFO - Response: 1
2025-07-02 12:31:01,609 - INFO - Spur search measurement completed
2025-07-02 12:31:01,609 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:31:01,611 - INFO - Response: 4
2025-07-02 12:31:01,611 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:31:01,611 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:31:01,657 - INFO - Response: 1450000000,1949500000,3049600000,3450000000
2025-07-02 12:31:01,657 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:31:01,658 - INFO - Response: -115.855308533,-91.5913543701,-96.700881958,-120.195068359
2025-07-02 12:31:01,659 - INFO - Spur 1: 1.450000 GHz, -115.86 dBm
2025-07-02 12:31:01,659 - INFO - Spur 2: 1.949500 GHz, -91.59 dBm
2025-07-02 12:31:01,659 - INFO - Spur 3: 3.049600 GHz, -96.70 dBm
2025-07-02 12:31:01,659 - INFO - Spur 4: 3.450000 GHz, -120.20 dBm
2025-07-02 12:31:01,660 - INFO - Socket closed
2025-07-02 12:31:01,660 - INFO - FSW connection closed
2025-07-02 12:31:01,660 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:31:01,660 - INFO - Socket closed
2025-07-02 12:31:01,660 - INFO - VSG connection closed
2025-07-02 12:31:01,664 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:31:01,910 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:31:01,954 - INFO - Socket closed
2025-07-02 12:31:01,956 - INFO - Socket closed
2025-07-02 12:39:33,740 - INFO - Starting RF measurement script
2025-07-02 12:39:33,741 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:39:33,741 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.45,
        2.47
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:39:33,742 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.45, 2.47], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:39:33,742 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:39:33,747 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:39:33,747 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:39:34,011 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:39:41,947 - INFO - Starting RF measurement script
2025-07-02 12:39:41,949 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:39:41,950 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.45,
        2.47
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:39:41,950 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.45, 2.47], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:39:41,950 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:39:41,954 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:39:41,954 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:39:42,221 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:40:46,417 - INFO - Starting RF measurement script
2025-07-02 12:40:46,421 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:40:46,421 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.45,
        2.47
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:40:46,421 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.45, 2.47], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:40:46,421 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:40:46,424 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:40:46,424 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:40:46,692 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:41:28,583 - INFO - Starting RF measurement script
2025-07-02 12:41:28,587 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:41:28,588 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.45,
        2.47
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:41:28,588 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.45, 2.47], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:41:28,588 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:41:28,591 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:41:28,591 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:41:28,846 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:42:07,378 - INFO - Starting RF measurement script
2025-07-02 12:42:07,381 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:42:07,382 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:42:07,382 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:42:07,382 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:42:07,385 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:42:07,385 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:42:07,660 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:42:28,304 - INFO - Starting RF measurement script
2025-07-02 12:42:28,306 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:42:28,306 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.43,
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:42:28,307 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.43, 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:42:28,311 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:42:28,311 - INFO - Query: *IDN?
2025-07-02 12:42:28,313 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:42:28,315 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:42:28,315 - INFO - Query: *IDN?
2025-07-02 12:42:28,316 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:42:28,316 - INFO - SpurSearch initialized: fundamental=2.43 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 12:42:28,316 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 12:42:28,316 - INFO - Query: *RST;*OPC?
2025-07-02 12:42:29,365 - INFO - Response: 1
2025-07-02 12:42:29,366 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 12:42:29,366 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:42:29,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:42:29,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:42:29,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:42:29,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:42:29,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:42:29,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:42:29,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:42:29,367 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:42:32,167 - INFO - Response: 1
2025-07-02 12:42:32,167 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:42:32,168 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:42:32,168 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:42:32,169 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 12:42:32,170 - INFO - Query: *RST;*OPC?
2025-07-02 12:42:32,374 - INFO - Response: 1
2025-07-02 12:42:32,374 - INFO - FSW reset for spur search
2025-07-02 12:42:32,374 - INFO - Write: INIT:CONT OFF
2025-07-02 12:42:32,375 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 12:42:32,375 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 12:42:32,375 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:42:32,375 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 12:42:32,376 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:42:32,376 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:42:32,376 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 12:42:32,376 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:42:32,377 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 12:42:32,377 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 12:42:32,377 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:42:32,378 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:42:32,378 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:42:32,378 - INFO - Write: :INP:ATT 0   
2025-07-02 12:42:32,378 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:42:32,378 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:42:32,378 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:42:32,379 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:42:32,379 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 12:42:32,379 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 12:42:32,379 - INFO - Write: CALC1:THR -122
2025-07-02 12:42:32,379 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:42:32,379 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:42:32,380 - INFO - Spur detection table configured
2025-07-02 12:42:32,380 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 12:42:32,380 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:42:32,380 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:42:36,880 - INFO - Response: 1
2025-07-02 12:42:36,880 - INFO - Spur search measurement completed
2025-07-02 12:42:36,880 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:42:36,882 - INFO - Response: 6
2025-07-02 12:42:36,882 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:42:36,882 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:42:36,937 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3542100000,4002900000
2025-07-02 12:42:36,937 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:42:36,938 - INFO - Response: -115.923599243,-91.5614776611,-96.7278747559,-119.967002869,-120.713722229,-121.657905579
2025-07-02 12:42:36,939 - INFO - Spur 1: 1.430900 GHz, -115.92 dBm
2025-07-02 12:42:36,939 - INFO - Spur 2: 1.930000 GHz, -91.56 dBm
2025-07-02 12:42:36,939 - INFO - Spur 3: 3.030200 GHz, -96.73 dBm
2025-07-02 12:42:36,939 - INFO - Spur 4: 3.429100 GHz, -119.97 dBm
2025-07-02 12:42:36,939 - INFO - Spur 5: 3.542100 GHz, -120.71 dBm
2025-07-02 12:42:36,939 - INFO - Spur 6: 4.002900 GHz, -121.66 dBm
2025-07-02 12:42:36,939 - INFO - Socket closed
2025-07-02 12:42:36,939 - INFO - FSW connection closed
2025-07-02 12:42:36,939 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:42:36,940 - INFO - Socket closed
2025-07-02 12:42:36,940 - INFO - VSG connection closed
2025-07-02 12:42:36,943 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:42:37,180 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:42:37,217 - INFO - Socket closed
2025-07-02 12:42:37,218 - INFO - Socket closed
2025-07-02 12:44:05,304 - INFO - Starting RF measurement script
2025-07-02 12:44:05,306 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:44:05,306 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:44:05,306 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:44:05,306 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:44:05,310 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:44:05,310 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:44:05,596 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:52:42,216 - INFO - Starting RF measurement script
2025-07-02 12:52:42,220 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:52:42,220 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:52:42,220 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:52:42,225 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:52:42,226 - INFO - Query: *IDN?
2025-07-02 12:52:42,227 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:52:42,229 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:52:42,229 - INFO - Query: *IDN?
2025-07-02 12:52:42,230 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:52:42,230 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 12:52:42,230 - ERROR - SpurSearch test set 1 failed: unsupported format string passed to list.__format__
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 499, in <module>
    print(f"SpurSearch Fundamental: {test['fundamental_frequency_ghz']:.3f} GHz")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to list.__format__
2025-07-02 12:52:42,234 - INFO - Socket closed
2025-07-02 12:52:42,234 - INFO - FSW connection closed
2025-07-02 12:52:42,234 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:52:42,235 - INFO - Socket closed
2025-07-02 12:52:42,235 - INFO - VSG connection closed
2025-07-02 12:52:42,237 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:52:42,237 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:52:42,569 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:52:42,628 - INFO - Socket closed
2025-07-02 12:52:42,630 - INFO - Socket closed
2025-07-02 12:53:26,537 - INFO - Starting RF measurement script
2025-07-02 12:53:26,539 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:53:26,539 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:53:26,540 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:53:26,540 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 12:53:26,542 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:53:26,542 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:53:26,805 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:53:47,730 - INFO - Starting RF measurement script
2025-07-02 12:53:47,733 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:53:47,733 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": 2.43,
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:53:47,733 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': 2.43, 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:53:47,737 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:53:47,738 - INFO - Query: *IDN?
2025-07-02 12:53:47,739 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:53:47,742 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:53:47,742 - INFO - Query: *IDN?
2025-07-02 12:53:47,742 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:53:47,743 - INFO - SpurSearch initialized: fundamental=2.43 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 12:53:47,743 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 12:53:47,743 - INFO - Query: *RST;*OPC?
2025-07-02 12:53:48,785 - INFO - Response: 1
2025-07-02 12:53:48,785 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 12:53:48,786 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 12:53:48,786 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 12:53:48,786 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 12:53:48,786 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 12:53:48,786 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 12:53:48,786 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 12:53:48,786 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 12:53:48,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 12:53:48,788 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 12:53:51,884 - INFO - Response: 1
2025-07-02 12:53:51,884 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 12:53:51,885 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 12:53:51,885 - INFO - Write: OUTPut1:STATe 1
2025-07-02 12:53:51,885 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 12:53:51,885 - INFO - Query: *RST;*OPC?
2025-07-02 12:53:52,101 - INFO - Response: 1
2025-07-02 12:53:52,101 - INFO - FSW reset for spur search
2025-07-02 12:53:52,102 - INFO - Write: INIT:CONT OFF
2025-07-02 12:53:52,102 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 12:53:52,102 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 12:53:52,102 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 12:53:52,103 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 12:53:52,103 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 12:53:52,103 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 12:53:52,103 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 12:53:52,103 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 12:53:52,103 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 12:53:52,104 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 12:53:52,104 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 12:53:52,104 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 12:53:52,104 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 12:53:52,105 - INFO - Write: :INP:ATT 0   
2025-07-02 12:53:52,105 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 12:53:52,105 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 12:53:52,105 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 12:53:52,106 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 12:53:52,106 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 12:53:52,106 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 12:53:52,106 - INFO - Write: CALC1:THR -122
2025-07-02 12:53:52,106 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 12:53:52,106 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 12:53:52,106 - INFO - Spur detection table configured
2025-07-02 12:53:52,106 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 12:53:52,106 - INFO - Write: :INIT:CONT OFF
2025-07-02 12:53:52,106 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 12:53:56,522 - INFO - Response: 1
2025-07-02 12:53:56,523 - INFO - Spur search measurement completed
2025-07-02 12:53:56,523 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 12:53:56,524 - INFO - Response: 5
2025-07-02 12:53:56,525 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 12:53:56,525 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 12:53:56,569 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3999300000
2025-07-02 12:53:56,570 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 12:53:56,571 - INFO - Response: -115.866394043,-91.5701446533,-96.6816329956,-119.715171814,-121.429405212
2025-07-02 12:53:56,572 - INFO - Spur 1: 1.430900 GHz, -115.87 dBm
2025-07-02 12:53:56,572 - INFO - Spur 2: 1.930000 GHz, -91.57 dBm
2025-07-02 12:53:56,572 - INFO - Spur 3: 3.030200 GHz, -96.68 dBm
2025-07-02 12:53:56,572 - INFO - Spur 4: 3.429100 GHz, -119.72 dBm
2025-07-02 12:53:56,572 - INFO - Spur 5: 3.999300 GHz, -121.43 dBm
2025-07-02 12:53:56,573 - INFO - Socket closed
2025-07-02 12:53:56,573 - INFO - FSW connection closed
2025-07-02 12:53:56,573 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:53:56,573 - INFO - Socket closed
2025-07-02 12:53:56,573 - INFO - VSG connection closed
2025-07-02 12:53:56,576 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:53:56,850 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:53:56,892 - INFO - Socket closed
2025-07-02 12:53:56,894 - INFO - Socket closed
2025-07-02 12:56:30,825 - INFO - Starting RF measurement script
2025-07-02 12:56:30,829 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 12:56:30,829 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 12:56:30,829 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 12:56:30,834 - INFO - Connected to 192.168.200.20:5025
2025-07-02 12:56:30,834 - INFO - Query: *IDN?
2025-07-02 12:56:30,835 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 12:56:30,838 - INFO - Connected to 192.168.200.10:5025
2025-07-02 12:56:30,838 - INFO - Query: *IDN?
2025-07-02 12:56:30,838 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 12:56:30,838 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 12:56:30,838 - ERROR - SpurSearch test set 1 failed: unsupported format string passed to list.__format__
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 499, in <module>
    print(f"SpurSearch Fundamental: {test['fundamental_frequency_ghz']:.3f} GHz")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to list.__format__
2025-07-02 12:56:30,840 - INFO - Socket closed
2025-07-02 12:56:30,840 - INFO - FSW connection closed
2025-07-02 12:56:30,840 - INFO - Write: OUTP:STAT OFF
2025-07-02 12:56:30,840 - INFO - Socket closed
2025-07-02 12:56:30,840 - INFO - VSG connection closed
2025-07-02 12:56:30,841 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 12:56:30,842 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 12:56:31,108 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 12:56:31,168 - INFO - Socket closed
2025-07-02 12:56:31,170 - INFO - Socket closed
2025-07-02 13:03:44,139 - INFO - Starting RF measurement script
2025-07-02 13:03:44,143 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 13:03:44,143 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 13:03:44,143 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 13:03:44,148 - INFO - Connected to 192.168.200.20:5025
2025-07-02 13:03:44,148 - INFO - Query: *IDN?
2025-07-02 13:03:44,149 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 13:03:44,152 - INFO - Connected to 192.168.200.10:5025
2025-07-02 13:03:44,152 - INFO - Query: *IDN?
2025-07-02 13:03:44,153 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 13:03:44,153 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 13:03:44,153 - ERROR - SpurSearch test set 1 failed: unsupported format string passed to list.__format__
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 499, in <module>
    print(f"SpurSearch Fundamental: {test['fundamental_frequency_ghz']:.3f} GHz")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to list.__format__
2025-07-02 13:03:44,155 - INFO - Socket closed
2025-07-02 13:03:44,155 - INFO - FSW connection closed
2025-07-02 13:03:44,155 - INFO - Write: OUTP:STAT OFF
2025-07-02 13:03:44,155 - INFO - Socket closed
2025-07-02 13:03:44,155 - INFO - VSG connection closed
2025-07-02 13:03:44,157 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 13:03:44,158 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 13:03:44,419 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 13:03:44,472 - INFO - Socket closed
2025-07-02 13:03:44,473 - INFO - Socket closed
2025-07-02 13:09:45,168 - INFO - Starting RF measurement script
2025-07-02 13:09:45,170 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 13:09:45,170 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 13:09:45,170 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 13:09:45,174 - INFO - Connected to 192.168.200.20:5025
2025-07-02 13:09:45,174 - INFO - Query: *IDN?
2025-07-02 13:09:45,176 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 13:09:45,177 - INFO - Connected to 192.168.200.10:5025
2025-07-02 13:09:45,178 - INFO - Query: *IDN?
2025-07-02 13:09:45,178 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 13:09:45,178 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 13:09:45,178 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 13:09:45,178 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 13:09:45,178 - INFO - Query: *RST;*OPC?
2025-07-02 13:09:46,223 - INFO - Response: 1
2025-07-02 13:09:46,223 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 13:09:46,224 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:09:46,224 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:09:46,224 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:09:46,224 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:09:46,225 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:09:46,225 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:09:46,225 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:09:46,225 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:09:46,225 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:09:46,226 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:09:46,226 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:09:46,226 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:09:46,226 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:09:46,227 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:09:46,227 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:09:46,227 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:09:49,040 - INFO - Response: 1
2025-07-02 13:09:49,041 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:09:49,041 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:09:49,041 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:09:49,041 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 13:09:49,041 - INFO - Query: *RST;*OPC?
2025-07-02 13:09:49,229 - INFO - Response: 1
2025-07-02 13:09:49,229 - INFO - FSW reset for spur search
2025-07-02 13:09:49,229 - INFO - Write: INIT:CONT OFF
2025-07-02 13:09:49,229 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 13:09:49,230 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 13:09:49,230 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:09:49,230 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:09:49,230 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:09:49,230 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:09:49,230 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:09:49,230 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:09:49,230 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:09:49,231 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:09:49,231 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:09:49,231 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:09:49,231 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:09:49,231 - INFO - Write: :INP:ATT 0
2025-07-02 13:09:49,231 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:09:49,231 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:09:49,231 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:09:49,231 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:09:49,232 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 13:09:49,232 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 13:09:49,232 - INFO - Write: CALC1:THR -122
2025-07-02 13:09:49,232 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:09:49,232 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:09:49,232 - INFO - Spur detection table configured
2025-07-02 13:09:49,232 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 13:09:49,232 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:09:49,232 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:09:53,720 - INFO - Response: 1
2025-07-02 13:09:53,721 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 13:09:53,721 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:09:53,722 - INFO - Response: 50
2025-07-02 13:09:53,722 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:09:53,723 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:09:53,775 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 13:09:53,776 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:09:53,777 - INFO - Response: -70.2797851562,-54.9442253113,-69.7753982544,-68.1350250244,-47.9006156921,-85.0769958496,-81.963394165,-62.7735366821,-85.639503479,-76.2447738647,-81.2294235229,-83.3999786377,-71.0547332764,-77.1508636475,-36.3442878723,-77.4072952271,-67.4777755737,-70.6374359131,-73.9373703003,-70.8445663452,-77.7062301636,-71.365234375,-83.0964050293,-81.4597549438,-82.7910003662,-51.9537620544,-72.8477172852,-77.5302352905,-81.3672180176,-79.3163604736,-40.5030899048,-68.3316345215,-84.6575088501,-66.6850357056,-82.7427978516,-76.5394668579,-50.9912490845,-54.65599823,-85.0929641724,-80.1547851562,-68.8591842651,-84.6242294312,-65.5506744385,-69.609954834,-57.2434272766,-77.2458572388,-81.1075744629,-86.4206848145,-82.6545181274,-48.5490875244
2025-07-02 13:09:53,778 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 13:09:53,778 - INFO - Query: *RST;*OPC?
2025-07-02 13:09:54,830 - INFO - Response: 1
2025-07-02 13:09:54,830 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 13:09:54,830 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:09:54,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:09:54,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:09:54,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:09:54,831 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:09:54,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:09:54,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:09:54,832 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:09:54,832 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:09:57,691 - INFO - Response: 1
2025-07-02 13:09:57,691 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:09:57,691 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:09:57,691 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:09:57,691 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 13:09:57,691 - INFO - Query: *RST;*OPC?
2025-07-02 13:09:57,874 - INFO - Response: 1
2025-07-02 13:09:57,874 - INFO - FSW reset for spur search
2025-07-02 13:09:57,874 - INFO - Write: INIT:CONT OFF
2025-07-02 13:09:57,874 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 13:09:57,874 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 13:09:57,874 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:09:57,874 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:09:57,874 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:09:57,874 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:09:57,874 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:09:57,874 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:09:57,875 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:09:57,875 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:09:57,875 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:09:57,875 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:09:57,875 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:09:57,875 - INFO - Write: :INP:ATT 0
2025-07-02 13:09:57,875 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:09:57,875 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:09:57,875 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:09:57,875 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:09:57,875 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 13:09:57,875 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 13:09:57,875 - INFO - Write: CALC1:THR -122
2025-07-02 13:09:57,875 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:09:57,875 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:09:57,875 - INFO - Spur detection table configured
2025-07-02 13:09:57,875 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 13:09:57,875 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:09:57,875 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:10:02,371 - INFO - Response: 1
2025-07-02 13:10:02,371 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 13:10:02,371 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:10:02,373 - INFO - Response: 50
2025-07-02 13:10:02,373 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:10:02,373 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:10:02,422 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4319400000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 13:10:02,422 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:10:02,423 - INFO - Response: -70.8210754395,-54.6796073914,-70.0105895996,-87.3960494995,-68.3383712769,-48.0750160217,-83.7279129028,-82.3847122192,-62.8083953857,-86.7263336182,-75.5982055664,-81.1338424683,-86.8389282227,-82.8859634399,-70.7162094116,-84.5210342407,-36.4364128113,-74.2738265991,-76.9525299072,-66.6686477661,-66.2413406372,-71.336265564,-52.2202072144,-78.4862289429,-71.4023666382,-82.9900283813,-82.9196853638,-47.2707633972,-70.2659912109,-44.540512085,-69.1640930176,-82.7658615112,-66.0336990356,-83.9371261597,-80.5237731934,-86.4694442749,-50.3786697388,-55.0328598022,-80.6032028198,-67.0769500732,-86.9032974243,-65.4088745117,-69.0092163086,-57.6555366516,-87.3825759888,-77.2212219238,-80.9758300781,-86.8503799438,-84.6287155151,-49.4144287109
2025-07-02 13:10:02,423 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 13:10:02,424 - INFO - Query: *RST;*OPC?
2025-07-02 13:10:03,471 - INFO - Response: 1
2025-07-02 13:10:03,471 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 13:10:03,471 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:10:03,471 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:10:03,471 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:10:03,471 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:10:03,472 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:10:03,472 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:10:03,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:10:03,473 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:10:03,473 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:10:06,285 - INFO - Response: 1
2025-07-02 13:10:06,285 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:10:06,285 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:10:06,285 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:10:06,285 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 13:10:06,285 - INFO - Query: *RST;*OPC?
2025-07-02 13:10:06,474 - INFO - Response: 1
2025-07-02 13:10:06,474 - INFO - FSW reset for spur search
2025-07-02 13:10:06,474 - INFO - Write: INIT:CONT OFF
2025-07-02 13:10:06,474 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 13:10:06,474 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 13:10:06,475 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:10:06,475 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:10:06,475 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:10:06,475 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:10:06,475 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:10:06,475 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:10:06,476 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:10:06,476 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:10:06,476 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:10:06,476 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:10:06,476 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:10:06,476 - INFO - Write: :INP:ATT 0
2025-07-02 13:10:06,476 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:10:06,477 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:10:06,477 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:10:06,477 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:10:06,477 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 13:10:06,477 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 13:10:06,477 - INFO - Write: CALC1:THR -122
2025-07-02 13:10:06,477 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:10:06,477 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:10:06,477 - INFO - Spur detection table configured
2025-07-02 13:10:06,478 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 13:10:06,478 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:10:06,478 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:10:10,960 - INFO - Response: 1
2025-07-02 13:10:10,960 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 13:10:10,960 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:10:10,961 - INFO - Response: 50
2025-07-02 13:10:10,961 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:10:10,962 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:10:11,015 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 13:10:11,015 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:10:11,016 - INFO - Response: -69.9853210449,-54.9886665344,-69.6473846436,-68.0361328125,-47.9162521362,-85.1912689209,-81.8468170166,-62.7159461975,-85.4903259277,-76.1589050293,-81.2719268799,-83.5828170776,-71.0292434692,-77.2858047485,-36.3475112915,-77.4275665283,-67.5002822876,-70.6473693848,-73.5219421387,-70.8046188354,-77.5625839233,-71.3058395386,-83.2010650635,-81.4841384888,-82.6818313599,-51.9511947632,-72.741355896,-77.4940338135,-81.4494400024,-79.3581161499,-40.5036125183,-68.2322311401,-85.3313446045,-66.6211776733,-82.7175750732,-76.296913147,-50.9596672058,-54.6251335144,-85.0165481567,-79.7413253784,-68.8226318359,-84.5358200073,-65.5492401123,-69.4838027954,-57.1784591675,-76.966545105,-81.0708770752,-86.5826873779,-82.6571350098,-48.5393180847
2025-07-02 13:10:11,016 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 13:10:11,016 - INFO - Query: *RST;*OPC?
2025-07-02 13:10:12,068 - INFO - Response: 1
2025-07-02 13:10:12,069 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 13:10:12,069 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:10:12,069 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:10:12,069 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:10:12,069 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:10:12,069 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:10:12,069 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:10:12,070 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:10:12,070 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:10:12,070 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:10:12,070 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:10:12,070 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:10:12,071 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:10:12,071 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:10:12,071 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:10:12,071 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:10:12,071 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:10:14,928 - INFO - Response: 1
2025-07-02 13:10:14,928 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:10:14,928 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:10:14,928 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:10:14,929 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 13:10:14,929 - INFO - Query: *RST;*OPC?
2025-07-02 13:10:15,117 - INFO - Response: 1
2025-07-02 13:10:15,117 - INFO - FSW reset for spur search
2025-07-02 13:10:15,117 - INFO - Write: INIT:CONT OFF
2025-07-02 13:10:15,118 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 13:10:15,118 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 13:10:15,118 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:10:15,118 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:10:15,118 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:10:15,118 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:10:15,118 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:10:15,119 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:10:15,119 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:10:15,119 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:10:15,119 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:10:15,119 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:10:15,119 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:10:15,119 - INFO - Write: :INP:ATT 0
2025-07-02 13:10:15,119 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:10:15,119 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:10:15,119 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:10:15,119 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:10:15,120 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 13:10:15,120 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 13:10:15,120 - INFO - Write: CALC1:THR -122
2025-07-02 13:10:15,120 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:10:15,120 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:10:15,120 - INFO - Spur detection table configured
2025-07-02 13:10:15,120 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 13:10:15,120 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:10:15,120 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:10:19,610 - INFO - Response: 1
2025-07-02 13:10:19,610 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 13:10:19,611 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:10:19,612 - INFO - Response: 50
2025-07-02 13:10:19,612 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:10:19,612 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:10:19,661 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2435400000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 13:10:19,662 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:10:19,663 - INFO - Response: -70.9872894287,-54.6615600586,-70.0664749146,-68.3838119507,-48.042175293,-83.7375793457,-82.3541564941,-62.8361244202,-86.947303772,-75.5464172363,-81.0231781006,-86.400970459,-82.3580169678,-71.3967666626,-81.6353988647,-86.0904693604,-36.3176612854,-73.8009414673,-77.2938537598,-66.366104126,-66.6316757202,-86.8459777832,-70.7493209839,-51.8911437988,-78.4416351318,-71.4164657593,-82.9033355713,-82.4542770386,-47.2827949524,-70.4676361084,-44.5419883728,-69.1461105347,-82.5971908569,-66.1746444702,-83.9360122681,-80.4760818481,-86.6111450195,-50.3436546326,-55.0512466431,-80.770362854,-66.9966201782,-87.0062408447,-65.4614334106,-68.9979705811,-57.6210975647,-77.1893463135,-80.915435791,-86.8764038086,-84.5869369507,-49.4382858276
2025-07-02 13:10:19,663 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 13:10:19,670 - INFO - Socket closed
2025-07-02 13:10:19,670 - INFO - FSW connection closed
2025-07-02 13:10:19,670 - INFO - Write: OUTP:STAT OFF
2025-07-02 13:10:19,670 - INFO - Socket closed
2025-07-02 13:10:19,671 - INFO - VSG connection closed
2025-07-02 13:10:19,672 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 13:10:19,707 - INFO - Socket closed
2025-07-02 13:10:19,716 - INFO - Socket closed
2025-07-02 13:24:18,819 - INFO - Starting RF measurement script
2025-07-02 13:24:18,822 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 13:24:18,822 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 13:24:18,822 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 13:24:18,827 - INFO - Connected to 192.168.200.20:5025
2025-07-02 13:24:18,827 - INFO - Query: *IDN?
2025-07-02 13:24:18,828 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 13:24:18,831 - INFO - Connected to 192.168.200.10:5025
2025-07-02 13:24:18,831 - INFO - Query: *IDN?
2025-07-02 13:24:18,832 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 13:24:18,832 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 13:24:18,832 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 13:24:18,832 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 13:24:18,832 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:19,881 - INFO - Response: 1
2025-07-02 13:24:19,881 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 13:24:19,881 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:24:19,882 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:24:19,882 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:24:19,882 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:24:19,883 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:24:19,883 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:24:19,883 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:24:19,883 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:24:19,883 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:24:19,883 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:24:19,884 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:24:19,884 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:24:19,884 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:24:19,885 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:24:19,885 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:24:19,885 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:24:22,693 - INFO - Response: 1
2025-07-02 13:24:22,693 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:24:22,694 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:24:22,694 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:24:22,694 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 13:24:22,694 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:22,884 - INFO - Response: 1
2025-07-02 13:24:22,884 - INFO - FSW reset for spur search
2025-07-02 13:24:22,885 - INFO - Write: INIT:CONT OFF
2025-07-02 13:24:22,885 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 13:24:22,885 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 13:24:22,886 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:24:22,886 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:24:22,886 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:24:22,886 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:24:22,886 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:24:22,887 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:24:22,887 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:24:22,887 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:24:22,887 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:24:22,887 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:24:22,887 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:24:22,888 - INFO - Write: :INP:ATT 0
2025-07-02 13:24:22,888 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:24:22,888 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:24:22,888 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:24:22,888 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:24:22,889 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 13:24:22,889 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 13:24:22,889 - INFO - Write: CALC1:THR -122
2025-07-02 13:24:22,889 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:24:22,889 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:24:22,889 - INFO - Spur detection table configured
2025-07-02 13:24:22,890 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 13:24:22,890 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:24:22,890 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:24:27,413 - INFO - Response: 1
2025-07-02 13:24:27,413 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 13:24:27,413 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:24:27,415 - INFO - Response: 50
2025-07-02 13:24:27,415 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:24:27,416 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:24:27,459 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 13:24:27,459 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:24:27,461 - INFO - Response: -69.6092376709,-54.9804649353,-69.6783065796,-68.044631958,-47.8436698914,-85.124786377,-81.9315719604,-62.7562332153,-85.5171356201,-76.1726837158,-82.1926193237,-83.1610336304,-70.9856643677,-77.3100585938,-36.3425178528,-77.3677978516,-67.4827194214,-70.6570968628,-73.812828064,-70.7671432495,-78.028503418,-71.2257461548,-83.1373901367,-80.9485244751,-82.6321640015,-51.957698822,-72.0835800171,-77.3886795044,-81.4751358032,-79.3139724731,-40.5000572205,-68.0924453735,-84.9265823364,-66.6272964478,-82.7105712891,-76.4803543091,-50.9765815735,-54.5892105103,-85.0087280273,-79.7086105347,-68.8417663574,-84.5441131592,-65.5364379883,-69.5125350952,-57.1418190002,-77.233039856,-80.9794769287,-86.6371917725,-82.642326355,-48.5381164551
2025-07-02 13:24:27,461 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 13:24:27,461 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:28,509 - INFO - Response: 1
2025-07-02 13:24:28,510 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 13:24:28,510 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:24:28,510 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:24:28,511 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:24:28,511 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:24:28,511 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:24:28,511 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:24:28,512 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:24:28,512 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:24:28,512 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:24:28,512 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:24:28,513 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:24:28,513 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:24:28,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:24:28,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:24:28,514 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:24:28,514 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:24:31,371 - INFO - Response: 1
2025-07-02 13:24:31,371 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:24:31,372 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:24:31,372 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:24:31,372 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 13:24:31,372 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:31,561 - INFO - Response: 1
2025-07-02 13:24:31,562 - INFO - FSW reset for spur search
2025-07-02 13:24:31,562 - INFO - Write: INIT:CONT OFF
2025-07-02 13:24:31,562 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 13:24:31,562 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 13:24:31,562 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:24:31,563 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:24:31,563 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:24:31,563 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:24:31,563 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:24:31,563 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:24:31,564 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:24:31,564 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:24:31,564 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:24:31,564 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:24:31,565 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:24:31,565 - INFO - Write: :INP:ATT 0
2025-07-02 13:24:31,565 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:24:31,565 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:24:31,565 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:24:31,565 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:24:31,565 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 13:24:31,566 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 13:24:31,566 - INFO - Write: CALC1:THR -122
2025-07-02 13:24:31,566 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:24:31,566 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:24:31,566 - INFO - Spur detection table configured
2025-07-02 13:24:31,566 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 13:24:31,566 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:24:31,566 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:24:36,074 - INFO - Response: 1
2025-07-02 13:24:36,075 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 13:24:36,075 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:24:36,076 - INFO - Response: 50
2025-07-02 13:24:36,076 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:24:36,077 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:24:36,127 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4319400000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 13:24:36,128 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:24:36,129 - INFO - Response: -70.4495544434,-54.6735687256,-70.0605545044,-68.3035964966,-48.0613441467,-83.6980361938,-82.3146820068,-62.837387085,-86.8890380859,-75.528678894,-81.0949401855,-86.415184021,-82.6595230103,-70.8212280273,-79.2968063354,-36.2898292542,-75.2857513428,-77.3321304321,-66.8348083496,-67.6365585327,-86.3841552734,-71.9974136353,-51.8930282593,-78.658531189,-71.3737258911,-82.9299621582,-83.0913619995,-47.2888145447,-70.102142334,-44.5421867371,-69.0224609375,-82.8099746704,-66.0002670288,-83.8308029175,-80.6481399536,-86.3163986206,-50.3157196045,-55.0803527832,-80.2501602173,-67.0304946899,-87.0503768921,-65.368347168,-68.9656829834,-57.6819381714,-87.2695999146,-77.1407470703,-80.9582901001,-86.8735275269,-84.5846099854,-49.419090271
2025-07-02 13:24:36,129 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 13:24:36,129 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:37,184 - INFO - Response: 1
2025-07-02 13:24:37,185 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 13:24:37,185 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:24:37,185 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:24:37,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:24:37,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:24:37,186 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:24:37,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:24:37,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:24:37,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:24:37,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:24:37,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:24:37,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:24:37,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:24:37,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:24:37,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:24:37,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:24:37,188 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:24:40,013 - INFO - Response: 1
2025-07-02 13:24:40,013 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:24:40,014 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:24:40,014 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:24:40,014 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 13:24:40,014 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:40,203 - INFO - Response: 1
2025-07-02 13:24:40,203 - INFO - FSW reset for spur search
2025-07-02 13:24:40,203 - INFO - Write: INIT:CONT OFF
2025-07-02 13:24:40,204 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 13:24:40,204 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 13:24:40,204 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:24:40,204 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:24:40,204 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:24:40,205 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:24:40,205 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:24:40,205 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:24:40,205 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:24:40,205 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:24:40,205 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:24:40,206 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:24:40,206 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:24:40,206 - INFO - Write: :INP:ATT 0
2025-07-02 13:24:40,206 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:24:40,206 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:24:40,206 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:24:40,207 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:24:40,207 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 13:24:40,207 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 13:24:40,207 - INFO - Write: CALC1:THR -122
2025-07-02 13:24:40,207 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:24:40,207 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:24:40,208 - INFO - Spur detection table configured
2025-07-02 13:24:40,208 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 13:24:40,208 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:24:40,208 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:24:44,697 - INFO - Response: 1
2025-07-02 13:24:44,697 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 13:24:44,697 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:24:44,699 - INFO - Response: 50
2025-07-02 13:24:44,699 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:24:44,699 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:24:44,750 - INFO - Response: 1230500000,1430900000,1600300000,1629400000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2438200000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4829900000,4859100000
2025-07-02 13:24:44,750 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:24:44,751 - INFO - Response: -70.3552322388,-54.9868164062,-69.5738220215,-86.4289703369,-67.9676437378,-47.9661102295,-85.1533584595,-81.9439163208,-62.7806167603,-85.6794281006,-76.1718444824,-82.2262115479,-83.2946090698,-70.9979782104,-77.303314209,-36.3462867737,-77.2124099731,-67.5207977295,-70.6936950684,-73.083946228,-70.8135681152,-77.6951904297,-71.2562408447,-83.144821167,-81.1242294312,-82.8708496094,-51.9478302002,-72.5723953247,-77.4343338013,-81.3209533691,-79.2311248779,-40.5005683899,-68.1413650513,-85.3060684204,-66.6539840698,-82.7649383545,-76.5911407471,-50.9889831543,-54.6143493652,-85.028968811,-79.8983078003,-68.7903137207,-84.4756011963,-65.532699585,-69.4850616455,-57.2100563049,-76.9595489502,-81.1338119507,-82.718208313,-48.5275688171
2025-07-02 13:24:44,752 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 13:24:44,752 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:45,801 - INFO - Response: 1
2025-07-02 13:24:45,802 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 13:24:45,802 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:24:45,802 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:24:45,802 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:24:45,802 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:24:45,802 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:24:45,802 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:24:45,802 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:24:45,803 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:24:45,803 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:24:48,661 - INFO - Response: 1
2025-07-02 13:24:48,662 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:24:48,662 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:24:48,662 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:24:48,663 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 13:24:48,663 - INFO - Query: *RST;*OPC?
2025-07-02 13:24:48,851 - INFO - Response: 1
2025-07-02 13:24:48,851 - INFO - FSW reset for spur search
2025-07-02 13:24:48,851 - INFO - Write: INIT:CONT OFF
2025-07-02 13:24:48,851 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 13:24:48,852 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 13:24:48,852 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:24:48,852 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:24:48,852 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:24:48,852 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:24:48,852 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:24:48,853 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:24:48,853 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:24:48,853 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:24:48,853 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:24:48,853 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:24:48,853 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:24:48,853 - INFO - Write: :INP:ATT 0
2025-07-02 13:24:48,853 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:24:48,854 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:24:48,854 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:24:48,854 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:24:48,854 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 13:24:48,854 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 13:24:48,854 - INFO - Write: CALC1:THR -122
2025-07-02 13:24:48,854 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:24:48,854 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:24:48,854 - INFO - Spur detection table configured
2025-07-02 13:24:48,854 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 13:24:48,855 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:24:48,855 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:24:53,351 - INFO - Response: 1
2025-07-02 13:24:53,351 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 13:24:53,351 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:24:53,353 - INFO - Response: 50
2025-07-02 13:24:53,353 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:24:53,353 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:24:53,409 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 13:24:53,409 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:24:53,411 - INFO - Response: -70.113899231,-54.588924408,-70.0463409424,-86.7378768921,-68.3055038452,-48.0840644836,-83.770111084,-82.228729248,-62.8107032776,-86.7244491577,-75.5565414429,-80.7694854736,-86.9111404419,-82.89478302,-70.6103439331,-82.1371612549,-36.3954391479,-75.2867202759,-76.5051040649,-66.4860229492,-67.0275421143,-86.1548461914,-72.4071502686,-52.202003479,-78.8099975586,-71.3803405762,-83.0377731323,-84.026008606,-47.2949829102,-70.3458480835,-44.5399971008,-69.1667861938,-82.3977737427,-65.9980163574,-83.9924087524,-81.0935134888,-86.3829956055,-50.3633079529,-54.9762763977,-80.3468399048,-67.1226730347,-87.0447311401,-65.3796005249,-68.8638534546,-57.6768760681,-77.1875534058,-80.9142456055,-86.6327972412,-84.5732650757,-49.4204063416
2025-07-02 13:24:53,411 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 13:24:53,416 - INFO - Socket closed
2025-07-02 13:24:53,416 - INFO - FSW connection closed
2025-07-02 13:24:53,416 - INFO - Write: OUTP:STAT OFF
2025-07-02 13:24:53,416 - INFO - Socket closed
2025-07-02 13:24:53,416 - INFO - VSG connection closed
2025-07-02 13:24:53,419 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 13:24:53,475 - INFO - Socket closed
2025-07-02 13:24:53,481 - INFO - Socket closed
2025-07-02 13:59:01,834 - INFO - Starting RF measurement script
2025-07-02 13:59:01,835 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 13:59:01,836 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 13:59:01,836 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 13:59:01,840 - INFO - Connected to 192.168.200.20:5025
2025-07-02 13:59:01,840 - INFO - Query: *IDN?
2025-07-02 13:59:01,841 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 13:59:01,843 - INFO - Connected to 192.168.200.10:5025
2025-07-02 13:59:01,843 - INFO - Query: *IDN?
2025-07-02 13:59:01,844 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 13:59:01,844 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 13:59:01,844 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 13:59:01,844 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 13:59:01,844 - INFO - Query: *RST;*OPC?
2025-07-02 13:59:02,886 - INFO - Response: 1
2025-07-02 13:59:02,886 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 13:59:02,887 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:59:02,887 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:59:02,887 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:59:02,888 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:59:02,888 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:59:02,888 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:59:02,888 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:59:02,888 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:59:05,706 - INFO - Response: 1
2025-07-02 13:59:05,707 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:59:05,708 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:59:05,708 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:59:05,709 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 13:59:05,709 - INFO - Query: *RST;*OPC?
2025-07-02 13:59:05,899 - INFO - Response: 1
2025-07-02 13:59:05,900 - INFO - FSW reset for spur search
2025-07-02 13:59:05,900 - INFO - Write: INIT:CONT OFF
2025-07-02 13:59:05,900 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 13:59:05,900 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 13:59:05,901 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:59:05,901 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:59:05,901 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:59:05,901 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:59:05,902 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:59:05,902 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:59:05,902 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:59:05,902 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:59:05,902 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:59:05,903 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:59:05,903 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:59:05,903 - INFO - Write: :INP:ATT 0
2025-07-02 13:59:05,903 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:59:05,903 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:59:05,904 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:59:05,904 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:59:05,904 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 13:59:05,904 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 13:59:05,904 - INFO - Write: CALC1:THR -122
2025-07-02 13:59:05,905 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:59:05,905 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:59:05,905 - INFO - Spur detection table configured
2025-07-02 13:59:05,905 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 13:59:05,905 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:59:05,905 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:59:10,396 - INFO - Response: 1
2025-07-02 13:59:10,397 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 13:59:10,397 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:59:10,398 - INFO - Response: 50
2025-07-02 13:59:10,398 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:59:10,399 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:59:10,450 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 13:59:10,451 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:59:10,452 - INFO - Response: -69.9733047485,-55.0103492737,-69.7413406372,-68.0711135864,-47.8857002258,-85.1658401489,-81.9076156616,-62.746219635,-85.5389709473,-76.2210464478,-81.7837753296,-83.2900543213,-70.9457931519,-77.3012619019,-36.345489502,-77.3577880859,-67.4879074097,-70.6896896362,-73.309135437,-70.7924728394,-77.5928192139,-71.2836227417,-83.1499786377,-81.8191452026,-82.854057312,-51.9493408203,-72.8976364136,-77.3877792358,-81.404800415,-79.594291687,-40.5029983521,-68.2488327026,-85.1622085571,-66.6906204224,-82.7376403809,-76.5587768555,-50.926235199,-54.5997505188,-85.004699707,-79.9802780151,-68.7939529419,-84.6493835449,-65.5876693726,-69.5442123413,-57.2608108521,-77.0120925903,-81.0459899902,-86.5485839844,-82.707611084,-48.5350837708
2025-07-02 13:59:10,453 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 13:59:10,453 - INFO - Query: *RST;*OPC?
2025-07-02 13:59:11,506 - INFO - Response: 1
2025-07-02 13:59:11,506 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 13:59:11,507 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 13:59:11,507 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 13:59:11,507 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 13:59:11,507 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 13:59:11,508 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 13:59:11,508 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 13:59:11,508 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 13:59:11,508 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 13:59:11,508 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 13:59:11,509 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 13:59:11,509 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 13:59:11,509 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 13:59:11,509 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 13:59:11,509 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 13:59:11,509 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 13:59:11,510 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 13:59:14,709 - INFO - Response: 1
2025-07-02 13:59:14,709 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 13:59:14,710 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 13:59:14,710 - INFO - Write: OUTPut1:STATe 1
2025-07-02 13:59:14,710 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 13:59:14,710 - INFO - Query: *RST;*OPC?
2025-07-02 13:59:14,899 - INFO - Response: 1
2025-07-02 13:59:14,900 - INFO - FSW reset for spur search
2025-07-02 13:59:14,900 - INFO - Write: INIT:CONT OFF
2025-07-02 13:59:14,900 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 13:59:14,901 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 13:59:14,901 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 13:59:14,901 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 13:59:14,902 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 13:59:14,902 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 13:59:14,902 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 13:59:14,902 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 13:59:14,903 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 13:59:14,903 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 13:59:14,903 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 13:59:14,903 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 13:59:14,903 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 13:59:14,904 - INFO - Write: :INP:ATT 0
2025-07-02 13:59:14,904 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 13:59:14,904 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 13:59:14,904 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 13:59:14,904 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 13:59:14,904 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 13:59:14,905 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 13:59:14,905 - INFO - Write: CALC1:THR -122
2025-07-02 13:59:14,905 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 13:59:14,905 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 13:59:14,906 - INFO - Spur detection table configured
2025-07-02 13:59:14,906 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 13:59:14,906 - INFO - Write: :INIT:CONT OFF
2025-07-02 13:59:14,906 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 13:59:19,387 - INFO - Response: 1
2025-07-02 13:59:19,387 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 13:59:19,387 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:59:19,389 - INFO - Response: 50
2025-07-02 13:59:19,389 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:59:19,390 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:59:19,435 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3719400000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 13:59:19,436 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:59:19,438 - INFO - Response: -70.3876342773,-54.6552200317,-70.0046463013,-85.6533660889,-68.3273162842,-48.0625572205,-83.9523849487,-82.2424850464,-62.8004798889,-86.6237182617,-75.5171051025,-81.2200927734,-86.3956451416,-82.6482925415,-70.7731399536,-83.7821044922,-36.4129447937,-73.967918396,-77.2953643799,-66.6572265625,-66.2138519287,-71.0641784668,-52.1134109497,-78.1254730225,-71.421043396,-82.8980255127,-82.8052597046,-47.2669258118,-70.2443695068,-44.538898468,-69.0742721558,-83.0395355225,-65.9980545044,-83.9479980469,-81.0282974243,-86.398147583,-50.3553276062,-54.9923362732,-87.2547607422,-80.180305481,-67.1887130737,-87.1470565796,-65.3668212891,-68.9137649536,-57.7077484131,-77.2788619995,-80.9323272705,-86.7271957397,-84.5992202759,-49.4081039429
2025-07-02 13:59:19,438 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 13:59:19,440 - INFO - Response: 50
2025-07-02 13:59:19,440 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 13:59:19,440 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 13:59:19,484 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3719400000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 13:59:19,484 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 13:59:19,486 - INFO - Response: -70.3876342773,-54.6552200317,-70.0046463013,-85.6533660889,-68.3273162842,-48.0625572205,-83.9523849487,-82.2424850464,-62.8004798889,-86.6237182617,-75.5171051025,-81.2200927734,-86.3956451416,-82.6482925415,-70.7731399536,-83.7821044922,-36.4129447937,-73.967918396,-77.2953643799,-66.6572265625,-66.2138519287,-71.0641784668,-52.1134109497,-78.1254730225,-71.421043396,-82.8980255127,-82.8052597046,-47.2669258118,-70.2443695068,-44.538898468,-69.0742721558,-83.0395355225,-65.9980545044,-83.9479980469,-81.0282974243,-86.398147583,-50.3553276062,-54.9923362732,-87.2547607422,-80.180305481,-67.1887130737,-87.1470565796,-65.3668212891,-68.9137649536,-57.7077484131,-77.2788619995,-80.9323272705,-86.7271957397,-84.5992202759,-49.4081039429
2025-07-02 13:59:19,486 - DEBUG - SpurSearch results: ([], 0.048046299954876304)
2025-07-02 13:59:19,486 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 318, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 13:59:19,492 - INFO - Socket closed
2025-07-02 13:59:19,492 - INFO - FSW connection closed
2025-07-02 13:59:19,492 - INFO - Write: OUTP:STAT OFF
2025-07-02 13:59:19,493 - INFO - Socket closed
2025-07-02 13:59:19,493 - INFO - VSG connection closed
2025-07-02 13:59:19,495 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 13:59:19,777 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 13:59:19,814 - INFO - Socket closed
2025-07-02 13:59:19,815 - INFO - Socket closed
2025-07-02 13:59:55,428 - INFO - Starting RF measurement script
2025-07-02 13:59:55,430 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 13:59:55,430 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 13:59:55,430 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 13:59:55,430 - ERROR - SpurSearch test initialization failed: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_copilot.py", line 400, in <module>
    spur_instr = SpurSearch(
        fundamental_frequency_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        power_dbm=test.get("power_dbm", -70)
    )
TypeError: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
2025-07-02 13:59:55,434 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 13:59:55,434 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 13:59:55,758 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:01:05,763 - INFO - Starting RF measurement script
2025-07-02 14:01:05,766 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:01:05,766 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:01:05,767 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:01:05,767 - ERROR - SpurSearch test initialization failed: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_copilot.py", line 400, in <module>
    spur_instr = SpurSearch(
        fundamental_frequency_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        power_dbm=test.get("power_dbm", -70)
    )
TypeError: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
2025-07-02 14:01:05,770 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:01:05,770 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:01:05,994 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:01:44,654 - INFO - Starting RF measurement script
2025-07-02 14:01:44,655 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:01:44,656 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:01:44,656 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:01:44,656 - ERROR - SpurSearch test initialization failed: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_copilot.py", line 400, in <module>
    spur_instr = SpurSearch(
        fundamental_frequency_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        power_dbm=test.get("power_dbm", -70)
    )
TypeError: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
2025-07-02 14:01:44,658 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:01:44,658 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:01:44,921 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:02:41,937 - INFO - Starting RF measurement script
2025-07-02 14:02:41,940 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:02:41,941 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:02:41,941 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:02:41,946 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:02:41,946 - INFO - Query: *IDN?
2025-07-02 14:02:41,947 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:02:41,950 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:02:41,950 - INFO - Query: *IDN?
2025-07-02 14:02:41,951 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:02:41,951 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:02:41,951 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:02:41,951 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:02:41,951 - INFO - Query: *RST;*OPC?
2025-07-02 14:02:42,997 - INFO - Response: 1
2025-07-02 14:02:42,997 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:02:42,998 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:02:42,998 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:02:42,998 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:02:42,998 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:02:42,998 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:02:42,998 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:02:42,998 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:02:42,999 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:02:42,999 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:02:45,814 - INFO - Response: 1
2025-07-02 14:02:45,815 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:02:45,815 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:02:45,816 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:02:45,816 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:02:45,816 - INFO - Query: *RST;*OPC?
2025-07-02 14:02:46,006 - INFO - Response: 1
2025-07-02 14:02:46,006 - INFO - FSW reset for spur search
2025-07-02 14:02:46,006 - INFO - Write: INIT:CONT OFF
2025-07-02 14:02:46,007 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:02:46,007 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:02:46,007 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:02:46,007 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:02:46,007 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:02:46,008 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:02:46,008 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:02:46,008 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:02:46,008 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:02:46,008 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:02:46,008 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:02:46,008 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:02:46,008 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:02:46,009 - INFO - Write: :INP:ATT 0
2025-07-02 14:02:46,009 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:02:46,009 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:02:46,009 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:02:46,009 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:02:46,009 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:02:46,009 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:02:46,010 - INFO - Write: CALC1:THR -122
2025-07-02 14:02:46,010 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:02:46,010 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:02:46,010 - INFO - Spur detection table configured
2025-07-02 14:02:46,011 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:02:46,011 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:02:46,011 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:02:50,500 - INFO - Response: 1
2025-07-02 14:02:50,500 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:02:50,501 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:02:50,502 - INFO - Response: 50
2025-07-02 14:02:50,502 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:02:50,502 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:02:50,559 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 14:02:50,559 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:02:50,560 - INFO - Response: -70.3464355469,-54.9462966919,-69.7734527588,-68.040184021,-47.834438324,-85.2135848999,-81.8199768066,-62.6926994324,-85.5528411865,-76.1766586304,-81.2715301514,-83.4780502319,-70.929069519,-77.2001266479,-36.3434638977,-77.3185882568,-67.4732055664,-70.6856842041,-73.67943573,-70.7788391113,-77.5075759888,-71.2409820557,-83.1336669922,-81.5330200195,-82.5540847778,-51.9639968872,-72.6275100708,-77.1059188843,-81.451385498,-79.3502655029,-40.4999427795,-68.2435150146,-84.7661972046,-66.6658935547,-82.7098312378,-76.4646224976,-50.943271637,-54.5972175598,-84.9435577393,-80.1493988037,-68.8146438599,-84.4459381104,-65.5130615234,-69.5542297363,-57.2213172913,-77.1660919189,-81.0783004761,-86.4832000732,-82.6590881348,-48.5094680786
2025-07-02 14:02:50,561 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:02:50,561 - INFO - Query: *RST;*OPC?
2025-07-02 14:02:51,605 - INFO - Response: 1
2025-07-02 14:02:51,605 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:02:51,605 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:02:51,605 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:02:51,606 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:02:51,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:02:51,606 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:02:54,477 - INFO - Response: 1
2025-07-02 14:02:54,478 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:02:54,478 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:02:54,478 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:02:54,478 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:02:54,478 - INFO - Query: *RST;*OPC?
2025-07-02 14:02:54,667 - INFO - Response: 1
2025-07-02 14:02:54,668 - INFO - FSW reset for spur search
2025-07-02 14:02:54,668 - INFO - Write: INIT:CONT OFF
2025-07-02 14:02:54,668 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:02:54,668 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:02:54,669 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:02:54,669 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:02:54,669 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:02:54,669 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:02:54,670 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:02:54,670 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:02:54,670 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:02:54,670 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:02:54,671 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:02:54,671 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:02:54,671 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:02:54,671 - INFO - Write: :INP:ATT 0
2025-07-02 14:02:54,672 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:02:54,672 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:02:54,672 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:02:54,672 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:02:54,672 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:02:54,673 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:02:54,673 - INFO - Write: CALC1:THR -122
2025-07-02 14:02:54,673 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:02:54,673 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:02:54,673 - INFO - Spur detection table configured
2025-07-02 14:02:54,673 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:02:54,673 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:02:54,674 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:02:59,167 - INFO - Response: 1
2025-07-02 14:02:59,168 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:02:59,168 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:02:59,171 - INFO - Response: 50
2025-07-02 14:02:59,171 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:02:59,171 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:02:59,226 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2435400000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:02:59,227 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:02:59,228 - INFO - Response: -70.522026062,-54.6093521118,-70.0922164917,-68.2956848145,-48.0558280945,-83.8236541748,-82.2047348022,-62.7605819702,-86.8988265991,-75.5602493286,-81.0391235352,-86.7350540161,-82.4138870239,-71.1207046509,-77.9566040039,-87.2735137939,-36.1853218079,-76.1062469482,-77.5757980347,-67.1297454834,-68.6931381226,-86.9156036377,-73.37840271,-51.618144989,-78.6475982666,-71.3694992065,-82.9660568237,-83.2011184692,-47.2585067749,-70.2192459106,-44.5396652222,-68.9873962402,-82.3636779785,-66.0755310059,-83.9645462036,-80.9780044556,-86.2958526611,-50.3181304932,-54.9797706604,-79.9427947998,-67.0552139282,-87.221824646,-65.3951797485,-68.8404083252,-57.6827735901,-77.3947219849,-80.9308013916,-86.9086608887,-84.5495758057,-49.4175376892
2025-07-02 14:02:59,229 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:02:59,230 - INFO - Response: 50
2025-07-02 14:02:59,230 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:02:59,230 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:02:59,274 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2435400000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:02:59,274 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:02:59,276 - INFO - Response: -70.522026062,-54.6093521118,-70.0922164917,-68.2956848145,-48.0558280945,-83.8236541748,-82.2047348022,-62.7605819702,-86.8988265991,-75.5602493286,-81.0391235352,-86.7350540161,-82.4138870239,-71.1207046509,-77.9566040039,-87.2735137939,-36.1853218079,-76.1062469482,-77.5757980347,-67.1297454834,-68.6931381226,-86.9156036377,-73.37840271,-51.618144989,-78.6475982666,-71.3694992065,-82.9660568237,-83.2011184692,-47.2585067749,-70.2192459106,-44.5396652222,-68.9873962402,-82.3636779785,-66.0755310059,-83.9645462036,-80.9780044556,-86.2958526611,-50.3181304932,-54.9797706604,-79.9427947998,-67.0552139282,-87.221824646,-65.3951797485,-68.8404083252,-57.6827735901,-77.3947219849,-80.9308013916,-86.9086608887,-84.5495758057,-49.4175376892
2025-07-02 14:02:59,276 - DEBUG - SpurSearch results: ([], 0.047255099983885884)
2025-07-02 14:02:59,276 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 318, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:02:59,281 - INFO - Socket closed
2025-07-02 14:02:59,282 - INFO - FSW connection closed
2025-07-02 14:02:59,282 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:02:59,282 - INFO - Socket closed
2025-07-02 14:02:59,282 - INFO - VSG connection closed
2025-07-02 14:02:59,285 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:02:59,576 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:02:59,635 - INFO - Socket closed
2025-07-02 14:02:59,638 - INFO - Socket closed
2025-07-02 14:11:08,877 - INFO - Starting RF measurement script
2025-07-02 14:11:08,880 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:11:08,880 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:11:08,880 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:11:08,888 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:11:08,888 - INFO - Query: *IDN?
2025-07-02 14:11:08,889 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:11:08,892 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:11:08,892 - INFO - Query: *IDN?
2025-07-02 14:11:08,893 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:11:08,893 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:11:08,893 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:11:08,893 - DEBUG - Setting VSG power to -70.00 dBm
2025-07-02 14:11:08,894 - ERROR - SpurSearch test set 1 failed: 'SpurSearch' object has no attribute 'VSG_pwr'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 311, in run_spur_search_measurement
    _, timings["VSG_Set_Power"] = instr.VSG_pwr(pwr=pwr)
                                  ^^^^^^^^^^^^^
AttributeError: 'SpurSearch' object has no attribute 'VSG_pwr'
2025-07-02 14:11:08,896 - INFO - Socket closed
2025-07-02 14:11:08,896 - INFO - FSW connection closed
2025-07-02 14:11:08,896 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:11:08,896 - INFO - Socket closed
2025-07-02 14:11:08,896 - INFO - VSG connection closed
2025-07-02 14:11:08,898 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:11:09,197 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:11:09,257 - INFO - Socket closed
2025-07-02 14:11:09,259 - INFO - Socket closed
2025-07-02 14:17:52,840 - INFO - Starting RF measurement script
2025-07-02 14:17:52,843 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:17:52,843 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:17:52,843 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:17:52,848 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:17:52,849 - INFO - Query: *IDN?
2025-07-02 14:17:52,850 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:17:52,852 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:17:52,852 - INFO - Query: *IDN?
2025-07-02 14:17:52,853 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:17:52,853 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:17:52,853 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:17:52,853 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:17:52,853 - INFO - Query: *RST;*OPC?
2025-07-02 14:17:53,896 - INFO - Response: 1
2025-07-02 14:17:53,897 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:17:53,897 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:17:53,897 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:17:53,897 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:17:53,897 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:17:53,897 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:17:53,897 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:17:53,897 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:17:53,897 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:17:53,898 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:17:53,898 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:17:56,724 - INFO - Response: 1
2025-07-02 14:17:56,724 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:17:56,724 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:17:56,724 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:17:56,724 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:17:56,725 - INFO - Query: *RST;*OPC?
2025-07-02 14:17:56,918 - INFO - Response: 1
2025-07-02 14:17:56,918 - INFO - FSW reset for spur search
2025-07-02 14:17:56,918 - INFO - Write: INIT:CONT OFF
2025-07-02 14:17:56,918 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:17:56,918 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:17:56,918 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:17:56,918 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:17:56,919 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:17:56,919 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:17:56,919 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:17:56,919 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:17:56,919 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:17:56,919 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:17:56,919 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:17:56,919 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:17:56,919 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:17:56,919 - INFO - Write: :INP:ATT 0
2025-07-02 14:17:56,919 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:17:56,919 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:17:56,919 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:17:56,919 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:17:56,920 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:17:56,920 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:17:56,920 - INFO - Write: CALC1:THR -122
2025-07-02 14:17:56,920 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:17:56,920 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:17:56,920 - INFO - Spur detection table configured
2025-07-02 14:17:56,920 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:17:56,920 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:17:56,920 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:18:01,413 - INFO - Response: 1
2025-07-02 14:18:01,414 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:18:01,414 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:18:01,416 - INFO - Response: 50
2025-07-02 14:18:01,416 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:18:01,416 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:18:01,465 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3600400000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4829900000,4859100000
2025-07-02 14:18:01,466 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:18:01,467 - INFO - Response: -69.9943618774,-54.9189987183,-69.6285095215,-68.0265884399,-47.8560180664,-85.0800857544,-81.9515991211,-62.7579879761,-85.610458374,-76.2007675171,-81.8151473999,-83.3790435791,-70.8780136108,-77.4142990112,-36.3448371887,-77.2974853516,-67.4965820312,-70.7505187988,-73.6189422607,-70.7845230103,-77.7775039673,-71.2883148193,-83.1008605957,-81.8689422607,-82.7125549316,-51.9475212097,-72.6536636353,-77.4017181396,-81.4261856079,-79.4929046631,-40.5036239624,-68.2015228271,-84.7649688721,-66.6489562988,-82.6782150269,-76.4016952515,-86.662727356,-50.9151382446,-54.6012878418,-85.0502090454,-79.9601135254,-68.799621582,-84.4685592651,-65.505317688,-69.5376663208,-57.2550888062,-77.3999252319,-81.0537490845,-82.6881484985,-48.5070533752
2025-07-02 14:18:01,467 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:18:01,467 - INFO - Query: *RST;*OPC?
2025-07-02 14:18:02,516 - INFO - Response: 1
2025-07-02 14:18:02,516 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:18:02,516 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:18:02,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:18:02,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:18:02,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:18:02,517 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:18:02,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:18:02,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:18:02,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:18:02,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:18:02,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:18:02,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:18:02,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:18:02,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:18:02,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:18:02,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:18:02,518 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:18:05,361 - INFO - Response: 1
2025-07-02 14:18:05,361 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:18:05,361 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:18:05,361 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:18:05,362 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:18:05,362 - INFO - Query: *RST;*OPC?
2025-07-02 14:18:05,550 - INFO - Response: 1
2025-07-02 14:18:05,551 - INFO - FSW reset for spur search
2025-07-02 14:18:05,551 - INFO - Write: INIT:CONT OFF
2025-07-02 14:18:05,551 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:18:05,551 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:18:05,551 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:18:05,551 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:18:05,551 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:18:05,551 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:18:05,551 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:18:05,552 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:18:05,552 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:18:05,552 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:18:05,552 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:18:05,552 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:18:05,552 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:18:05,552 - INFO - Write: :INP:ATT 0
2025-07-02 14:18:05,552 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:18:05,552 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:18:05,552 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:18:05,552 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:18:05,552 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:18:05,553 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:18:05,553 - INFO - Write: CALC1:THR -122
2025-07-02 14:18:05,553 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:18:05,553 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:18:05,553 - INFO - Spur detection table configured
2025-07-02 14:18:05,553 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:18:05,553 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:18:05,553 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:18:10,077 - INFO - Response: 1
2025-07-02 14:18:10,078 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:18:10,078 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:18:10,079 - INFO - Response: 50
2025-07-02 14:18:10,079 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:18:10,080 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:18:10,128 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:18:10,128 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:18:10,129 - INFO - Response: -70.1840133667,-54.6118049622,-70.0491867065,-86.9659729004,-68.2723464966,-48.1093559265,-83.763671875,-82.3329544067,-62.7466011047,-86.6812133789,-75.5108642578,-80.7979888916,-86.6146469116,-82.7897109985,-70.1082000732,-83.7257995605,-36.4444465637,-74.9084472656,-76.5435638428,-66.6646652222,-66.6397781372,-85.1908874512,-72.0343170166,-52.2887573242,-78.2829971313,-71.3710174561,-82.8615188599,-82.7533569336,-47.2576637268,-70.0972976685,-44.5400276184,-69.1368713379,-82.7005462646,-66.0161437988,-83.7903671265,-81.206489563,-86.4331893921,-50.3326759338,-54.9920005798,-80.3182220459,-66.9739379883,-86.6616439819,-65.3941650391,-68.9362335205,-57.6986083984,-77.2969512939,-80.9385299683,-86.9414825439,-84.5379943848,-49.396522522
2025-07-02 14:18:10,130 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:18:10,130 - INFO - Query: *RST;*OPC?
2025-07-02 14:18:11,183 - INFO - Response: 1
2025-07-02 14:18:11,183 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:18:11,184 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:18:11,185 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:18:11,185 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:18:11,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:18:11,186 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:18:11,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:18:11,186 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:18:11,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:18:11,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:18:11,187 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:18:11,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:18:11,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:18:11,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:18:11,188 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:18:11,189 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:18:11,189 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:18:14,014 - INFO - Response: 1
2025-07-02 14:18:14,014 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:18:14,015 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:18:14,015 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:18:14,015 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:18:14,015 - INFO - Query: *RST;*OPC?
2025-07-02 14:18:14,203 - INFO - Response: 1
2025-07-02 14:18:14,203 - INFO - FSW reset for spur search
2025-07-02 14:18:14,203 - INFO - Write: INIT:CONT OFF
2025-07-02 14:18:14,204 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:18:14,204 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:18:14,204 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:18:14,204 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:18:14,205 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:18:14,205 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:18:14,205 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:18:14,205 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:18:14,205 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:18:14,205 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:18:14,206 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:18:14,206 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:18:14,206 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:18:14,206 - INFO - Write: :INP:ATT 0
2025-07-02 14:18:14,206 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:18:14,206 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:18:14,206 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:18:14,206 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:18:14,206 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:18:14,206 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:18:14,206 - INFO - Write: CALC1:THR -122
2025-07-02 14:18:14,206 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:18:14,207 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:18:14,207 - INFO - Spur detection table configured
2025-07-02 14:18:14,207 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:18:14,207 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:18:14,207 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:18:18,699 - INFO - Response: 1
2025-07-02 14:18:18,700 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:18:18,700 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:18:18,701 - INFO - Response: 50
2025-07-02 14:18:18,701 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:18:18,701 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:18:18,744 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 14:18:18,745 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:18:18,746 - INFO - Response: -70.1847305298,-54.9072303772,-69.6574172974,-67.9726257324,-47.9684791565,-85.2393951416,-81.9343032837,-62.7476348877,-85.5773849487,-76.1753692627,-81.5895462036,-83.5580978394,-70.8653106689,-77.3351898193,-36.3427047729,-77.2615127563,-67.4857254028,-70.7342529297,-73.6490020752,-70.7655563354,-78.0397872925,-71.3200073242,-83.0997848511,-82.0261535645,-83.0263671875,-51.9571380615,-72.8769607544,-77.1606521606,-81.4461669922,-79.6972122192,-40.502620697,-68.334602356,-84.7114715576,-66.5999221802,-82.7101821899,-76.3179931641,-50.9783554077,-54.5114631653,-84.8855667114,-80.0865249634,-68.8325881958,-84.5383911133,-65.5431747437,-69.5849456787,-57.2674179077,-77.310256958,-81.0184249878,-86.4354171753,-82.6542892456,-48.5274734497
2025-07-02 14:18:18,746 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:18:18,746 - INFO - Query: *RST;*OPC?
2025-07-02 14:18:19,797 - INFO - Response: 1
2025-07-02 14:18:19,797 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:18:19,797 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:18:19,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:18:19,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:18:19,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:18:19,798 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:18:19,798 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:18:19,798 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:18:22,667 - INFO - Response: 1
2025-07-02 14:18:22,667 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:18:22,668 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:18:22,668 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:18:22,668 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:18:22,668 - INFO - Query: *RST;*OPC?
2025-07-02 14:18:22,858 - INFO - Response: 1
2025-07-02 14:18:22,858 - INFO - FSW reset for spur search
2025-07-02 14:18:22,858 - INFO - Write: INIT:CONT OFF
2025-07-02 14:18:22,858 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:18:22,858 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:18:22,859 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:18:22,859 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:18:22,859 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:18:22,859 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:18:22,859 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:18:22,859 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:18:22,859 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:18:22,859 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:18:22,859 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:18:22,859 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:18:22,859 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:18:22,860 - INFO - Write: :INP:ATT 0
2025-07-02 14:18:22,860 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:18:22,860 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:18:22,860 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:18:22,860 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:18:22,860 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:18:22,860 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:18:22,860 - INFO - Write: CALC1:THR -122
2025-07-02 14:18:22,860 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:18:22,860 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:18:22,860 - INFO - Spur detection table configured
2025-07-02 14:18:22,860 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:18:22,860 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:18:22,861 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:18:27,352 - INFO - Response: 1
2025-07-02 14:18:27,352 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:18:27,352 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:18:27,354 - INFO - Response: 50
2025-07-02 14:18:27,354 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:18:27,354 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:18:27,408 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2435400000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:18:27,409 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:18:27,410 - INFO - Response: -70.4164428711,-54.662651062,-69.970741272,-86.6205062866,-68.1855239868,-48.0814971924,-83.9154968262,-82.1733856201,-62.7995796204,-86.5760116577,-75.5033187866,-81.1194229126,-86.5711364746,-82.4644622803,-70.9976577759,-79.1324462891,-87.1283187866,-36.2427139282,-74.8930206299,-77.5863265991,-66.7476119995,-67.6677474976,-86.5796356201,-71.3124771118,-51.7026176453,-78.5816192627,-71.3930053711,-82.9071502686,-83.0509262085,-47.2445106506,-70.3836364746,-44.5381164551,-68.9062957764,-83.2041778564,-66.0407562256,-83.8923721313,-80.7410430908,-86.4538955688,-50.2963867188,-54.9635429382,-80.255241394,-67.0378417969,-65.3322219849,-68.8996124268,-57.6645317078,-77.2650527954,-80.8142166138,-86.7496948242,-84.5303344727,-49.3955612183
2025-07-02 14:18:27,410 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:18:27,414 - INFO - Socket closed
2025-07-02 14:18:27,414 - INFO - FSW connection closed
2025-07-02 14:18:27,414 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:18:27,414 - INFO - Socket closed
2025-07-02 14:18:27,415 - INFO - VSG connection closed
2025-07-02 14:18:27,417 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:18:27,478 - INFO - Socket closed
2025-07-02 14:18:27,488 - INFO - Socket closed
2025-07-02 14:19:24,543 - INFO - Starting RF measurement script
2025-07-02 14:19:24,547 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:19:24,548 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:19:24,548 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:19:24,553 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:19:24,554 - INFO - Query: *IDN?
2025-07-02 14:19:24,555 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:19:24,558 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:19:24,558 - INFO - Query: *IDN?
2025-07-02 14:19:24,559 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:19:24,559 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:19:24,559 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:19:24,559 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:19:24,559 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:25,608 - INFO - Response: 1
2025-07-02 14:19:25,609 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:19:25,609 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:19:25,610 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:19:25,610 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:19:25,610 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:19:25,610 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:19:25,610 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:19:25,610 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:19:25,611 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:19:25,612 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:19:25,612 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:19:28,429 - INFO - Response: 1
2025-07-02 14:19:28,430 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:19:28,430 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:19:28,430 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:19:28,430 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:19:28,430 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:28,620 - INFO - Response: 1
2025-07-02 14:19:28,620 - INFO - FSW reset for spur search
2025-07-02 14:19:28,620 - INFO - Write: INIT:CONT OFF
2025-07-02 14:19:28,620 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:19:28,620 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:19:28,621 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:19:28,621 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:19:28,621 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:19:28,621 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:19:28,621 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:19:28,621 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:19:28,621 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:19:28,621 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:19:28,621 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:19:28,621 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:19:28,621 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:19:28,621 - INFO - Write: :INP:ATT 0
2025-07-02 14:19:28,621 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:19:28,622 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:19:28,622 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:19:28,622 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:19:28,622 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:19:28,622 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:19:28,622 - INFO - Write: CALC1:THR -122
2025-07-02 14:19:28,622 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:19:28,622 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:19:28,622 - INFO - Spur detection table configured
2025-07-02 14:19:28,622 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:19:28,622 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:19:28,622 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:19:33,119 - INFO - Response: 1
2025-07-02 14:19:33,120 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:19:33,120 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:19:33,122 - INFO - Response: 50
2025-07-02 14:19:33,122 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:19:33,122 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:19:33,166 - INFO - Response: 1230500000,1430900000,1600300000,1629400000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4829900000,4859100000
2025-07-02 14:19:33,166 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:19:33,168 - INFO - Response: -70.3939208984,-54.9965209961,-69.5633926392,-86.479309082,-68.035949707,-47.9236526489,-85.1691207886,-81.9698791504,-62.7518692017,-85.5736083984,-76.2185668945,-81.2107925415,-83.3820037842,-70.8489151001,-77.2861709595,-36.3427886963,-77.1755447388,-67.4727783203,-70.7415924072,-73.9906768799,-70.7013702393,-77.9579467773,-71.3261413574,-83.0124053955,-82.122833252,-82.6972503662,-51.9524612427,-72.2295074463,-77.3425674438,-81.415145874,-79.2585144043,-40.5001106262,-68.3057861328,-85.0441894531,-66.6181640625,-82.7229537964,-76.2933273315,-50.9182624817,-54.6455841064,-85.1030197144,-80.0849685669,-68.8401489258,-84.528213501,-65.5275039673,-69.5174026489,-57.2342605591,-77.0431594849,-81.0948486328,-82.7191238403,-48.5092697144
2025-07-02 14:19:33,168 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:19:33,168 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:34,226 - INFO - Response: 1
2025-07-02 14:19:34,227 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:19:34,227 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:19:34,227 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:19:34,227 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:19:34,227 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:19:34,227 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:19:34,228 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:19:34,229 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:19:34,229 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:19:34,229 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:19:37,065 - INFO - Response: 1
2025-07-02 14:19:37,065 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:19:37,065 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:19:37,066 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:19:37,066 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:19:37,066 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:37,255 - INFO - Response: 1
2025-07-02 14:19:37,255 - INFO - FSW reset for spur search
2025-07-02 14:19:37,255 - INFO - Write: INIT:CONT OFF
2025-07-02 14:19:37,256 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:19:37,256 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:19:37,257 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:19:37,257 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:19:37,257 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:19:37,258 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:19:37,258 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:19:37,258 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:19:37,258 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:19:37,259 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:19:37,259 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:19:37,259 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:19:37,259 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:19:37,259 - INFO - Write: :INP:ATT 0
2025-07-02 14:19:37,260 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:19:37,260 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:19:37,260 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:19:37,260 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:19:37,261 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:19:37,261 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:19:37,261 - INFO - Write: CALC1:THR -122
2025-07-02 14:19:37,261 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:19:37,262 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:19:37,262 - INFO - Spur detection table configured
2025-07-02 14:19:37,262 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:19:37,262 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:19:37,262 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:19:41,752 - INFO - Response: 1
2025-07-02 14:19:41,752 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:19:41,753 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:19:41,755 - INFO - Response: 50
2025-07-02 14:19:41,755 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:19:41,755 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:19:41,805 - INFO - Response: 1239200000,1440400000,1599500000,1639800000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2435400000,2439100000,2448200000,2451900000,2457400000,2470200000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:19:41,805 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:19:41,807 - INFO - Response: -70.9219512939,-54.6405754089,-70.1201782227,-86.933052063,-68.3358840942,-48.0468826294,-83.8184585571,-82.2445297241,-62.7520637512,-86.7152023315,-75.5589828491,-81.0549087524,-86.688041687,-82.3095626831,-71.7159042358,-81.6335525513,-86.0498123169,-36.2799301147,-73.0134277344,-78.2791213989,-66.3544082642,-66.212852478,-69.9958114624,-51.6739044189,-78.1483230591,-71.4055862427,-82.9517669678,-83.0300750732,-47.2622451782,-70.3652801514,-44.5432548523,-69.0481643677,-82.7341918945,-66.1008605957,-83.9331817627,-80.283416748,-86.4284896851,-50.2879714966,-54.9829750061,-80.3844604492,-67.0666351318,-86.8103561401,-65.3791885376,-68.8500823975,-57.6827697754,-77.2156982422,-80.9424743652,-86.9810714722,-84.593788147,-49.4095306396
2025-07-02 14:19:41,807 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:19:41,807 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:42,863 - INFO - Response: 1
2025-07-02 14:19:42,863 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:19:42,863 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:19:42,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:19:42,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:19:42,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:19:42,863 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:19:42,864 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:19:42,864 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:19:45,692 - INFO - Response: 1
2025-07-02 14:19:45,692 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:19:45,692 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:19:45,692 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:19:45,692 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:19:45,693 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:45,882 - INFO - Response: 1
2025-07-02 14:19:45,882 - INFO - FSW reset for spur search
2025-07-02 14:19:45,882 - INFO - Write: INIT:CONT OFF
2025-07-02 14:19:45,882 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:19:45,882 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:19:45,882 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:19:45,882 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:19:45,883 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:19:45,883 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:19:45,883 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:19:45,883 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:19:45,883 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:19:45,883 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:19:45,883 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:19:45,883 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:19:45,883 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:19:45,883 - INFO - Write: :INP:ATT 0
2025-07-02 14:19:45,883 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:19:45,883 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:19:45,883 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:19:45,883 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:19:45,883 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:19:45,884 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:19:45,884 - INFO - Write: CALC1:THR -122
2025-07-02 14:19:45,884 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:19:45,884 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:19:45,884 - INFO - Spur detection table configured
2025-07-02 14:19:45,884 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:19:45,884 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:19:45,884 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:19:50,374 - INFO - Response: 1
2025-07-02 14:19:50,374 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:19:50,374 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:19:50,375 - INFO - Response: 50
2025-07-02 14:19:50,375 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:19:50,375 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:19:50,423 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 14:19:50,424 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:19:50,425 - INFO - Response: -70.1497879028,-54.9621810913,-69.7112350464,-68.0030670166,-47.9717941284,-85.0792007446,-81.8888626099,-62.7483177185,-85.5163192749,-76.1405181885,-81.5118942261,-83.3525619507,-70.8635559082,-77.3901443481,-36.3447608948,-77.330619812,-67.5051727295,-70.7406463623,-73.3163070679,-70.7514877319,-77.5974502563,-71.3129501343,-83.1482696533,-81.3858108521,-82.6132507324,-51.9653320312,-72.0787353516,-77.2207870483,-81.4744873047,-79.2616958618,-40.4987678528,-68.062210083,-84.4290924072,-66.6133270264,-82.6507797241,-76.5090637207,-50.8995704651,-54.6424255371,-85.0820236206,-80.0717163086,-68.735496521,-84.4428482056,-65.5199661255,-69.5923538208,-57.2319641113,-76.9787063599,-81.0715103149,-86.7041702271,-82.7324905396,-48.48985672
2025-07-02 14:19:50,425 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:19:50,425 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:51,477 - INFO - Response: 1
2025-07-02 14:19:51,478 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:19:51,478 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:19:51,478 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:19:51,478 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:19:51,479 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:19:51,479 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:19:51,479 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:19:51,479 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:19:51,479 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:19:54,355 - INFO - Response: 1
2025-07-02 14:19:54,355 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:19:54,355 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:19:54,355 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:19:54,355 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:19:54,355 - INFO - Query: *RST;*OPC?
2025-07-02 14:19:54,544 - INFO - Response: 1
2025-07-02 14:19:54,544 - INFO - FSW reset for spur search
2025-07-02 14:19:54,544 - INFO - Write: INIT:CONT OFF
2025-07-02 14:19:54,545 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:19:54,545 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:19:54,545 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:19:54,545 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:19:54,545 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:19:54,545 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:19:54,545 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:19:54,545 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:19:54,545 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:19:54,545 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:19:54,545 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:19:54,545 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:19:54,545 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:19:54,545 - INFO - Write: :INP:ATT 0
2025-07-02 14:19:54,545 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:19:54,546 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:19:54,546 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:19:54,546 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:19:54,546 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:19:54,546 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:19:54,546 - INFO - Write: CALC1:THR -122
2025-07-02 14:19:54,546 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:19:54,546 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:19:54,546 - INFO - Spur detection table configured
2025-07-02 14:19:54,546 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:19:54,546 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:19:54,546 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:19:59,038 - INFO - Response: 1
2025-07-02 14:19:59,038 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:19:59,038 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:19:59,039 - INFO - Response: 50
2025-07-02 14:19:59,039 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:19:59,040 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:19:59,096 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3719400000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4319400000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:19:59,096 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:19:59,097 - INFO - Response: -70.6289825439,-54.6274032593,-70.0644226074,-68.3329467773,-48.0252876282,-83.8036346436,-82.2385864258,-62.858379364,-86.8921432495,-75.5426712036,-81.5814437866,-86.3545455933,-82.7028961182,-70.7578659058,-80.1122970581,-36.3415107727,-74.3707122803,-66.868057251,-66.7183837891,-87.7087173462,-71.4043884277,-51.911403656,-78.2788619995,-71.3972167969,-82.9509658813,-82.7871780396,-47.2695045471,-70.2319259644,-44.540019989,-69.0500488281,-82.60912323,-66.0325546265,-84.009803772,-81.1926040649,-86.5039749146,-50.3143005371,-55.0202560425,-87.4069137573,-80.2299575806,-67.0104751587,-86.7928619385,-65.375289917,-68.8969955444,-57.7324409485,-87.3681869507,-77.5803451538,-80.9540863037,-86.7733383179,-84.5387878418,-49.4025535583
2025-07-02 14:19:59,097 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:19:59,100 - INFO - Socket closed
2025-07-02 14:19:59,100 - INFO - FSW connection closed
2025-07-02 14:19:59,100 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:19:59,100 - INFO - Socket closed
2025-07-02 14:19:59,100 - INFO - VSG connection closed
2025-07-02 14:19:59,103 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:19:59,146 - INFO - Socket closed
2025-07-02 14:19:59,153 - INFO - Socket closed
2025-07-02 14:22:24,502 - INFO - Starting RF measurement script
2025-07-02 14:22:24,506 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:22:24,507 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:22:24,507 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:22:24,512 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:22:24,512 - INFO - Query: *IDN?
2025-07-02 14:22:24,513 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:22:24,516 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:22:24,516 - INFO - Query: *IDN?
2025-07-02 14:22:24,516 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:22:24,517 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:22:24,517 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:22:24,517 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:22:24,517 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:25,561 - INFO - Response: 1
2025-07-02 14:22:25,562 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:22:25,562 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:22:25,563 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:22:25,563 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:22:25,564 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:22:25,564 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:22:25,564 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:22:28,367 - INFO - Response: 1
2025-07-02 14:22:28,367 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:22:28,368 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:22:28,368 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:22:28,369 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:22:28,369 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:22:28,370 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:28,559 - INFO - Response: 1
2025-07-02 14:22:28,559 - INFO - FSW reset for spur search
2025-07-02 14:22:28,559 - INFO - Write: INIT:CONT OFF
2025-07-02 14:22:28,560 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:22:28,560 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:22:28,560 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:22:28,560 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:22:28,560 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:22:28,560 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:22:28,560 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:22:28,560 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:22:28,560 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:22:28,560 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:22:28,560 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:22:28,560 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:22:28,560 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:22:28,561 - INFO - Write: :INP:ATT 0
2025-07-02 14:22:28,561 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:22:28,561 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:22:28,561 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:22:28,561 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:22:28,561 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:22:28,561 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:22:28,561 - INFO - Write: CALC1:THR -122
2025-07-02 14:22:28,561 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:22:28,561 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:22:28,561 - INFO - Spur detection table configured
2025-07-02 14:22:28,561 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:22:28,561 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:22:28,562 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:22:32,998 - INFO - Response: 1
2025-07-02 14:22:32,998 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:22:32,998 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:22:33,000 - INFO - Response: 4
2025-07-02 14:22:33,000 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:22:33,000 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:22:33,055 - INFO - Response: 1430900000,2429100000,3030200000,3429100000
2025-07-02 14:22:33,055 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:22:33,057 - INFO - Response: -115.854637146,-94.2154083252,-96.7430114746,-120.084068298
2025-07-02 14:22:33,057 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:22:33,057 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:34,108 - INFO - Response: 1
2025-07-02 14:22:34,108 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:22:34,109 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:22:34,109 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:22:34,109 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:22:34,110 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:22:34,110 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:22:34,110 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:22:34,111 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:22:34,111 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:22:34,111 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:22:34,111 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:22:34,112 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:22:34,112 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:22:34,112 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:22:34,112 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:22:34,113 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:22:34,113 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:22:36,977 - INFO - Response: 1
2025-07-02 14:22:36,977 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:22:36,978 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:22:36,978 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:22:36,978 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:22:36,978 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:22:36,979 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:37,170 - INFO - Response: 1
2025-07-02 14:22:37,170 - INFO - FSW reset for spur search
2025-07-02 14:22:37,171 - INFO - Write: INIT:CONT OFF
2025-07-02 14:22:37,171 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:22:37,171 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:22:37,171 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:22:37,172 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:22:37,172 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:22:37,172 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:22:37,172 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:22:37,172 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:22:37,173 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:22:37,173 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:22:37,173 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:22:37,173 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:22:37,173 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:22:37,173 - INFO - Write: :INP:ATT 0
2025-07-02 14:22:37,173 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:22:37,174 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:22:37,174 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:22:37,174 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:22:37,174 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:22:37,174 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:22:37,174 - INFO - Write: CALC1:THR -122
2025-07-02 14:22:37,174 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:22:37,175 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:22:37,175 - INFO - Spur detection table configured
2025-07-02 14:22:37,175 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:22:37,175 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:22:37,175 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:22:41,597 - INFO - Response: 1
2025-07-02 14:22:41,597 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:22:41,597 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:22:41,598 - INFO - Response: 4
2025-07-02 14:22:41,599 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:22:41,599 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:22:41,651 - INFO - Response: 1440400000,2439100000,3040900000,3439600000
2025-07-02 14:22:41,651 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:22:41,653 - INFO - Response: -116.006256104,-93.9504928589,-96.6805801392,-120.32283783
2025-07-02 14:22:41,653 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:22:41,654 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:42,702 - INFO - Response: 1
2025-07-02 14:22:42,702 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:22:42,703 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:22:42,704 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:22:42,704 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:22:42,704 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:22:42,704 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:22:42,705 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:22:42,705 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:22:42,705 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:22:42,705 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:22:42,705 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:22:42,706 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:22:42,706 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:22:42,707 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:22:42,707 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:22:42,707 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:22:42,708 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:22:45,538 - INFO - Response: 1
2025-07-02 14:22:45,538 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:22:45,538 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:22:45,539 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:22:45,539 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:22:45,539 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:22:45,539 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:45,732 - INFO - Response: 1
2025-07-02 14:22:45,732 - INFO - FSW reset for spur search
2025-07-02 14:22:45,732 - INFO - Write: INIT:CONT OFF
2025-07-02 14:22:45,733 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:22:45,733 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:22:45,733 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:22:45,733 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:22:45,733 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:22:45,733 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:22:45,733 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:22:45,733 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:22:45,734 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:22:45,734 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:22:45,734 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:22:45,734 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:22:45,734 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:22:45,734 - INFO - Write: :INP:ATT 0
2025-07-02 14:22:45,734 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:22:45,735 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:22:45,735 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:22:45,735 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:22:45,735 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:22:45,735 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:22:45,735 - INFO - Write: CALC1:THR -122
2025-07-02 14:22:45,735 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:22:45,735 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:22:45,735 - INFO - Spur detection table configured
2025-07-02 14:22:45,736 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:22:45,736 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:22:45,736 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:22:50,134 - INFO - Response: 1
2025-07-02 14:22:50,134 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:22:50,135 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:22:50,137 - INFO - Response: 4
2025-07-02 14:22:50,137 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:22:50,138 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:22:50,184 - INFO - Response: 1430900000,2429100000,3030200000,3429100000
2025-07-02 14:22:50,185 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:22:50,186 - INFO - Response: -116.14756012,-94.2457809448,-96.650390625,-119.570014954
2025-07-02 14:22:50,186 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:22:50,187 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:51,238 - INFO - Response: 1
2025-07-02 14:22:51,238 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:22:51,238 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:22:51,239 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:22:51,239 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:22:51,239 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:22:51,239 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:22:51,239 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:22:51,239 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:22:51,240 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:22:51,240 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:22:51,240 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:22:51,241 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:22:51,241 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:22:51,241 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:22:51,241 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:22:51,242 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:22:51,242 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:22:54,093 - INFO - Response: 1
2025-07-02 14:22:54,093 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:22:54,094 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:22:54,094 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:22:54,094 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:22:54,095 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:22:54,095 - INFO - Query: *RST;*OPC?
2025-07-02 14:22:54,301 - INFO - Response: 1
2025-07-02 14:22:54,302 - INFO - FSW reset for spur search
2025-07-02 14:22:54,302 - INFO - Write: INIT:CONT OFF
2025-07-02 14:22:54,303 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:22:54,303 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:22:54,303 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:22:54,303 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:22:54,304 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:22:54,304 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:22:54,304 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:22:54,304 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:22:54,304 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:22:54,304 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:22:54,304 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:22:54,304 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:22:54,305 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:22:54,305 - INFO - Write: :INP:ATT 0
2025-07-02 14:22:54,305 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:22:54,305 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:22:54,305 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:22:54,305 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:22:54,305 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:22:54,305 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:22:54,305 - INFO - Write: CALC1:THR -122
2025-07-02 14:22:54,306 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:22:54,306 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:22:54,306 - INFO - Spur detection table configured
2025-07-02 14:22:54,306 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:22:54,306 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:22:54,306 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:22:58,720 - INFO - Response: 1
2025-07-02 14:22:58,721 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:22:58,721 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:22:58,723 - INFO - Response: 4
2025-07-02 14:22:58,723 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:22:58,724 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:22:58,770 - INFO - Response: 1440400000,2439100000,3040900000,3439600000
2025-07-02 14:22:58,771 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:22:58,772 - INFO - Response: -116.059150696,-93.9490356445,-96.7108764648,-119.907646179
2025-07-02 14:22:58,772 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:22:58,775 - INFO - Socket closed
2025-07-02 14:22:58,775 - INFO - FSW connection closed
2025-07-02 14:22:58,776 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:22:58,776 - INFO - Socket closed
2025-07-02 14:22:58,776 - INFO - VSG connection closed
2025-07-02 14:22:58,777 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:22:58,805 - INFO - Socket closed
2025-07-02 14:22:58,814 - INFO - Socket closed
2025-07-02 14:23:54,068 - INFO - Starting RF measurement script
2025-07-02 14:23:54,072 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:23:54,072 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:23:54,073 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:23:54,077 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:23:54,078 - INFO - Query: *IDN?
2025-07-02 14:23:54,079 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:23:54,082 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:23:54,082 - INFO - Query: *IDN?
2025-07-02 14:23:54,083 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:23:54,083 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:23:54,083 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:23:54,083 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:23:54,083 - INFO - Query: *RST;*OPC?
2025-07-02 14:23:55,131 - INFO - Response: 1
2025-07-02 14:23:55,131 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:23:55,132 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:23:55,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:23:55,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:23:55,133 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:23:55,133 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:23:55,133 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:23:55,133 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:23:55,134 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:23:55,134 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:23:55,134 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:23:55,134 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:23:55,134 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:23:55,135 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:23:55,135 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:23:55,136 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:23:55,136 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:23:57,959 - INFO - Response: 1
2025-07-02 14:23:57,960 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL 0
2025-07-02 14:23:57,960 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:23:57,961 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:23:57,961 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:23:57,962 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:23:57,962 - INFO - Query: *RST;*OPC?
2025-07-02 14:23:58,159 - INFO - Response: 1
2025-07-02 14:23:58,160 - INFO - FSW reset for spur search
2025-07-02 14:23:58,160 - INFO - Write: INIT:CONT OFF
2025-07-02 14:23:58,160 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:23:58,160 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:23:58,161 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:23:58,161 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:23:58,161 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:23:58,161 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:23:58,161 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:23:58,161 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:23:58,162 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:23:58,162 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:23:58,162 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:23:58,162 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:23:58,162 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:23:58,162 - INFO - Write: :INP:ATT 0
2025-07-02 14:23:58,162 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:23:58,163 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:23:58,163 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:23:58,163 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:23:58,163 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:23:58,163 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:23:58,163 - INFO - Write: CALC1:THR -122
2025-07-02 14:23:58,163 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:23:58,164 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:23:58,164 - INFO - Spur detection table configured
2025-07-02 14:23:58,164 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:23:58,164 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:23:58,164 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:24:02,668 - INFO - Response: 1
2025-07-02 14:24:02,669 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:24:02,669 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:24:02,671 - INFO - Response: 50
2025-07-02 14:24:02,671 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:24:02,672 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:24:02,723 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2441800000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2973700000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 14:24:02,724 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:24:02,725 - INFO - Response: -70.1590423584,-54.9404029846,-69.6622390747,-67.9987487793,-47.8978424072,-85.056854248,-81.9761657715,-62.7832565308,-85.5432357788,-76.2393188477,-81.2415618896,-83.4202423096,-70.8923187256,-77.2732849121,-36.3419036865,-77.338508606,-67.474822998,-70.7249832153,-73.4195251465,-70.7644729614,-78.2287368774,-71.1895828247,-83.1611557007,-81.3641357422,-82.6467971802,-51.9592285156,-72.6447219849,-77.151802063,-81.3818435669,-79.3347702026,-40.4995994568,-68.2004318237,-84.6864929199,-66.5204391479,-82.7456741333,-76.7916641235,-50.9451141357,-54.6161384583,-85.0466384888,-79.8520202637,-68.7681655884,-84.5377349854,-65.5077972412,-69.566696167,-57.2488212585,-77.2886810303,-81.0943908691,-86.526473999,-82.6582794189,-48.5157089233
2025-07-02 14:24:02,726 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:24:02,726 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:03,791 - INFO - Response: 1
2025-07-02 14:24:03,792 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:24:03,792 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:03,792 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:03,793 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:03,793 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:03,794 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:03,794 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:03,795 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:03,795 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:03,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:03,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:03,796 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:03,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:03,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:03,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:03,797 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:03,797 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:06,664 - INFO - Response: 1
2025-07-02 14:24:06,664 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL 0
2025-07-02 14:24:06,664 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:24:06,665 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:24:06,665 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:24:06,665 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:24:06,665 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:06,853 - INFO - Response: 1
2025-07-02 14:24:06,854 - INFO - FSW reset for spur search
2025-07-02 14:24:06,854 - INFO - Write: INIT:CONT OFF
2025-07-02 14:24:06,854 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:24:06,854 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:24:06,854 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:24:06,854 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:24:06,854 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:24:06,854 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:24:06,854 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:24:06,854 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:24:06,854 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:24:06,854 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:24:06,854 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:24:06,855 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:24:06,855 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:24:06,855 - INFO - Write: :INP:ATT 0
2025-07-02 14:24:06,855 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:24:06,855 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:24:06,855 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:24:06,855 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:24:06,855 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:24:06,855 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:24:06,855 - INFO - Write: CALC1:THR -122
2025-07-02 14:24:06,855 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:24:06,855 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:24:06,855 - INFO - Spur detection table configured
2025-07-02 14:24:06,855 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:24:06,856 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:24:06,856 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:24:11,353 - INFO - Response: 1
2025-07-02 14:24:11,353 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:24:11,354 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:24:11,355 - INFO - Response: 50
2025-07-02 14:24:11,355 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:24:11,355 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:24:11,400 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2435400000,2439100000,2448200000,2451900000,2457400000,2470200000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4319400000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:24:11,400 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:24:11,402 - INFO - Response: -70.7347412109,-54.6589164734,-70.0602722168,-68.383026123,-47.9846763611,-83.845413208,-82.174659729,-62.7802886963,-86.7773284912,-75.5717849731,-81.2523269653,-86.3791885376,-82.7671661377,-70.9969787598,-83.1232910156,-87.2507781982,-36.3780021667,-74.24609375,-77.2879943848,-66.5379333496,-66.3022232056,-71.7964401245,-52.0326004028,-78.6498413086,-71.3590316772,-82.9916229248,-82.5276565552,-47.2483634949,-70.3018875122,-44.5382156372,-69.1994094849,-82.5940704346,-65.987701416,-83.9123916626,-81.0335464478,-86.4028091431,-50.3110771179,-55.0160675049,-80.5542602539,-67.0435333252,-86.7904129028,-65.3805999756,-69.0143203735,-57.6525535583,-87.3019104004,-77.0714111328,-80.899810791,-86.9489746094,-84.5378494263,-49.3965644836
2025-07-02 14:24:11,402 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:24:11,402 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:13,118 - INFO - Response: 1
2025-07-02 14:24:13,118 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:24:13,118 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:13,118 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:13,118 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:13,118 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:13,119 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:13,119 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:13,119 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:15,977 - INFO - Socket closed
2025-07-02 14:24:15,987 - INFO - Socket closed
2025-07-02 14:24:18,348 - INFO - Starting RF measurement script
2025-07-02 14:24:18,350 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:24:18,350 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:24:18,350 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:24:18,355 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:24:18,356 - INFO - Query: *IDN?
2025-07-02 14:24:18,357 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:24:18,361 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:24:18,361 - INFO - Query: *IDN?
2025-07-02 14:24:18,362 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:24:18,362 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:24:18,362 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:24:18,362 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:24:18,362 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:19,406 - INFO - Response: 1
2025-07-02 14:24:19,407 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:24:19,407 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:19,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:19,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:19,407 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:19,407 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:19,408 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:19,408 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:22,293 - INFO - Response: 1
2025-07-02 14:24:22,293 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL 0
2025-07-02 14:24:22,294 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:24:22,294 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:24:22,294 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:24:22,294 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:24:22,294 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:22,483 - INFO - Response: 1
2025-07-02 14:24:22,483 - INFO - FSW reset for spur search
2025-07-02 14:24:22,484 - INFO - Write: INIT:CONT OFF
2025-07-02 14:24:22,484 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:24:22,484 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:24:22,484 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:24:22,484 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:24:22,484 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:24:22,484 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:24:22,485 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:24:22,485 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:24:22,485 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:24:22,485 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:24:22,486 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:24:22,486 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:24:22,486 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:24:22,486 - INFO - Write: :INP:ATT 0
2025-07-02 14:24:22,486 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:24:22,486 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:24:22,486 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:24:22,487 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:24:22,487 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:24:22,487 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:24:22,487 - INFO - Write: CALC1:THR -122
2025-07-02 14:24:22,487 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:24:22,487 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:24:22,487 - INFO - Spur detection table configured
2025-07-02 14:24:22,487 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:24:22,487 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:24:22,487 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:24:26,979 - INFO - Response: 1
2025-07-02 14:24:26,979 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:24:26,979 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:24:26,981 - INFO - Response: 50
2025-07-02 14:24:26,981 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:24:26,981 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:24:27,027 - INFO - Response: 1230500000,1430900000,1600300000,1800600000,1829800000,1860800000,1999200000,2030200000,2059300000,2199600000,2230500000,2399900000,2412700000,2418200000,2429100000,2438200000,2447300000,2458200000,2467300000,2476500000,2629500000,2660400000,2800700000,2829800000,2975600000,2986500000,2995600000,3006500000,3012000000,3019300000,3030200000,3059400000,3230600000,3259700000,3400000000,3429100000,3629500000,3660500000,3689600000,3829900000,3860900000,3999300000,4030300000,4230600000,4259800000,4460200000,4629600000,4660500000,4829900000,4859100000
2025-07-02 14:24:27,027 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:24:27,029 - INFO - Response: -69.9803237915,-54.9131278992,-69.7968826294,-68.0529556274,-47.8694953918,-85.1431884766,-81.7258682251,-62.6686935425,-85.3217391968,-76.1895294189,-81.3744125366,-83.3789215088,-70.8897247314,-77.3357162476,-36.3459472656,-77.1627349854,-67.4934310913,-70.7307052612,-73.1003112793,-70.8007507324,-77.7983016968,-71.2463378906,-83.1495056152,-81.1594467163,-82.3731460571,-51.9739646912,-71.9859085083,-77.0171585083,-81.5139083862,-79.0694274902,-40.4965057373,-68.2312774658,-84.5222396851,-66.6618118286,-82.68775177,-76.6596679688,-50.9480361938,-54.6282958984,-85.0712280273,-80.5178375244,-68.8404388428,-84.5292205811,-65.5268325806,-69.5585632324,-57.2294311523,-77.2449493408,-81.1182174683,-86.5341415405,-82.6877746582,-48.5074043274
2025-07-02 14:24:27,029 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:24:27,029 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:28,084 - INFO - Response: 1
2025-07-02 14:24:28,085 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:24:28,085 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:28,086 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:28,086 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:28,086 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:28,087 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:28,087 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:28,087 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:28,087 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:28,088 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:28,088 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:28,088 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:28,088 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:28,089 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:28,089 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:28,089 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:28,089 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:30,923 - INFO - Response: 1
2025-07-02 14:24:30,923 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL 0
2025-07-02 14:24:30,923 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:24:30,923 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:24:30,923 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:24:30,923 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:24:30,923 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:31,112 - INFO - Response: 1
2025-07-02 14:24:31,112 - INFO - FSW reset for spur search
2025-07-02 14:24:31,112 - INFO - Write: INIT:CONT OFF
2025-07-02 14:24:31,112 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:24:31,112 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:24:31,112 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:24:31,112 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:24:31,112 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:24:31,112 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:24:31,112 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:24:31,113 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:24:31,113 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:24:31,113 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:24:31,113 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:24:31,113 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:24:31,113 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:24:31,113 - INFO - Write: :INP:ATT 0
2025-07-02 14:24:31,113 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:24:31,113 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:24:31,113 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:24:31,113 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:24:31,113 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:24:31,113 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:24:31,113 - INFO - Write: CALC1:THR -122
2025-07-02 14:24:31,113 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:24:31,113 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:24:31,113 - INFO - Spur detection table configured
2025-07-02 14:24:31,113 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:24:31,114 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:24:31,114 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:24:35,679 - INFO - Response: 1
2025-07-02 14:24:35,680 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:24:35,680 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:24:35,681 - INFO - Response: 50
2025-07-02 14:24:35,681 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:24:35,681 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:24:35,736 - INFO - Response: 1239200000,1440400000,1599500000,1800700000,1839100000,1879400000,2000100000,2040300000,2080600000,2199500000,2239700000,2400700000,2419000000,2422600000,2428100000,2439100000,2448200000,2451900000,2457400000,2470200000,2473800000,2477500000,2486600000,2640300000,2680500000,2799400000,2839700000,2989600000,3015200000,3040900000,3079300000,3240200000,3280500000,3399400000,3439600000,3600600000,3640800000,3679200000,3840200000,3880400000,3920600000,4039500000,4240700000,4279100000,4319400000,4480300000,4639500000,4679700000,4840700000,4879100000
2025-07-02 14:24:35,737 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:24:35,738 - INFO - Response: -70.4691238403,-54.6555671692,-70.1367034912,-68.2866897583,-48.0370292664,-83.8020553589,-82.38306427,-62.8078727722,-86.8535919189,-75.5161437988,-81.3075180054,-86.5681381226,-82.8119506836,-70.5941467285,-80.7474594116,-36.3599815369,-74.9866256714,-76.9800186157,-66.5204162598,-67.1384429932,-86.9962921143,-71.9590835571,-52.0666465759,-78.4552612305,-71.3795166016,-82.8826904297,-82.9113464355,-47.2578239441,-70.2173461914,-44.5377922058,-68.9365615845,-82.6899414062,-66.1402740479,-83.8177719116,-80.5138931274,-86.2841720581,-50.2634849548,-55.0404853821,-80.3064422607,-66.9930343628,-86.7622146606,-65.358253479,-68.8822784424,-57.7170715332,-87.3414001465,-77.3590011597,-80.9394683838,-86.8189926147,-84.5723114014,-49.3918685913
2025-07-02 14:24:35,738 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:24:35,738 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:36,788 - INFO - Response: 1
2025-07-02 14:24:36,788 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:24:36,789 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:36,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:36,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:36,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:36,790 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:36,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:36,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:36,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:36,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:36,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:36,791 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:36,791 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:36,791 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:36,791 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:36,791 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:36,792 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:39,654 - INFO - Response: 1
2025-07-02 14:24:39,654 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL 0
2025-07-02 14:24:39,654 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:24:39,654 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:24:39,655 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:24:39,655 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:24:39,655 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:39,842 - INFO - Response: 1
2025-07-02 14:24:39,842 - INFO - FSW reset for spur search
2025-07-02 14:24:39,843 - INFO - Write: INIT:CONT OFF
2025-07-02 14:24:39,843 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:24:39,843 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:24:39,843 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:24:39,843 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:24:39,844 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:24:39,844 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:24:39,844 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:24:39,844 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:24:39,844 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:24:39,844 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:24:39,844 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:24:39,845 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:24:39,845 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:24:39,845 - INFO - Write: :INP:ATT 0
2025-07-02 14:24:39,845 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:24:39,845 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:24:39,845 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:24:39,846 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:24:39,846 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:24:39,846 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:24:39,846 - INFO - Write: CALC1:THR -122
2025-07-02 14:24:39,846 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:24:39,846 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:24:39,846 - INFO - Spur detection table configured
2025-07-02 14:24:39,847 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:24:39,847 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:24:39,847 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:24:44,381 - INFO - Socket closed
2025-07-02 14:24:44,390 - INFO - Socket closed
2025-07-02 14:24:45,730 - INFO - Starting RF measurement script
2025-07-02 14:24:45,733 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:24:45,734 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:24:45,734 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:24:45,740 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:24:45,740 - INFO - Query: *IDN?
2025-07-02 14:24:45,741 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:24:45,744 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:24:45,744 - INFO - Query: *IDN?
2025-07-02 14:24:45,745 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:24:45,745 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:24:45,745 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:24:45,745 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:24:45,745 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:46,798 - INFO - Response: 1
2025-07-02 14:24:46,798 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:24:46,798 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:46,799 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:46,799 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:46,799 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:46,799 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:46,799 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:46,800 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:46,800 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:46,800 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:46,800 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:46,800 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:46,800 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:46,801 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:46,801 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:46,801 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:46,801 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:49,627 - INFO - Response: 1
2025-07-02 14:24:49,628 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:24:49,628 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:24:49,628 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:24:49,628 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:24:49,628 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:24:49,629 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:49,817 - INFO - Response: 1
2025-07-02 14:24:49,817 - INFO - FSW reset for spur search
2025-07-02 14:24:49,817 - INFO - Write: INIT:CONT OFF
2025-07-02 14:24:49,818 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:24:49,818 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:24:49,818 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:24:49,818 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:24:49,818 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:24:49,818 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:24:49,818 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:24:49,819 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:24:49,819 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:24:49,819 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:24:49,819 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:24:49,819 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:24:49,819 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:24:49,819 - INFO - Write: :INP:ATT 0
2025-07-02 14:24:49,819 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:24:49,819 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:24:49,820 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:24:49,820 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:24:49,820 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:24:49,820 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:24:49,820 - INFO - Write: CALC1:THR -122
2025-07-02 14:24:49,821 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:24:49,821 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:24:49,821 - INFO - Spur detection table configured
2025-07-02 14:24:49,821 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:24:49,821 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:24:49,821 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:24:54,249 - INFO - Response: 1
2025-07-02 14:24:54,250 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:24:54,250 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:24:54,251 - INFO - Response: 5
2025-07-02 14:24:54,251 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:24:54,252 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:24:54,306 - INFO - Response: 1430900000,2429100000,3030200000,3429100000,3962900000
2025-07-02 14:24:54,306 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:24:54,307 - INFO - Response: -116.106781006,-94.2096252441,-96.6943740845,-120.261604309,-121.387695312
2025-07-02 14:24:54,307 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:24:54,308 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:55,358 - INFO - Response: 1
2025-07-02 14:24:55,359 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:24:55,359 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:24:55,360 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:24:55,360 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:24:55,361 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:24:55,361 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:24:55,361 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:24:55,361 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:24:55,361 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:24:55,362 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:24:55,362 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:24:55,362 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:24:55,362 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:24:55,362 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:24:55,363 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:24:55,363 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:24:55,363 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:24:58,215 - INFO - Response: 1
2025-07-02 14:24:58,215 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:24:58,215 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:24:58,216 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:24:58,216 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:24:58,216 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:24:58,217 - INFO - Query: *RST;*OPC?
2025-07-02 14:24:58,404 - INFO - Response: 1
2025-07-02 14:24:58,404 - INFO - FSW reset for spur search
2025-07-02 14:24:58,404 - INFO - Write: INIT:CONT OFF
2025-07-02 14:24:58,404 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:24:58,404 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:24:58,404 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:24:58,405 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:24:58,405 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:24:58,405 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:24:58,405 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:24:58,405 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:24:58,406 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:24:58,406 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:24:58,406 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:24:58,406 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:24:58,406 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:24:58,406 - INFO - Write: :INP:ATT 0
2025-07-02 14:24:58,406 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:24:58,407 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:24:58,407 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:24:58,407 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:24:58,407 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:24:58,407 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:24:58,407 - INFO - Write: CALC1:THR -122
2025-07-02 14:24:58,408 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:24:58,408 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:24:58,408 - INFO - Spur detection table configured
2025-07-02 14:24:58,408 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:24:58,408 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:24:58,408 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:25:02,821 - INFO - Response: 1
2025-07-02 14:25:02,822 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:25:02,822 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:25:02,823 - INFO - Response: 5
2025-07-02 14:25:02,823 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:25:02,824 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:25:02,873 - INFO - Response: 1440400000,2439100000,3040900000,3439600000,3768800000
2025-07-02 14:25:02,873 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:25:02,874 - INFO - Response: -115.966659546,-93.9549179077,-96.6670455933,-121.00920105,-121.775566101
2025-07-02 14:25:02,874 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:25:02,875 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:03,925 - INFO - Response: 1
2025-07-02 14:25:03,925 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:25:03,926 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:25:03,926 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:25:03,926 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:25:03,926 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:25:03,927 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:25:03,927 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:25:03,927 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:25:03,927 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:25:03,927 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:25:03,927 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:25:03,928 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:25:03,928 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:25:03,928 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:25:03,928 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:25:03,928 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:25:03,929 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:25:06,780 - INFO - Response: 1
2025-07-02 14:25:06,780 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:25:06,781 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:25:06,781 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:25:06,781 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:25:06,781 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:25:06,782 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:06,972 - INFO - Response: 1
2025-07-02 14:25:06,972 - INFO - FSW reset for spur search
2025-07-02 14:25:06,972 - INFO - Write: INIT:CONT OFF
2025-07-02 14:25:06,973 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:25:06,973 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:25:06,973 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:25:06,973 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:25:06,973 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:25:06,973 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:25:06,973 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:25:06,974 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:25:06,974 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:25:06,974 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:25:06,974 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:25:06,974 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:25:06,974 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:25:06,974 - INFO - Write: :INP:ATT 0
2025-07-02 14:25:06,974 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:25:06,975 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:25:06,975 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:25:06,975 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:25:06,975 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:25:06,975 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:25:06,975 - INFO - Write: CALC1:THR -122
2025-07-02 14:25:06,975 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:25:06,975 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:25:06,976 - INFO - Spur detection table configured
2025-07-02 14:25:06,976 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:25:06,976 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:25:06,976 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:25:11,396 - INFO - Response: 1
2025-07-02 14:25:11,396 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:25:11,396 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:25:11,398 - INFO - Response: 5
2025-07-02 14:25:11,398 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:25:11,398 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:25:11,454 - INFO - Response: 1430900000,2429100000,3030200000,3429100000,3900900000
2025-07-02 14:25:11,455 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:25:11,456 - INFO - Response: -115.876213074,-94.2166900635,-96.7080612183,-119.97808075,-121.536613464
2025-07-02 14:25:11,456 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:25:11,456 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:12,514 - INFO - Response: 1
2025-07-02 14:25:12,515 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:25:12,515 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:25:12,515 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:25:12,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:25:12,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:25:12,517 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:25:12,517 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:25:12,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:25:12,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:25:12,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:25:12,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:25:12,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 14:25:12,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:25:12,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:25:12,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:25:12,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:25:12,520 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:25:15,344 - INFO - Response: 1
2025-07-02 14:25:15,344 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:25:15,345 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:25:15,345 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:25:15,345 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:25:15,345 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:25:15,345 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:15,539 - INFO - Response: 1
2025-07-02 14:25:15,540 - INFO - FSW reset for spur search
2025-07-02 14:25:15,540 - INFO - Write: INIT:CONT OFF
2025-07-02 14:25:15,540 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:25:15,540 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:25:15,540 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:25:15,541 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:25:15,541 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:25:15,541 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:25:15,541 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:25:15,541 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:25:15,541 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:25:15,541 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:25:15,541 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:25:15,541 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:25:15,541 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:25:15,542 - INFO - Write: :INP:ATT 0
2025-07-02 14:25:15,542 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:25:15,542 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:25:15,542 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:25:15,542 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:25:15,542 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:25:15,542 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:25:15,542 - INFO - Write: CALC1:THR -122
2025-07-02 14:25:15,542 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:25:15,543 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:25:15,543 - INFO - Spur detection table configured
2025-07-02 14:25:15,543 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:25:15,543 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:25:15,543 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:25:19,955 - INFO - Response: 1
2025-07-02 14:25:19,955 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:25:19,956 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:25:19,957 - INFO - Response: 5
2025-07-02 14:25:19,957 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:25:19,958 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:25:19,999 - INFO - Response: 1440400000,2439100000,3040900000,3439600000,3913300000
2025-07-02 14:25:20,000 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:25:20,001 - INFO - Response: -116.291770935,-93.97265625,-96.6773910522,-120.200866699,-121.031661987
2025-07-02 14:25:20,001 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:25:20,007 - INFO - Socket closed
2025-07-02 14:25:20,007 - INFO - FSW connection closed
2025-07-02 14:25:20,007 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:25:20,007 - INFO - Socket closed
2025-07-02 14:25:20,008 - INFO - VSG connection closed
2025-07-02 14:25:20,012 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:25:20,061 - INFO - Socket closed
2025-07-02 14:25:20,070 - INFO - Socket closed
2025-07-02 14:25:28,875 - INFO - Starting RF measurement script
2025-07-02 14:25:28,879 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:25:28,880 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:25:28,880 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:25:28,889 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:25:28,889 - INFO - Query: *IDN?
2025-07-02 14:25:28,890 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:25:28,894 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:25:28,894 - INFO - Query: *IDN?
2025-07-02 14:25:28,895 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:25:28,896 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:25:28,896 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:25:28,896 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:25:28,896 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:29,947 - INFO - Response: 1
2025-07-02 14:25:29,948 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:25:29,948 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:25:29,948 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:25:29,948 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:25:29,948 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:25:29,949 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:25:29,949 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:25:29,950 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:25:29,950 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:25:29,950 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:25:32,761 - INFO - Response: 1
2025-07-02 14:25:32,762 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:25:32,762 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:25:32,763 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:25:32,763 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:25:32,763 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:25:32,763 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:32,954 - INFO - Response: 1
2025-07-02 14:25:32,954 - INFO - FSW reset for spur search
2025-07-02 14:25:32,955 - INFO - Write: INIT:CONT OFF
2025-07-02 14:25:32,955 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:25:32,955 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:25:32,955 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:25:32,955 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:25:32,956 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:25:32,956 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:25:32,956 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:25:32,956 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:25:32,956 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:25:32,956 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:25:32,957 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:25:32,957 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:25:32,957 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:25:32,957 - INFO - Write: :INP:ATT 0
2025-07-02 14:25:32,957 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:25:32,957 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:25:32,957 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:25:32,958 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:25:32,958 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:25:32,958 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:25:32,958 - INFO - Write: CALC1:THR -122
2025-07-02 14:25:32,958 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:25:32,958 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:25:32,958 - INFO - Spur detection table configured
2025-07-02 14:25:32,958 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:25:32,959 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:25:32,959 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:25:37,371 - INFO - Response: 1
2025-07-02 14:25:37,371 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:25:37,371 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:25:37,373 - INFO - Response: 5
2025-07-02 14:25:37,373 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:25:37,373 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:25:37,423 - INFO - Response: 1430900000,2429100000,3030200000,3429100000,3992000000
2025-07-02 14:25:37,424 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:25:37,425 - INFO - Response: -115.953887939,-94.2557678223,-96.7155761719,-116.366226196,-121.800193787
2025-07-02 14:25:37,425 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:25:37,426 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:38,485 - INFO - Response: 1
2025-07-02 14:25:38,486 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:25:38,486 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:25:38,486 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:25:38,487 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:25:38,487 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:25:38,487 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:25:38,487 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:25:38,487 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:25:38,488 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:25:38,488 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:25:38,488 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:25:38,488 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:25:38,488 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:25:38,489 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:25:38,489 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:25:38,489 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:25:38,489 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:25:41,323 - INFO - Response: 1
2025-07-02 14:25:41,324 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:25:41,324 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:25:41,324 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:25:41,324 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:25:41,325 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:25:41,325 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:41,515 - INFO - Response: 1
2025-07-02 14:25:41,515 - INFO - FSW reset for spur search
2025-07-02 14:25:41,515 - INFO - Write: INIT:CONT OFF
2025-07-02 14:25:41,515 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:25:41,516 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:25:41,516 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:25:41,516 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:25:41,516 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:25:41,516 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:25:41,516 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:25:41,516 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:25:41,517 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:25:41,517 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:25:41,517 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:25:41,517 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:25:41,517 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:25:41,517 - INFO - Write: :INP:ATT 0
2025-07-02 14:25:41,517 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:25:41,518 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:25:41,518 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:25:41,518 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:25:41,518 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:25:41,519 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:25:41,519 - INFO - Write: CALC1:THR -122
2025-07-02 14:25:41,519 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:25:41,519 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:25:41,519 - INFO - Spur detection table configured
2025-07-02 14:25:41,519 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:25:41,519 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:25:41,519 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:25:45,939 - INFO - Response: 1
2025-07-02 14:25:45,940 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:25:45,940 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:25:45,941 - INFO - Response: 5
2025-07-02 14:25:45,942 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:25:45,942 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:25:45,996 - INFO - Response: 1440400000,2439100000,3040900000,3439600000,3874900000
2025-07-02 14:25:45,996 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:25:45,997 - INFO - Response: -115.898330688,-93.9421539307,-96.7060394287,-116.333900452,-121.801429749
2025-07-02 14:25:45,998 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:25:45,998 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:47,056 - INFO - Response: 1
2025-07-02 14:25:47,056 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:25:47,057 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:25:47,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:25:47,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:25:47,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:25:47,057 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:25:47,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:25:47,057 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:25:47,058 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:25:47,058 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:25:47,058 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:25:47,059 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:25:47,059 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:25:47,059 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:25:47,059 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:25:47,059 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:25:47,060 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:25:49,887 - INFO - Response: 1
2025-07-02 14:25:49,887 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:25:49,888 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:25:49,888 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:25:49,888 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:25:49,888 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:25:49,888 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:50,079 - INFO - Response: 1
2025-07-02 14:25:50,079 - INFO - FSW reset for spur search
2025-07-02 14:25:50,079 - INFO - Write: INIT:CONT OFF
2025-07-02 14:25:50,080 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:25:50,080 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:25:50,080 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:25:50,080 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:25:50,080 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:25:50,080 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:25:50,081 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:25:50,081 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:25:50,081 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:25:50,081 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:25:50,081 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:25:50,081 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:25:50,081 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:25:50,082 - INFO - Write: :INP:ATT 0
2025-07-02 14:25:50,082 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:25:50,082 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:25:50,082 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:25:50,082 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:25:50,082 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:25:50,083 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:25:50,083 - INFO - Write: CALC1:THR -122
2025-07-02 14:25:50,083 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:25:50,083 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:25:50,083 - INFO - Spur detection table configured
2025-07-02 14:25:50,083 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:25:50,083 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:25:50,083 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:25:54,503 - INFO - Response: 1
2025-07-02 14:25:54,503 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:25:54,503 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:25:54,506 - INFO - Response: 5
2025-07-02 14:25:54,506 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:25:54,507 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:25:54,562 - INFO - Response: 1430900000,2429100000,3030200000,3429100000,3999300000
2025-07-02 14:25:54,563 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:25:54,563 - INFO - Response: -115.986785889,-94.2242889404,-96.6531295776,-116.227546692,-121.737937927
2025-07-02 14:25:54,564 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:25:54,564 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:55,617 - INFO - Response: 1
2025-07-02 14:25:55,617 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:25:55,617 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:25:55,617 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:25:55,618 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:25:55,618 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:25:55,618 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:25:55,618 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:25:55,618 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:25:55,618 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:25:55,618 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:25:55,619 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:25:55,619 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:25:55,619 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:25:55,619 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:25:55,619 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:25:55,619 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:25:55,619 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:25:58,455 - INFO - Response: 1
2025-07-02 14:25:58,455 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:25:58,455 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:25:58,456 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:25:58,456 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:25:58,456 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:25:58,456 - INFO - Query: *RST;*OPC?
2025-07-02 14:25:58,653 - INFO - Response: 1
2025-07-02 14:25:58,653 - INFO - FSW reset for spur search
2025-07-02 14:25:58,653 - INFO - Write: INIT:CONT OFF
2025-07-02 14:25:58,654 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:25:58,654 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:25:58,654 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:25:58,654 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:25:58,654 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:25:58,654 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:25:58,655 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:25:58,655 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:25:58,655 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:25:58,655 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:25:58,655 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:25:58,655 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:25:58,656 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:25:58,656 - INFO - Write: :INP:ATT 0
2025-07-02 14:25:58,656 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:25:58,656 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:25:58,656 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:25:58,656 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:25:58,656 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:25:58,657 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:25:58,657 - INFO - Write: CALC1:THR -122
2025-07-02 14:25:58,657 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:25:58,657 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:25:58,657 - INFO - Spur detection table configured
2025-07-02 14:25:58,657 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:25:58,657 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:25:58,658 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:26:03,076 - INFO - Response: 1
2025-07-02 14:26:03,077 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:26:03,077 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:26:03,078 - INFO - Response: 4
2025-07-02 14:26:03,078 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:26:03,078 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:26:03,124 - INFO - Response: 1440400000,2439100000,3040900000,3439600000
2025-07-02 14:26:03,124 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:26:03,125 - INFO - Response: -115.915817261,-93.9695587158,-96.7247695923,-116.322372437
2025-07-02 14:26:03,125 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:26:03,127 - INFO - Socket closed
2025-07-02 14:26:03,127 - INFO - FSW connection closed
2025-07-02 14:26:03,127 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:26:03,127 - INFO - Socket closed
2025-07-02 14:26:03,128 - INFO - VSG connection closed
2025-07-02 14:26:03,129 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:26:03,174 - INFO - Socket closed
2025-07-02 14:26:03,182 - INFO - Socket closed
2025-07-02 14:26:19,141 - INFO - Starting RF measurement script
2025-07-02 14:26:19,143 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:26:19,143 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:26:19,144 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:26:19,148 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:26:19,149 - INFO - Query: *IDN?
2025-07-02 14:26:19,150 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:26:19,153 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:26:19,153 - INFO - Query: *IDN?
2025-07-02 14:26:19,154 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:26:19,154 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:26:19,154 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:26:19,155 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:26:19,155 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:20,205 - INFO - Response: 1
2025-07-02 14:26:20,206 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:26:20,206 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:26:20,206 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:26:20,206 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:26:20,206 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:26:20,207 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:26:20,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:26:20,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:26:20,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:26:20,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:26:20,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:26:20,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:26:20,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:26:20,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:26:20,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:26:20,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:26:20,208 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:26:23,037 - INFO - Response: 1
2025-07-02 14:26:23,037 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:26:23,038 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:26:23,038 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:26:23,038 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:26:23,038 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:26:23,039 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:23,232 - INFO - Response: 1
2025-07-02 14:26:23,232 - INFO - FSW reset for spur search
2025-07-02 14:26:23,233 - INFO - Write: INIT:CONT OFF
2025-07-02 14:26:23,233 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:26:23,233 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:26:23,233 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:26:23,233 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:26:23,234 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:26:23,234 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:26:23,234 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:26:23,234 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:26:23,234 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:26:23,234 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:26:23,235 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:26:23,235 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:26:23,235 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:26:23,235 - INFO - Write: :INP:ATT 0
2025-07-02 14:26:23,235 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:26:23,235 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:26:23,235 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:26:23,235 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:26:23,236 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:26:23,236 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:26:23,236 - INFO - Write: CALC1:THR -122
2025-07-02 14:26:23,236 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:26:23,236 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:26:23,236 - INFO - Spur detection table configured
2025-07-02 14:26:23,236 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:26:23,236 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:26:23,236 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:26:27,678 - INFO - Response: 1
2025-07-02 14:26:27,679 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:26:27,679 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:26:27,680 - INFO - Response: 5
2025-07-02 14:26:27,680 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:26:27,681 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:26:27,730 - INFO - Response: 1430900000,2429100000,3030200000,3429100000,4017500000
2025-07-02 14:26:27,731 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:26:27,732 - INFO - Response: -115.865386963,-94.242401123,-96.7122955322,-116.210540771,-121.06552887
2025-07-02 14:26:27,733 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:26:27,733 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:28,786 - INFO - Response: 1
2025-07-02 14:26:28,786 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:26:28,786 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:26:28,787 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:26:28,788 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:26:28,788 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:26:28,788 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:26:28,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:26:28,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:26:28,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:26:28,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:26:28,789 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:26:28,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:26:28,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:26:28,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:26:28,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:26:28,790 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:26:28,791 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:26:31,648 - INFO - Response: 1
2025-07-02 14:26:31,649 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:26:31,649 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:26:31,649 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:26:31,649 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:26:31,650 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:26:31,650 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:31,842 - INFO - Response: 1
2025-07-02 14:26:31,842 - INFO - FSW reset for spur search
2025-07-02 14:26:31,843 - INFO - Write: INIT:CONT OFF
2025-07-02 14:26:31,843 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:26:31,843 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:26:31,844 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:26:31,844 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:26:31,844 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:26:31,844 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:26:31,844 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:26:31,845 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:26:31,845 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:26:31,845 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:26:31,845 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:26:31,845 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:26:31,845 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:26:31,845 - INFO - Write: :INP:ATT 0
2025-07-02 14:26:31,845 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:26:31,845 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:26:31,846 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:26:31,846 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:26:31,846 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:26:31,846 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:26:31,846 - INFO - Write: CALC1:THR -122
2025-07-02 14:26:31,846 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:26:31,846 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:26:31,846 - INFO - Spur detection table configured
2025-07-02 14:26:31,846 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:26:31,846 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:26:31,846 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:26:36,262 - INFO - Response: 1
2025-07-02 14:26:36,262 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:26:36,262 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:26:36,264 - INFO - Response: 4
2025-07-02 14:26:36,264 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:26:36,264 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:26:36,311 - INFO - Response: 1440400000,2439100000,3040900000,3439600000
2025-07-02 14:26:36,311 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:26:36,312 - INFO - Response: -116.182746887,-93.951675415,-96.6929779053,-116.350273132
2025-07-02 14:26:36,312 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:26:36,312 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:37,363 - INFO - Response: 1
2025-07-02 14:26:37,363 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:26:37,363 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:26:37,364 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:26:37,364 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:26:37,365 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:26:37,365 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:26:37,365 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:26:37,366 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:26:37,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:26:37,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:26:37,367 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:26:37,368 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:26:37,368 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:26:37,368 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:26:37,368 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:26:37,368 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:26:37,368 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:26:40,192 - INFO - Response: 1
2025-07-02 14:26:40,192 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:26:40,192 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:26:40,193 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:26:40,193 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:26:40,193 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:26:40,193 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:40,388 - INFO - Response: 1
2025-07-02 14:26:40,389 - INFO - FSW reset for spur search
2025-07-02 14:26:40,389 - INFO - Write: INIT:CONT OFF
2025-07-02 14:26:40,389 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:26:40,389 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:26:40,390 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:26:40,390 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:26:40,390 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:26:40,390 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:26:40,390 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:26:40,390 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:26:40,391 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:26:40,391 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:26:40,391 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:26:40,391 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:26:40,391 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:26:40,391 - INFO - Write: :INP:ATT 0
2025-07-02 14:26:40,392 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:26:40,392 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:26:40,392 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:26:40,392 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:26:40,392 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:26:40,392 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:26:40,393 - INFO - Write: CALC1:THR -122
2025-07-02 14:26:40,393 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:26:40,393 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:26:40,393 - INFO - Spur detection table configured
2025-07-02 14:26:40,393 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:26:40,393 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:26:40,393 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:26:44,805 - INFO - Response: 1
2025-07-02 14:26:44,806 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:26:44,806 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:26:44,807 - INFO - Response: 5
2025-07-02 14:26:44,808 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:26:44,808 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:26:44,855 - INFO - Response: 1430900000,2429100000,3030200000,3429100000,3964700000
2025-07-02 14:26:44,856 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:26:44,857 - INFO - Response: -116.043914795,-94.2271652222,-96.6848907471,-116.296722412,-121.452186584
2025-07-02 14:26:44,857 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:26:44,857 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:45,912 - INFO - Response: 1
2025-07-02 14:26:45,912 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:26:45,912 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:26:45,913 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:26:45,913 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:26:45,913 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:26:45,913 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:26:45,913 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:26:45,914 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:26:45,914 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:26:45,914 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:26:45,915 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:26:45,915 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:26:45,915 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:26:45,915 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:26:45,915 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:26:45,916 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:26:45,916 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:26:48,773 - INFO - Response: 1
2025-07-02 14:26:48,774 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:26:48,774 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:26:48,774 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:26:48,774 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:26:48,774 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:26:48,775 - INFO - Query: *RST;*OPC?
2025-07-02 14:26:48,966 - INFO - Response: 1
2025-07-02 14:26:48,966 - INFO - FSW reset for spur search
2025-07-02 14:26:48,967 - INFO - Write: INIT:CONT OFF
2025-07-02 14:26:48,967 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:26:48,967 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:26:48,967 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:26:48,967 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:26:48,968 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:26:48,968 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:26:48,968 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:26:48,968 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:26:48,968 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:26:48,968 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:26:48,968 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:26:48,969 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:26:48,969 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:26:48,969 - INFO - Write: :INP:ATT 0
2025-07-02 14:26:48,969 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:26:48,969 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:26:48,970 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:26:48,970 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:26:48,970 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:26:48,970 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:26:48,970 - INFO - Write: CALC1:THR -122
2025-07-02 14:26:48,971 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:26:48,971 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:26:48,971 - INFO - Spur detection table configured
2025-07-02 14:26:48,971 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:26:48,971 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:26:48,971 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:26:53,379 - INFO - Response: 1
2025-07-02 14:26:53,379 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:26:53,379 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:26:53,382 - INFO - Response: 4
2025-07-02 14:26:53,382 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:26:53,382 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:26:53,438 - INFO - Response: 1440400000,2439100000,3040900000,3439600000
2025-07-02 14:26:53,438 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:26:53,439 - INFO - Response: -116.077934265,-93.9795761108,-96.7341308594,-116.071731567
2025-07-02 14:26:53,439 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:26:53,442 - INFO - Socket closed
2025-07-02 14:26:53,442 - INFO - FSW connection closed
2025-07-02 14:26:53,442 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:26:53,443 - INFO - Socket closed
2025-07-02 14:26:53,443 - INFO - VSG connection closed
2025-07-02 14:26:53,446 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:26:53,489 - INFO - Socket closed
2025-07-02 14:26:53,498 - INFO - Socket closed
2025-07-02 14:31:06,499 - INFO - Starting RF measurement script
2025-07-02 14:31:06,503 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:31:06,503 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:31:06,503 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:31:06,508 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:31:06,508 - INFO - Query: *IDN?
2025-07-02 14:31:06,509 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:31:06,512 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:31:06,512 - INFO - Query: *IDN?
2025-07-02 14:31:06,512 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:31:06,513 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:31:06,513 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:31:06,513 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:31:06,513 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:07,556 - INFO - Response: 1
2025-07-02 14:31:07,556 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:31:07,557 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:31:07,557 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:31:07,557 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:31:07,557 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:31:07,557 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:31:07,557 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:31:07,557 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:31:07,558 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:31:07,559 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:31:07,560 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:31:07,560 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:31:10,339 - INFO - Response: 1
2025-07-02 14:31:10,340 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:31:10,340 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:31:10,340 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:31:10,341 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:31:10,341 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:31:10,341 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:10,534 - INFO - Response: 1
2025-07-02 14:31:10,534 - INFO - FSW reset for spur search
2025-07-02 14:31:10,534 - INFO - Write: INIT:CONT OFF
2025-07-02 14:31:10,535 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:31:10,535 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:31:10,535 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:31:10,535 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:31:10,536 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:31:10,536 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:31:10,536 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:31:10,536 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:31:10,536 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:31:10,537 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:31:10,537 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:31:10,537 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:31:10,538 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:31:10,538 - INFO - Write: :INP:ATT 0
2025-07-02 14:31:10,538 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:31:10,538 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:31:10,538 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:31:10,538 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:31:10,538 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:31:10,538 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:31:10,538 - INFO - Write: CALC1:THR -122
2025-07-02 14:31:10,538 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:31:10,538 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:31:10,539 - INFO - Spur detection table configured
2025-07-02 14:31:10,539 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:31:10,539 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:31:10,539 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:31:14,958 - INFO - Response: 1
2025-07-02 14:31:14,958 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:31:14,959 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:31:14,960 - INFO - Response: 3
2025-07-02 14:31:14,960 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:31:14,961 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:31:15,009 - INFO - Response: 3030200000,3429100000,3950100000
2025-07-02 14:31:15,010 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:31:15,011 - INFO - Response: -90.5339889526,-113.024368286,-121.800193787
2025-07-02 14:31:15,012 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:31:15,012 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:16,063 - INFO - Response: 1
2025-07-02 14:31:16,064 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:31:16,064 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:31:16,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:31:16,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:31:16,065 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:31:16,065 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:31:16,066 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:31:16,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:31:16,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:31:16,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:31:16,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:31:16,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:31:16,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:31:16,068 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:31:18,856 - INFO - Response: 1
2025-07-02 14:31:18,857 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:31:18,857 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:31:18,858 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:31:18,858 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:31:18,858 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:31:18,858 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:19,050 - INFO - Response: 1
2025-07-02 14:31:19,050 - INFO - FSW reset for spur search
2025-07-02 14:31:19,050 - INFO - Write: INIT:CONT OFF
2025-07-02 14:31:19,051 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:31:19,051 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:31:19,051 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:31:19,051 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:31:19,051 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:31:19,052 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:31:19,052 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:31:19,052 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:31:19,052 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:31:19,052 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:31:19,053 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:31:19,053 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:31:19,053 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:31:19,053 - INFO - Write: :INP:ATT 0
2025-07-02 14:31:19,053 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:31:19,053 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:31:19,053 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:31:19,053 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:31:19,053 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:31:19,054 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:31:19,054 - INFO - Write: CALC1:THR -122
2025-07-02 14:31:19,054 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:31:19,054 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:31:19,054 - INFO - Spur detection table configured
2025-07-02 14:31:19,054 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:31:19,054 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:31:19,054 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:31:23,466 - INFO - Response: 1
2025-07-02 14:31:23,467 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:31:23,467 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:31:23,468 - INFO - Response: 3
2025-07-02 14:31:23,469 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:31:23,469 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:31:23,524 - INFO - Response: 3040900000,3439600000,3893200000
2025-07-02 14:31:23,525 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:31:23,526 - INFO - Response: -90.5028839111,-113.040756226,-121.42616272
2025-07-02 14:31:23,526 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:31:23,526 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:24,581 - INFO - Response: 1
2025-07-02 14:31:24,582 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:31:24,582 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:31:24,582 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:31:24,583 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:31:24,583 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:31:24,583 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:31:24,583 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:31:24,583 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:31:24,583 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:31:24,584 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:31:24,584 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:31:24,584 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:31:24,584 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:24,585 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:31:24,585 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:31:24,585 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:31:24,585 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:24,586 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:31:24,586 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:31:24,586 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:31:24,586 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:31:24,587 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:31:24,587 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:31:24,587 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:31:24,588 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:31:24,588 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:31:24,588 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:31:24,588 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:31:24,588 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:31:27,338 - INFO - Response: 1
2025-07-02 14:31:27,338 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:31:27,338 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:31:27,338 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:31:27,339 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:31:27,339 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:31:27,339 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:27,531 - INFO - Response: 1
2025-07-02 14:31:27,531 - INFO - FSW reset for spur search
2025-07-02 14:31:27,531 - INFO - Write: INIT:CONT OFF
2025-07-02 14:31:27,531 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:31:27,531 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:31:27,531 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:31:27,532 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:31:27,532 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:31:27,532 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:31:27,532 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:31:27,532 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:31:27,532 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:31:27,532 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:31:27,532 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:31:27,532 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:31:27,533 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:31:27,533 - INFO - Write: :INP:ATT 0
2025-07-02 14:31:27,533 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:31:27,533 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:31:27,533 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:31:27,533 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:31:27,533 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:31:27,533 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:31:27,533 - INFO - Write: CALC1:THR -122
2025-07-02 14:31:27,533 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:31:27,533 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:31:27,534 - INFO - Spur detection table configured
2025-07-02 14:31:27,534 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:31:27,534 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:31:27,534 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:31:31,950 - INFO - Response: 1
2025-07-02 14:31:31,950 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:31:31,950 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:31:31,952 - INFO - Response: 2
2025-07-02 14:31:31,952 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:31:31,953 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:31:31,997 - INFO - Response: 3030200000,3429100000
2025-07-02 14:31:31,997 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:31:31,998 - INFO - Response: -90.5114212036,-112.967071533
2025-07-02 14:31:31,999 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:31:31,999 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:33,045 - INFO - Response: 1
2025-07-02 14:31:33,046 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:31:33,046 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:31:33,046 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:31:33,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:31:33,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:31:33,047 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:31:33,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:31:33,047 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:31:33,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:31:33,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:31:33,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:31:33,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:31:33,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:31:33,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:31:33,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:31:33,050 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:31:33,051 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:31:35,843 - INFO - Response: 1
2025-07-02 14:31:35,844 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:31:35,844 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:31:35,844 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:31:35,844 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:31:35,845 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:31:35,845 - INFO - Query: *RST;*OPC?
2025-07-02 14:31:36,035 - INFO - Response: 1
2025-07-02 14:31:36,036 - INFO - FSW reset for spur search
2025-07-02 14:31:36,036 - INFO - Write: INIT:CONT OFF
2025-07-02 14:31:36,036 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:31:36,036 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:31:36,037 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:31:36,037 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:31:36,037 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:31:36,037 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:31:36,037 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:31:36,037 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:31:36,037 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:31:36,037 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:31:36,038 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:31:36,038 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:31:36,038 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:31:36,038 - INFO - Write: :INP:ATT 0
2025-07-02 14:31:36,038 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:31:36,038 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:31:36,038 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:31:36,038 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:31:36,039 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:31:36,039 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:31:36,039 - INFO - Write: CALC1:THR -122
2025-07-02 14:31:36,039 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:31:36,039 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:31:36,039 - INFO - Spur detection table configured
2025-07-02 14:31:36,039 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:31:36,039 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:31:36,039 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:31:40,497 - INFO - Response: 1
2025-07-02 14:31:40,497 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:31:40,497 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:31:40,499 - INFO - Response: 3
2025-07-02 14:31:40,499 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:31:40,499 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:31:40,541 - INFO - Response: 3040900000,3439600000,3684700000
2025-07-02 14:31:40,542 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:31:40,543 - INFO - Response: -90.5039596558,-113.240005493,-121.788345337
2025-07-02 14:31:40,543 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:31:40,548 - INFO - Socket closed
2025-07-02 14:31:40,548 - INFO - FSW connection closed
2025-07-02 14:31:40,548 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:31:40,548 - INFO - Socket closed
2025-07-02 14:31:40,549 - INFO - VSG connection closed
2025-07-02 14:31:40,551 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:31:40,592 - INFO - Socket closed
2025-07-02 14:31:40,601 - INFO - Socket closed
2025-07-02 14:32:47,571 - INFO - Starting RF measurement script
2025-07-02 14:32:47,574 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:32:47,575 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:32:47,575 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:32:47,581 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:32:47,581 - INFO - Query: *IDN?
2025-07-02 14:32:47,582 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:32:47,585 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:32:47,585 - INFO - Query: *IDN?
2025-07-02 14:32:47,586 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:32:47,586 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:32:47,586 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:32:47,586 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:32:47,586 - INFO - Query: *RST;*OPC?
2025-07-02 14:32:48,632 - INFO - Response: 1
2025-07-02 14:32:48,632 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:32:48,633 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:32:48,633 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:32:48,633 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:32:48,633 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:32:48,633 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:32:48,633 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:32:48,634 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:32:48,635 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:32:48,636 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:32:48,636 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:32:48,636 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:32:48,636 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:32:48,636 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:32:51,409 - INFO - Response: 1
2025-07-02 14:32:51,409 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:32:51,409 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:32:51,410 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:32:51,410 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:32:51,411 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:32:51,411 - INFO - Query: *RST;*OPC?
2025-07-02 14:32:51,602 - INFO - Response: 1
2025-07-02 14:32:51,602 - INFO - FSW reset for spur search
2025-07-02 14:32:51,603 - INFO - Write: INIT:CONT OFF
2025-07-02 14:32:51,603 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:32:51,603 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:32:51,603 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:32:51,603 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:32:51,603 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:32:51,603 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:32:51,603 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:32:51,603 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:32:51,603 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:32:51,603 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:32:51,604 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:32:51,604 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:32:51,604 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:32:51,604 - INFO - Write: :INP:ATT 0
2025-07-02 14:32:51,604 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:32:51,604 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:32:51,604 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:32:51,604 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:32:51,604 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:32:51,604 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:32:51,604 - INFO - Write: CALC1:THR -122
2025-07-02 14:32:51,604 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:32:51,604 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:32:51,604 - INFO - Spur detection table configured
2025-07-02 14:32:51,604 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:32:51,605 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:32:51,605 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:32:56,013 - INFO - Response: 1
2025-07-02 14:32:56,013 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:32:56,013 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:32:56,016 - INFO - Response: 4
2025-07-02 14:32:56,016 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:32:56,017 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:32:56,070 - INFO - Response: 3030200000,3429100000,3613100000,3924600000
2025-07-02 14:32:56,070 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:32:56,071 - INFO - Response: -90.5069580078,-112.941268921,-121.552124023,-121.715957642
2025-07-02 14:32:56,072 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:32:56,072 - INFO - Query: *RST;*OPC?
2025-07-02 14:32:57,126 - INFO - Response: 1
2025-07-02 14:32:57,126 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:32:57,127 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:32:57,127 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:32:57,128 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:32:57,128 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:32:57,128 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:32:57,128 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:32:57,128 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:32:57,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:32:57,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:32:57,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:32:57,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:32:57,129 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:32:57,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:32:57,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:32:57,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:32:57,130 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:32:57,131 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:32:57,131 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:32:57,131 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:32:57,131 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:32:57,131 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:32:57,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:32:57,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:32:57,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:32:57,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:32:57,132 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:32:57,133 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:32:57,133 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:32:59,950 - INFO - Response: 1
2025-07-02 14:32:59,951 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:32:59,951 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:32:59,951 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:32:59,952 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:32:59,952 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:32:59,952 - INFO - Query: *RST;*OPC?
2025-07-02 14:33:00,146 - INFO - Response: 1
2025-07-02 14:33:00,146 - INFO - FSW reset for spur search
2025-07-02 14:33:00,146 - INFO - Write: INIT:CONT OFF
2025-07-02 14:33:00,147 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:33:00,147 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:33:00,147 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:33:00,147 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:33:00,147 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:33:00,147 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:33:00,148 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:33:00,148 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:33:00,148 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:33:00,148 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:33:00,148 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:33:00,148 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:33:00,148 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:33:00,149 - INFO - Write: :INP:ATT 0
2025-07-02 14:33:00,149 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:33:00,149 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:33:00,149 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:33:00,149 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:33:00,149 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:33:00,149 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:33:00,150 - INFO - Write: CALC1:THR -122
2025-07-02 14:33:00,150 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:33:00,150 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:33:00,150 - INFO - Spur detection table configured
2025-07-02 14:33:00,150 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:33:00,150 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:33:00,150 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:33:04,585 - INFO - Response: 1
2025-07-02 14:33:04,586 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:33:04,586 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:33:04,587 - INFO - Response: 3
2025-07-02 14:33:04,588 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:33:04,588 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:33:04,631 - INFO - Response: 3040900000,3439600000,3913300000
2025-07-02 14:33:04,631 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:33:04,632 - INFO - Response: -90.5215682983,-113.007987976,-121.108016968
2025-07-02 14:33:04,632 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:33:04,632 - INFO - Query: *RST;*OPC?
2025-07-02 14:33:06,013 - INFO - Response: 1
2025-07-02 14:33:06,013 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:33:06,014 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:33:06,014 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:33:06,014 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:33:06,014 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:33:06,015 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:33:06,015 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:33:06,016 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:33:06,016 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:33:06,016 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:33:06,016 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:33:06,017 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:33:06,017 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:33:06,017 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:33:06,017 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:33:06,017 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:33:06,018 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:33:06,018 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:33:06,018 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:33:06,018 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:33:06,019 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:33:06,019 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:33:06,019 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:33:06,019 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:33:06,020 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:33:06,020 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:33:06,020 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:33:06,020 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:33:06,020 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:33:08,786 - INFO - Response: 1
2025-07-02 14:33:08,786 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:33:08,786 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:33:08,787 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:33:08,787 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:33:08,787 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:33:08,787 - INFO - Query: *RST;*OPC?
2025-07-02 14:33:08,979 - INFO - Response: 1
2025-07-02 14:33:08,979 - INFO - FSW reset for spur search
2025-07-02 14:33:08,979 - INFO - Write: INIT:CONT OFF
2025-07-02 14:33:08,979 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:33:08,980 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:33:08,980 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:33:08,980 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:33:08,980 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:33:08,980 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:33:08,980 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:33:08,980 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:33:08,981 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:33:08,981 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:33:08,981 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:33:08,981 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:33:08,981 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:33:08,981 - INFO - Write: :INP:ATT 0
2025-07-02 14:33:08,982 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:33:08,982 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:33:08,982 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:33:08,982 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:33:08,982 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:33:08,982 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:33:08,983 - INFO - Write: CALC1:THR -122
2025-07-02 14:33:08,983 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:33:08,983 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:33:08,983 - INFO - Spur detection table configured
2025-07-02 14:33:08,983 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:33:08,983 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:33:08,983 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:33:13,418 - INFO - Response: 1
2025-07-02 14:33:13,418 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:33:13,418 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:33:13,420 - INFO - Response: 2
2025-07-02 14:33:13,421 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:33:13,421 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:33:13,464 - INFO - Response: 3030200000,3429100000
2025-07-02 14:33:13,464 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:33:13,465 - INFO - Response: -90.5056610107,-113.12663269
2025-07-02 14:33:13,466 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:33:13,466 - INFO - Query: *RST;*OPC?
2025-07-02 14:33:14,517 - INFO - Response: 1
2025-07-02 14:33:14,517 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:33:14,518 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:33:14,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:33:14,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:33:14,518 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:33:14,518 - INFO - Write: SOURceifluoromethyl:BB:ARBitrary:MCARrier:CARRier2:FREQuency -400000000
2025-07-02 14:33:14,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 0
2025-07-02 14:33:14,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 400000000
2025-07-02 14:33:14,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 2000000000
2025-07-02 14:33:14,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 800000000
2025-07-02 14:33:14,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 3000000000
2025-07-02 14:33:14,519 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 5000000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 200000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 4000000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 7000000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency 1000000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency 600000000
2025-07-02 14:33:14,520 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:33:14,521 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:33:14,522 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:33:14,522 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:33:14,522 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:33:17,317 - INFO - Response: 1
2025-07-02 14:33:17,318 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:33:17,318 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:33:17,318 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:33:17,319 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:33:17,319 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:33:17,319 - INFO - Query: *RST;*OPC?
2025-07-02 14:33:17,524 - INFO - Response: 1
2025-07-02 14:33:17,524 - INFO - FSW reset for spur search
2025-07-02 14:33:17,524 - INFO - Write: INIT:CONT OFF
2025-07-02 14:33:17,525 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:33:17,525 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:33:17,525 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:33:17,525 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:33:17,525 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:33:17,526 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:33:17,526 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:33:17,526 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:33:17,526 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:33:17,526 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:33:17,526 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:33:17,527 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:33:17,527 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:33:17,528 - INFO - Write: :INP:ATT 0
2025-07-02 14:33:17,528 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:33:17,528 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:33:17,528 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:33:17,528 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:33:17,529 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:33:17,529 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:33:17,529 - INFO - Write: CALC1:THR -122
2025-07-02 14:33:17,529 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:33:17,529 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:33:17,529 - INFO - Spur detection table configured
2025-07-02 14:33:17,529 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:33:17,530 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:33:17,530 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:33:21,947 - INFO - Response: 1
2025-07-02 14:33:21,948 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:33:21,948 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:33:21,949 - INFO - Response: 3
2025-07-02 14:33:21,950 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:33:21,950 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:33:21,996 - INFO - Response: 3040900000,3439600000,3911500000
2025-07-02 14:33:21,997 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:33:21,998 - INFO - Response: -90.5397186279,-113.236709595,-121.05519104
2025-07-02 14:33:21,998 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:33:22,004 - INFO - Socket closed
2025-07-02 14:33:22,004 - INFO - FSW connection closed
2025-07-02 14:33:22,004 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:33:22,004 - INFO - Socket closed
2025-07-02 14:33:22,004 - INFO - VSG connection closed
2025-07-02 14:33:22,008 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:33:22,054 - INFO - Socket closed
2025-07-02 14:33:22,064 - INFO - Socket closed
2025-07-02 14:34:54,869 - INFO - Starting RF measurement script
2025-07-02 14:34:54,873 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:34:54,873 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:34:54,873 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:34:54,879 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:34:54,879 - INFO - Query: *IDN?
2025-07-02 14:34:54,881 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:34:54,883 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:34:54,883 - INFO - Query: *IDN?
2025-07-02 14:34:54,884 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:34:54,884 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=0 dBm
2025-07-02 14:34:54,884 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:34:54,885 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:34:54,885 - INFO - Query: *RST;*OPC?
2025-07-02 14:34:55,933 - INFO - Response: 1
2025-07-02 14:34:55,933 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:34:55,934 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:34:55,934 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:34:55,934 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:34:55,935 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:34:55,935 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:34:55,935 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:34:55,935 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:34:55,935 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:34:55,936 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:34:55,936 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:34:55,936 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:34:55,936 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:34:55,936 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:34:55,937 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:34:55,937 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:34:55,937 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:34:58,749 - INFO - Response: 1
2025-07-02 14:34:58,750 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:34:58,750 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:34:58,751 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:34:58,751 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:34:58,751 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:34:58,752 - INFO - Query: *RST;*OPC?
2025-07-02 14:34:58,942 - INFO - Response: 1
2025-07-02 14:34:58,942 - INFO - FSW reset for spur search
2025-07-02 14:34:58,942 - INFO - Write: INIT:CONT OFF
2025-07-02 14:34:58,943 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:34:58,943 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:34:58,943 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:34:58,943 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:34:58,943 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:34:58,943 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:34:58,943 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:34:58,943 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:34:58,944 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:34:58,944 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:34:58,944 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:34:58,944 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:34:58,944 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:34:58,944 - INFO - Write: :INP:ATT 0
2025-07-02 14:34:58,944 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:34:58,944 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:34:58,944 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:34:58,944 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:34:58,944 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:34:58,945 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:34:58,945 - INFO - Write: CALC1:THR -122
2025-07-02 14:34:58,945 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:34:58,945 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:34:58,945 - INFO - Spur detection table configured
2025-07-02 14:34:58,945 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:34:58,945 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:34:58,945 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:35:03,387 - INFO - Response: 1
2025-07-02 14:35:03,387 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:35:03,387 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:35:03,388 - INFO - Response: 5
2025-07-02 14:35:03,389 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:35:03,389 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:35:03,442 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3893600000
2025-07-02 14:35:03,442 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:35:03,443 - INFO - Response: -115.749252319,-91.5430450439,-96.7067718506,-116.246635437,-121.639312744
2025-07-02 14:35:03,443 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:35:03,443 - INFO - Query: *RST;*OPC?
2025-07-02 14:35:04,493 - INFO - Response: 1
2025-07-02 14:35:04,493 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:35:04,493 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:35:04,494 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:35:04,494 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:35:04,494 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:35:04,494 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:35:04,494 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:35:04,495 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:35:04,495 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:35:04,495 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:35:04,495 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:35:04,495 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:35:04,496 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:35:04,496 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:35:04,496 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:35:04,496 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:35:04,496 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:35:07,337 - INFO - Response: 1
2025-07-02 14:35:07,338 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:35:07,338 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:35:07,338 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:35:07,339 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:35:07,339 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:35:07,339 - INFO - Query: *RST;*OPC?
2025-07-02 14:35:07,532 - INFO - Response: 1
2025-07-02 14:35:07,533 - INFO - FSW reset for spur search
2025-07-02 14:35:07,533 - INFO - Write: INIT:CONT OFF
2025-07-02 14:35:07,533 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:35:07,533 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:35:07,534 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:35:07,534 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:35:07,534 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:35:07,534 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:35:07,534 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:35:07,534 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:35:07,535 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:35:07,535 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:35:07,535 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:35:07,535 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:35:07,535 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:35:07,535 - INFO - Write: :INP:ATT 0
2025-07-02 14:35:07,535 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:35:07,536 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:35:07,536 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:35:07,536 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:35:07,536 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:35:07,537 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:35:07,537 - INFO - Write: CALC1:THR -122
2025-07-02 14:35:07,537 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:35:07,538 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:35:07,538 - INFO - Spur detection table configured
2025-07-02 14:35:07,538 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:35:07,538 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:35:07,538 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:35:11,974 - INFO - Response: 1
2025-07-02 14:35:11,975 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:35:11,975 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:35:11,976 - INFO - Response: 5
2025-07-02 14:35:11,977 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:35:11,977 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:35:12,026 - INFO - Response: 1440400000,1939700000,3040900000,3439600000,3701200000
2025-07-02 14:35:12,026 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:35:12,028 - INFO - Response: -115.784637451,-91.5952453613,-96.6621704102,-116.159255981,-121.562469482
2025-07-02 14:35:12,028 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:35:12,028 - INFO - Query: *RST;*OPC?
2025-07-02 14:35:13,081 - INFO - Response: 1
2025-07-02 14:35:13,081 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:35:13,082 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:35:13,082 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:35:13,082 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:35:13,083 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:35:13,083 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:35:13,083 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:35:13,083 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:35:13,083 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:35:13,084 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:35:13,084 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:35:13,084 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:35:13,084 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:35:13,084 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:35:13,085 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:35:13,085 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:35:13,085 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:35:15,901 - INFO - Response: 1
2025-07-02 14:35:15,901 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:35:15,901 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:35:15,901 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:35:15,901 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:35:15,902 - INFO - VSG set: frequency=2.430 GHz, power=0.00 dBm
2025-07-02 14:35:15,902 - INFO - Query: *RST;*OPC?
2025-07-02 14:35:16,094 - INFO - Response: 1
2025-07-02 14:35:16,094 - INFO - FSW reset for spur search
2025-07-02 14:35:16,094 - INFO - Write: INIT:CONT OFF
2025-07-02 14:35:16,094 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:35:16,094 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:35:16,094 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:35:16,094 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:35:16,094 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:35:16,094 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:35:16,094 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:35:16,094 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:35:16,094 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:35:16,095 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:35:16,095 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:35:16,095 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:35:16,095 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:35:16,095 - INFO - Write: :INP:ATT 0
2025-07-02 14:35:16,095 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:35:16,095 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:35:16,095 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:35:16,095 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:35:16,095 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:35:16,095 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:35:16,095 - INFO - Write: CALC1:THR -122
2025-07-02 14:35:16,095 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:35:16,095 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:35:16,095 - INFO - Spur detection table configured
2025-07-02 14:35:16,095 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:35:16,095 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:35:16,095 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:35:20,496 - INFO - Response: 1
2025-07-02 14:35:20,496 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:35:20,496 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:35:20,497 - INFO - Response: 4
2025-07-02 14:35:20,498 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:35:20,498 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:35:20,546 - INFO - Response: 1430900000,1930000000,3030200000,3429100000
2025-07-02 14:35:20,546 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:35:20,547 - INFO - Response: -115.895240784,-91.5339279175,-96.6985092163,-116.124763489
2025-07-02 14:35:20,547 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:35:20,547 - INFO - Query: *RST;*OPC?
2025-07-02 14:35:21,594 - INFO - Response: 1
2025-07-02 14:35:21,594 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:35:21,594 - INFO - Write: SOUR:POW:LEV:IMM:AMPL 0.00
2025-07-02 14:35:21,595 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:35:21,595 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:35:21,595 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:35:21,596 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:35:21,596 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:35:21,596 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:35:21,596 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:35:21,596 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:35:21,597 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:35:21,597 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:35:21,597 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:35:21,597 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:35:21,598 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:35:21,598 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:35:21,598 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:35:24,439 - INFO - Response: 1
2025-07-02 14:35:24,439 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:35:24,440 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:35:24,440 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:35:24,441 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:35:24,441 - INFO - VSG set: frequency=2.440 GHz, power=0.00 dBm
2025-07-02 14:35:24,441 - INFO - Query: *RST;*OPC?
2025-07-02 14:35:24,637 - INFO - Response: 1
2025-07-02 14:35:24,637 - INFO - FSW reset for spur search
2025-07-02 14:35:24,637 - INFO - Write: INIT:CONT OFF
2025-07-02 14:35:24,637 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:35:24,637 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:35:24,638 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:35:24,638 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:35:24,638 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:35:24,638 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:35:24,638 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:35:24,638 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:35:24,638 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:35:24,638 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:35:24,638 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:35:24,638 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:35:24,638 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:35:24,638 - INFO - Write: :INP:ATT 0
2025-07-02 14:35:24,638 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:35:24,638 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:35:24,639 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:35:24,639 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:35:24,639 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:35:24,639 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:35:24,639 - INFO - Write: CALC1:THR -122
2025-07-02 14:35:24,639 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:35:24,639 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:35:24,639 - INFO - Spur detection table configured
2025-07-02 14:35:24,639 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:35:24,639 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:35:24,640 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:35:29,056 - INFO - Response: 1
2025-07-02 14:35:29,056 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:35:29,057 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:35:29,058 - INFO - Response: 4
2025-07-02 14:35:29,058 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:35:29,059 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:35:29,112 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:35:29,112 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:35:29,113 - INFO - Response: -116.081756592,-91.6164855957,-96.7491149902,-116.564117432
2025-07-02 14:35:29,114 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:35:29,118 - INFO - Socket closed
2025-07-02 14:35:29,119 - INFO - FSW connection closed
2025-07-02 14:35:29,119 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:35:29,119 - INFO - Socket closed
2025-07-02 14:35:29,119 - INFO - VSG connection closed
2025-07-02 14:35:29,121 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:35:29,160 - INFO - Socket closed
2025-07-02 14:35:29,169 - INFO - Socket closed
2025-07-02 14:36:00,002 - INFO - Starting RF measurement script
2025-07-02 14:36:00,004 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:36:00,004 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:36:00,004 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:36:00,009 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:36:00,009 - INFO - Query: *IDN?
2025-07-02 14:36:00,011 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:36:00,013 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:36:00,013 - INFO - Query: *IDN?
2025-07-02 14:36:00,014 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:36:00,014 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:36:00,015 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:36:00,015 - DEBUG - Assuming SpurSearch.measure sets VSG power to -70.00 dBm
2025-07-02 14:36:00,015 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:36:00,015 - INFO - Query: *RST;*OPC?
2025-07-02 14:36:01,061 - INFO - Response: 1
2025-07-02 14:36:01,062 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:36:01,062 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:36:01,062 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:36:01,063 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:36:01,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:36:01,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:36:01,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:36:01,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:36:01,064 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:36:01,064 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:36:03,886 - INFO - Response: 1
2025-07-02 14:36:03,886 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:36:03,887 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:36:03,887 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:36:03,888 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:36:03,889 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 14:36:03,889 - INFO - Query: *RST;*OPC?
2025-07-02 14:36:04,082 - INFO - Response: 1
2025-07-02 14:36:04,082 - INFO - FSW reset for spur search
2025-07-02 14:36:04,082 - INFO - Write: INIT:CONT OFF
2025-07-02 14:36:04,083 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:36:04,083 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:36:04,083 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:36:04,083 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:36:04,083 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:36:04,083 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:36:04,084 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:36:04,084 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:36:04,084 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:36:04,084 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:36:04,084 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:36:04,084 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:36:04,084 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:36:04,085 - INFO - Write: :INP:ATT 0
2025-07-02 14:36:04,085 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:36:04,085 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:36:04,085 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:36:04,085 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:36:04,085 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:36:04,085 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:36:04,086 - INFO - Write: CALC1:THR -122
2025-07-02 14:36:04,086 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:36:04,086 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:36:04,086 - INFO - Spur detection table configured
2025-07-02 14:36:04,086 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:36:04,086 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:36:04,086 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:36:08,522 - INFO - Response: 1
2025-07-02 14:36:08,523 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:36:08,523 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:36:08,524 - INFO - Response: 5
2025-07-02 14:36:08,525 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:36:08,525 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:36:08,569 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3964700000
2025-07-02 14:36:08,569 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:36:08,570 - INFO - Response: -115.947364807,-91.5403060913,-96.6888427734,-115.781005859,-121.645736694
2025-07-02 14:36:08,570 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:36:08,570 - INFO - Query: *RST;*OPC?
2025-07-02 14:36:09,622 - INFO - Response: 1
2025-07-02 14:36:09,622 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:36:09,623 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:36:09,623 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:36:09,624 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:36:09,624 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:36:09,624 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:36:09,624 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:36:09,625 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:36:09,626 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:36:09,626 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:36:09,626 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:36:12,464 - INFO - Response: 1
2025-07-02 14:36:12,464 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:36:12,465 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:36:12,465 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:36:12,465 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:36:12,465 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 14:36:12,466 - INFO - Query: *RST;*OPC?
2025-07-02 14:36:12,657 - INFO - Response: 1
2025-07-02 14:36:12,657 - INFO - FSW reset for spur search
2025-07-02 14:36:12,657 - INFO - Write: INIT:CONT OFF
2025-07-02 14:36:12,658 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:36:12,658 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:36:12,658 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:36:12,659 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:36:12,659 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:36:12,659 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:36:12,659 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:36:12,660 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:36:12,660 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:36:12,660 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:36:12,660 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:36:12,660 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:36:12,660 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:36:12,661 - INFO - Write: :INP:ATT 0
2025-07-02 14:36:12,661 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:36:12,661 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:36:12,661 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:36:12,661 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:36:12,661 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:36:12,662 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:36:12,662 - INFO - Write: CALC1:THR -122
2025-07-02 14:36:12,662 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:36:12,662 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:36:12,662 - INFO - Spur detection table configured
2025-07-02 14:36:12,662 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:36:12,663 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:36:12,663 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:36:17,079 - INFO - Response: 1
2025-07-02 14:36:17,080 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:36:17,080 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:36:17,082 - INFO - Response: 4
2025-07-02 14:36:17,082 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:36:17,082 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:36:17,124 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:36:17,125 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:36:17,126 - INFO - Response: -116.188232422,-91.6016311646,-96.6791152954,-116.100242615
2025-07-02 14:36:17,127 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:36:17,128 - INFO - Response: 4
2025-07-02 14:36:17,128 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:36:17,128 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:36:17,172 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:36:17,172 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:36:17,173 - INFO - Response: -116.188232422,-91.6016311646,-96.6791152954,-116.100242615
2025-07-02 14:36:17,174 - DEBUG - SpurSearch results: ([], 0.04696579999290407)
2025-07-02 14:36:17,174 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 321, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:36:17,178 - INFO - Socket closed
2025-07-02 14:36:17,178 - INFO - FSW connection closed
2025-07-02 14:36:17,178 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:36:17,178 - INFO - Socket closed
2025-07-02 14:36:17,178 - INFO - VSG connection closed
2025-07-02 14:36:17,180 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:36:17,437 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:36:17,480 - INFO - Socket closed
2025-07-02 14:36:17,481 - INFO - Socket closed
2025-07-02 14:41:09,762 - INFO - Starting RF measurement script
2025-07-02 14:41:09,766 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:41:09,766 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122
    }
  ]
}
2025-07-02 14:41:09,766 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122}
2025-07-02 14:41:09,773 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:41:09,774 - INFO - Query: *IDN?
2025-07-02 14:41:09,775 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:41:09,778 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:41:09,778 - INFO - Query: *IDN?
2025-07-02 14:41:09,779 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:41:09,779 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:41:09,779 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:41:09,779 - DEBUG - Assuming SpurSearch.measure sets VSG power to -70.00 dBm
2025-07-02 14:41:09,779 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:41:09,779 - INFO - Query: *RST;*OPC?
2025-07-02 14:41:10,833 - INFO - Response: 1
2025-07-02 14:41:10,833 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:41:10,833 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:41:10,834 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:41:10,834 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:41:10,834 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:41:10,834 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:41:10,834 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:41:10,834 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:41:10,835 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:41:10,836 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:41:14,341 - INFO - Response: 1
2025-07-02 14:41:14,341 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:41:14,341 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:41:14,341 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:41:14,341 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:41:14,341 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 14:41:14,341 - INFO - Query: *RST;*OPC?
2025-07-02 14:41:14,542 - INFO - Response: 1
2025-07-02 14:41:14,542 - INFO - FSW reset for spur search
2025-07-02 14:41:14,543 - INFO - Write: INIT:CONT OFF
2025-07-02 14:41:14,543 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:41:14,543 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:41:14,544 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:41:14,544 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:41:14,544 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:41:14,544 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:41:14,544 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:41:14,544 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:41:14,544 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:41:14,544 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:41:14,544 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:41:14,544 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:41:14,544 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:41:14,545 - INFO - Write: :INP:ATT 0
2025-07-02 14:41:14,545 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:41:14,545 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:41:14,545 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:41:14,545 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:41:14,545 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:41:14,545 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:41:14,545 - INFO - Write: CALC1:THR -122
2025-07-02 14:41:14,545 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:41:14,545 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:41:14,545 - INFO - Spur detection table configured
2025-07-02 14:41:14,545 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:41:14,545 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:41:14,545 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:41:18,962 - INFO - Response: 1
2025-07-02 14:41:18,962 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:41:18,962 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:41:18,963 - INFO - Response: 5
2025-07-02 14:41:18,964 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:41:18,964 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:41:19,012 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3993800000
2025-07-02 14:41:19,012 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:41:19,013 - INFO - Response: -116.176254272,-91.5518798828,-96.6485671997,-115.893318176,-121.66545105
2025-07-02 14:41:19,013 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:41:19,013 - INFO - Query: *RST;*OPC?
2025-07-02 14:41:20,067 - INFO - Response: 1
2025-07-02 14:41:20,067 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:41:20,067 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:41:20,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:41:20,067 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:41:20,068 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:41:20,069 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:41:22,913 - INFO - Response: 1
2025-07-02 14:41:22,913 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:41:22,913 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:41:22,913 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:41:22,913 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:41:22,913 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 14:41:22,913 - INFO - Query: *RST;*OPC?
2025-07-02 14:41:23,104 - INFO - Response: 1
2025-07-02 14:41:23,104 - INFO - FSW reset for spur search
2025-07-02 14:41:23,104 - INFO - Write: INIT:CONT OFF
2025-07-02 14:41:23,104 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:41:23,104 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:41:23,104 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:41:23,104 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:41:23,104 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:41:23,105 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:41:23,105 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:41:23,105 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:41:23,105 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:41:23,105 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:41:23,105 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:41:23,105 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:41:23,105 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:41:23,105 - INFO - Write: :INP:ATT 0
2025-07-02 14:41:23,105 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:41:23,105 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:41:23,105 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:41:23,105 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:41:23,105 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:41:23,105 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:41:23,105 - INFO - Write: CALC1:THR -122
2025-07-02 14:41:23,106 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:41:23,106 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:41:23,106 - INFO - Spur detection table configured
2025-07-02 14:41:23,106 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:41:23,106 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:41:23,106 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:41:27,569 - INFO - Response: 1
2025-07-02 14:41:27,569 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:41:27,569 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:41:27,570 - INFO - Response: 4
2025-07-02 14:41:27,570 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:41:27,570 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:41:27,623 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:41:27,624 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:41:27,624 - INFO - Response: -115.984107971,-91.5625686646,-96.7449569702,-116.28352356
2025-07-02 14:41:27,625 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:41:27,625 - INFO - Response: 4
2025-07-02 14:41:27,625 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:41:27,625 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:41:27,670 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:41:27,670 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:41:27,671 - INFO - Response: -115.984107971,-91.5625686646,-96.7449569702,-116.28352356
2025-07-02 14:41:27,671 - DEBUG - SpurSearch results: {2.43: [], 2.44: []}
2025-07-02 14:41:27,672 - INFO - Socket closed
2025-07-02 14:41:27,672 - INFO - FSW connection closed
2025-07-02 14:41:27,672 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:41:27,672 - INFO - Socket closed
2025-07-02 14:41:27,672 - INFO - VSG connection closed
2025-07-02 14:41:27,674 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:41:27,964 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:41:27,997 - INFO - Socket closed
2025-07-02 14:41:27,999 - INFO - Socket closed
2025-07-02 14:53:00,590 - INFO - Starting RF measurement script
2025-07-02 14:53:00,593 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:53:00,594 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:53:00,594 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:53:00,594 - ERROR - SpurSearch test initialization failed: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_copilot.py", line 400, in <module>
    spur_instr = SpurSearch(
        fundamental_frequency_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        power_dbm=test.get("power_dbm", -70)
    )
TypeError: SpurSearch.__init__() got an unexpected keyword argument 'fundamental_frequency_ghz'
2025-07-02 14:53:00,596 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:53:00,596 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:53:00,951 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:53:47,276 - INFO - Starting RF measurement script
2025-07-02 14:53:47,280 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:53:47,280 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:53:47,280 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:53:47,280 - DEBUG - No visa library specified, trying to find alternatives.
2025-07-02 14:53:47,280 - DEBUG - Environment variable PYVISA_LIBRARY is unset.
2025-07-02 14:53:47,298 - DEBUG - No user defined configuration
2025-07-02 14:53:47,301 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:53:47,301 - DEBUG - No user defined library files
2025-07-02 14:53:47,301 - DEBUG - The IVI implementation available
2025-07-02 14:53:47,302 - DEBUG - No user defined configuration
2025-07-02 14:53:47,305 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:53:47,306 - DEBUG - No user defined library files
2025-07-02 14:53:47,361 - DEBUG - Library signatures: 90 ok, 0 failed
2025-07-02 14:53:47,361 - DEBUG - Created library wrapper for C:\Windows\system32\visa32.dll
2025-07-02 14:53:47,381 - DEBUG - viOpenDefaultRM('<ViObject object at 0x00000232194AD7D0>',) -> 0
2025-07-02 14:53:47,381 - DEBUG - Created ResourceManager with session 1
2025-07-02 14:53:47,383 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.20::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x00000232194ADB50>, <ctypes.c_char_Array_256 object at 0x00000232194ADBD0>, <ctypes.c_char_Array_256 object at 0x00000232194ADC50>) -> 0
2025-07-02 14:53:47,383 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - opening ...
2025-07-02 14:53:47,391 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.20::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x00000232194ADB50>') -> 0
2025-07-02 14:53:47,391 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is open with session 2
2025-07-02 14:53:47,393 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.10::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x00000232194ADFD0>, <ctypes.c_char_Array_256 object at 0x00000232194AE050>, <ctypes.c_char_Array_256 object at 0x00000232194AE0D0>) -> 0
2025-07-02 14:53:47,393 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - opening ...
2025-07-02 14:53:47,398 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.10::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x00000232194ADFD0>') -> 0
2025-07-02 14:53:47,399 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is open with session 3
2025-07-02 14:53:47,399 - DEBUG - viWrite(2, b'*IDN?\n', 6, 'c_ulong(6)') -> 0
2025-07-02 14:53:47,399 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - reading 20480 bytes (last status <StatusCode.success_max_count_read: 1073676294>)
2025-07-02 14:53:49,414 - DEBUG - viRead(2, <ctypes.c_char_Array_20480 object at 0x00000232194AE550>, 20480, 'c_ulong(46)') -> -1073807339
2025-07-02 14:53:49,415 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - exception while reading: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Buffer content: bytearray(b'')
2025-07-02 14:53:49,415 - ERROR - Failed to connect to instruments: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:53:49,420 - ERROR - SpurSearch test set 1 failed: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 505, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:53:49,423 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - closing
2025-07-02 14:53:49,423 - DEBUG - viDisableEvent(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:53:49,425 - DEBUG - viDiscardEvents(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:53:49,425 - DEBUG - viClose(2,) -> 0
2025-07-02 14:53:49,425 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is closed
2025-07-02 14:53:49,425 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - closing
2025-07-02 14:53:49,426 - DEBUG - viDisableEvent(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:53:49,426 - DEBUG - viDiscardEvents(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:53:49,426 - DEBUG - viClose(3,) -> 0
2025-07-02 14:53:49,426 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is closed
2025-07-02 14:53:49,428 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:53:49,428 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:53:49,432 - DEBUG - Closing ResourceManager (session: 1)
2025-07-02 14:53:49,433 - DEBUG - viClose(1,) -> 0
2025-07-02 14:53:49,704 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:54:42,485 - INFO - Starting RF measurement script
2025-07-02 14:54:42,488 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:54:42,488 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:54:42,488 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:54:42,488 - DEBUG - No visa library specified, trying to find alternatives.
2025-07-02 14:54:42,488 - DEBUG - Environment variable PYVISA_LIBRARY is unset.
2025-07-02 14:54:42,493 - DEBUG - No user defined configuration
2025-07-02 14:54:42,494 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:54:42,494 - DEBUG - No user defined library files
2025-07-02 14:54:42,494 - DEBUG - The IVI implementation available
2025-07-02 14:54:42,495 - DEBUG - No user defined configuration
2025-07-02 14:54:42,496 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:54:42,496 - DEBUG - No user defined library files
2025-07-02 14:54:42,504 - DEBUG - Library signatures: 90 ok, 0 failed
2025-07-02 14:54:42,504 - DEBUG - Created library wrapper for C:\Windows\system32\visa32.dll
2025-07-02 14:54:42,512 - DEBUG - viOpenDefaultRM('<ViObject object at 0x000001B9692ED7D0>',) -> 0
2025-07-02 14:54:42,512 - DEBUG - Created ResourceManager with session 1
2025-07-02 14:54:42,513 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.20::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x000001B9692EDB50>, <ctypes.c_char_Array_256 object at 0x000001B9692EDBD0>, <ctypes.c_char_Array_256 object at 0x000001B9692EDC50>) -> 0
2025-07-02 14:54:42,513 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - opening ...
2025-07-02 14:54:42,519 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.20::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x000001B9692EDB50>') -> 0
2025-07-02 14:54:42,519 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is open with session 2
2025-07-02 14:54:42,520 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.10::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x000001B9692EDFD0>, <ctypes.c_char_Array_256 object at 0x000001B9692EE050>, <ctypes.c_char_Array_256 object at 0x000001B9692EE0D0>) -> 0
2025-07-02 14:54:42,520 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - opening ...
2025-07-02 14:54:42,522 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.10::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x000001B9692EDFD0>') -> 0
2025-07-02 14:54:42,522 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is open with session 3
2025-07-02 14:54:42,523 - DEBUG - viWrite(2, b'*IDN?\n', 6, 'c_ulong(6)') -> 0
2025-07-02 14:54:42,523 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - reading 20480 bytes (last status <StatusCode.success_max_count_read: 1073676294>)
2025-07-02 14:54:44,523 - DEBUG - viRead(2, <ctypes.c_char_Array_20480 object at 0x000001B9692EE550>, 20480, 'c_ulong(46)') -> -1073807339
2025-07-02 14:54:44,524 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - exception while reading: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Buffer content: bytearray(b'')
2025-07-02 14:54:44,524 - ERROR - Failed to connect to instruments: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:54:44,527 - ERROR - SpurSearch test set 1 failed: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 505, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:54:44,529 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - closing
2025-07-02 14:54:44,529 - DEBUG - viDisableEvent(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:54:44,529 - DEBUG - viDiscardEvents(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:54:44,529 - DEBUG - viClose(2,) -> 0
2025-07-02 14:54:44,529 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is closed
2025-07-02 14:54:44,529 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - closing
2025-07-02 14:54:44,529 - DEBUG - viDisableEvent(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:54:44,529 - DEBUG - viDiscardEvents(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:54:44,529 - DEBUG - viClose(3,) -> 0
2025-07-02 14:54:44,529 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is closed
2025-07-02 14:54:44,531 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:54:44,531 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:54:44,535 - DEBUG - Closing ResourceManager (session: 1)
2025-07-02 14:54:44,535 - DEBUG - viClose(1,) -> 0
2025-07-02 14:54:44,741 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:55:06,481 - INFO - Starting RF measurement script
2025-07-02 14:55:06,485 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:55:06,485 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:55:06,486 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:55:06,486 - DEBUG - No visa library specified, trying to find alternatives.
2025-07-02 14:55:06,486 - DEBUG - Environment variable PYVISA_LIBRARY is unset.
2025-07-02 14:55:06,492 - DEBUG - No user defined configuration
2025-07-02 14:55:06,494 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:55:06,494 - DEBUG - No user defined library files
2025-07-02 14:55:06,494 - DEBUG - The IVI implementation available
2025-07-02 14:55:06,495 - DEBUG - No user defined configuration
2025-07-02 14:55:06,496 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:55:06,496 - DEBUG - No user defined library files
2025-07-02 14:55:06,505 - DEBUG - Library signatures: 90 ok, 0 failed
2025-07-02 14:55:06,505 - DEBUG - Created library wrapper for C:\Windows\system32\visa32.dll
2025-07-02 14:55:06,514 - DEBUG - viOpenDefaultRM('<ViObject object at 0x000001FC216D97D0>',) -> 0
2025-07-02 14:55:06,514 - DEBUG - Created ResourceManager with session 1
2025-07-02 14:55:06,515 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.20::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x000001FC216D9B50>, <ctypes.c_char_Array_256 object at 0x000001FC216D9BD0>, <ctypes.c_char_Array_256 object at 0x000001FC216D9C50>) -> 0
2025-07-02 14:55:06,515 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - opening ...
2025-07-02 14:55:06,521 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.20::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x000001FC216D9B50>') -> 0
2025-07-02 14:55:06,521 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is open with session 2
2025-07-02 14:55:06,522 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.10::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x000001FC216D9FD0>, <ctypes.c_char_Array_256 object at 0x000001FC216DA050>, <ctypes.c_char_Array_256 object at 0x000001FC216DA0D0>) -> 0
2025-07-02 14:55:06,522 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - opening ...
2025-07-02 14:55:06,525 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.10::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x000001FC216D9FD0>') -> 0
2025-07-02 14:55:06,525 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is open with session 3
2025-07-02 14:55:06,525 - DEBUG - viWrite(2, b'*IDN?\n', 6, 'c_ulong(6)') -> 0
2025-07-02 14:55:06,525 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - reading 20480 bytes (last status <StatusCode.success_max_count_read: 1073676294>)
2025-07-02 14:55:08,526 - DEBUG - viRead(2, <ctypes.c_char_Array_20480 object at 0x000001FC216DA550>, 20480, 'c_ulong(46)') -> -1073807339
2025-07-02 14:55:08,526 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - exception while reading: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Buffer content: bytearray(b'')
2025-07-02 14:55:08,526 - ERROR - Failed to connect to instruments: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:55:08,529 - ERROR - SpurSearch test set 1 failed: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1304.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:55:08,531 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - closing
2025-07-02 14:55:08,531 - DEBUG - viDisableEvent(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:55:08,531 - DEBUG - viDiscardEvents(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:55:08,531 - DEBUG - viClose(2,) -> 0
2025-07-02 14:55:08,531 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is closed
2025-07-02 14:55:08,531 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - closing
2025-07-02 14:55:08,531 - DEBUG - viDisableEvent(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:55:08,531 - DEBUG - viDiscardEvents(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:55:08,531 - DEBUG - viClose(3,) -> 0
2025-07-02 14:55:08,531 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is closed
2025-07-02 14:55:08,534 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:55:08,534 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:55:08,537 - DEBUG - Closing ResourceManager (session: 1)
2025-07-02 14:55:08,537 - DEBUG - viClose(1,) -> 0
2025-07-02 14:55:08,815 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:55:20,304 - INFO - Starting RF measurement script
2025-07-02 14:55:20,305 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:55:20,305 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:55:20,306 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:55:20,306 - DEBUG - No visa library specified, trying to find alternatives.
2025-07-02 14:55:20,306 - DEBUG - Environment variable PYVISA_LIBRARY is unset.
2025-07-02 14:55:20,310 - DEBUG - No user defined configuration
2025-07-02 14:55:20,312 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:55:20,312 - DEBUG - No user defined library files
2025-07-02 14:55:20,312 - DEBUG - The IVI implementation available
2025-07-02 14:55:20,313 - DEBUG - No user defined configuration
2025-07-02 14:55:20,314 - DEBUG - Automatically found library files: [None, 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa32.dll', 'C:\\Windows\\system32\\visa64.dll', 'C:\\Windows\\system32\\visa64.dll']
2025-07-02 14:55:20,314 - DEBUG - No user defined library files
2025-07-02 14:55:20,324 - DEBUG - Library signatures: 90 ok, 0 failed
2025-07-02 14:55:20,324 - DEBUG - Created library wrapper for C:\Windows\system32\visa32.dll
2025-07-02 14:55:20,333 - DEBUG - viOpenDefaultRM('<ViObject object at 0x0000026CD4DC9950>',) -> 0
2025-07-02 14:55:20,333 - DEBUG - Created ResourceManager with session 1
2025-07-02 14:55:20,335 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.20::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x0000026CD4DC9CD0>, <ctypes.c_char_Array_256 object at 0x0000026CD4DC9D50>, <ctypes.c_char_Array_256 object at 0x0000026CD4DC9DD0>) -> 0
2025-07-02 14:55:20,336 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - opening ...
2025-07-02 14:55:20,365 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.20::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x0000026CD4DC9CD0>') -> 0
2025-07-02 14:55:20,365 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is open with session 2
2025-07-02 14:55:20,366 - DEBUG - viParseRsrcEx(1, 'TCPIP::192.168.200.10::5025::SOCKET', 'c_ushort(6)', 'c_ushort(0)', <ctypes.c_char_Array_256 object at 0x0000026CD4DCA150>, <ctypes.c_char_Array_256 object at 0x0000026CD4DCA1D0>, <ctypes.c_char_Array_256 object at 0x0000026CD4DCA250>) -> 0
2025-07-02 14:55:20,366 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - opening ...
2025-07-02 14:55:20,381 - DEBUG - viOpen(1, 'TCPIP0::192.168.200.10::5025::SOCKET', <AccessModes.no_lock: 0>, 0, '<ViObject object at 0x0000026CD4DCA150>') -> 0
2025-07-02 14:55:20,381 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is open with session 3
2025-07-02 14:55:20,382 - DEBUG - viWrite(2, b'*IDN?\n', 6, 'c_ulong(6)') -> 0
2025-07-02 14:55:20,382 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - reading 20480 bytes (last status <StatusCode.success_max_count_read: 1073676294>)
2025-07-02 14:55:22,392 - DEBUG - viRead(2, <ctypes.c_char_Array_20480 object at 0x0000026CD4DCA6D0>, 20480, 'c_ulong(46)') -> -1073807339
2025-07-02 14:55:22,392 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - exception while reading: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Buffer content: bytearray(b'')
2025-07-02 14:55:22,392 - ERROR - Failed to connect to instruments: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:55:22,396 - ERROR - SpurSearch test set 1 failed: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 539, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", -70)  # Default to -70 dBm
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 26, in __init__
    logger.info("Connected to VSA: %s", self.vsa.query('*IDN?').strip())
                                        ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 690, in query
    return self.read()
           ~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 519, in read
    message = self._read_raw().decode(enco)
              ~~~~~~~~~~~~~~^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\resources\messagebased.py", line 473, in _read_raw
    chunk, status = self.visalib.read(self.session, size)
                    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\functions.py", line 2339, in read
    ret = library.viRead(session, buffer, count, byref(return_count))
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\ctwrapper\highlevel.py", line 227, in _return_handler
    return self.handle_return_value(session, ret_value)  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pyvisa\highlevel.py", line 252, in handle_return_value
    raise errors.VisaIOError(rv)
pyvisa.errors.VisaIOError: VI_ERROR_TMO (-1073807339): Timeout expired before operation completed.
2025-07-02 14:55:22,401 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - closing
2025-07-02 14:55:22,401 - DEBUG - viDisableEvent(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:55:22,401 - DEBUG - viDiscardEvents(2, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:55:22,402 - DEBUG - viClose(2,) -> 0
2025-07-02 14:55:22,402 - DEBUG - TCPIP0::192.168.200.20::5025::SOCKET - is closed
2025-07-02 14:55:22,402 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - closing
2025-07-02 14:55:22,402 - DEBUG - viDisableEvent(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676291
2025-07-02 14:55:22,402 - DEBUG - viDiscardEvents(3, <EventType.all_enabled: 1073709055>, <EventMechanism.all: 65535>) -> 1073676292
2025-07-02 14:55:22,402 - DEBUG - viClose(3,) -> 0
2025-07-02 14:55:22,402 - DEBUG - TCPIP0::192.168.200.10::5025::SOCKET - is closed
2025-07-02 14:55:22,404 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:55:22,404 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:55:22,406 - DEBUG - Closing ResourceManager (session: 1)
2025-07-02 14:55:22,407 - DEBUG - viClose(1,) -> 0
2025-07-02 14:55:22,620 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:55:59,133 - INFO - Starting RF measurement script
2025-07-02 14:55:59,137 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:55:59,137 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:55:59,137 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:55:59,143 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:55:59,144 - INFO - Query: *IDN?
2025-07-02 14:55:59,145 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:55:59,148 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:55:59,148 - INFO - Query: *IDN?
2025-07-02 14:55:59,148 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:55:59,148 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:55:59,149 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:55:59,149 - DEBUG - Assuming SpurSearch.measure sets VSG power to -70.00 dBm
2025-07-02 14:55:59,149 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:55:59,149 - INFO - Query: *RST;*OPC?
2025-07-02 14:56:00,206 - INFO - Response: 1
2025-07-02 14:56:00,206 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:56:00,206 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:56:00,206 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:56:00,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:56:00,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:56:00,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:56:00,207 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:56:00,208 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:56:00,209 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:56:00,209 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:56:03,019 - INFO - Response: 1
2025-07-02 14:56:03,020 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:56:03,020 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:56:03,021 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:56:03,021 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:56:03,021 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 14:56:03,021 - INFO - Query: *RST;*OPC?
2025-07-02 14:56:03,215 - INFO - Response: 1
2025-07-02 14:56:03,215 - INFO - FSW reset for spur search
2025-07-02 14:56:03,215 - INFO - Write: INIT:CONT OFF
2025-07-02 14:56:03,216 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:56:03,216 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:56:03,216 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:56:03,217 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:56:03,217 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:56:03,217 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:56:03,217 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:56:03,217 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:56:03,218 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:56:03,218 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:56:03,218 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:56:03,218 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:56:03,218 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:56:03,219 - INFO - Write: :INP:ATT 0
2025-07-02 14:56:03,219 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:56:03,219 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:56:03,219 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:56:03,219 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:56:03,220 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:56:03,220 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:56:03,220 - INFO - Write: CALC1:THR -122
2025-07-02 14:56:03,220 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:56:03,221 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:56:03,221 - INFO - Spur detection table configured
2025-07-02 14:56:03,221 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:56:03,221 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:56:03,221 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:56:07,665 - INFO - Response: 1
2025-07-02 14:56:07,665 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:56:07,665 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:56:07,667 - INFO - Response: 5
2025-07-02 14:56:07,667 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:56:07,668 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:56:07,720 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3979300000
2025-07-02 14:56:07,720 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:56:07,721 - INFO - Response: -115.823722839,-91.5241165161,-96.6815567017,-115.843101501,-121.407798767
2025-07-02 14:56:07,721 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:56:07,721 - INFO - Query: *RST;*OPC?
2025-07-02 14:56:08,772 - INFO - Response: 1
2025-07-02 14:56:08,773 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:56:08,773 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:56:08,773 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:56:08,773 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:56:08,773 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:56:08,774 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:56:08,774 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:56:08,774 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:56:08,774 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:56:08,775 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:56:08,775 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:56:08,775 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:56:08,775 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:56:08,775 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:56:08,775 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:56:08,776 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:56:08,776 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:56:11,609 - INFO - Response: 1
2025-07-02 14:56:11,609 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:56:11,610 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:56:11,610 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:56:11,610 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:56:11,610 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 14:56:11,610 - INFO - Query: *RST;*OPC?
2025-07-02 14:56:11,800 - INFO - Response: 1
2025-07-02 14:56:11,800 - INFO - FSW reset for spur search
2025-07-02 14:56:11,800 - INFO - Write: INIT:CONT OFF
2025-07-02 14:56:11,800 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:56:11,801 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:56:11,801 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:56:11,801 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:56:11,801 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:56:11,801 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:56:11,801 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:56:11,801 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:56:11,801 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:56:11,801 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:56:11,801 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:56:11,801 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:56:11,801 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:56:11,802 - INFO - Write: :INP:ATT 0
2025-07-02 14:56:11,802 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:56:11,802 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:56:11,802 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:56:11,802 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:56:11,802 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:56:11,802 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:56:11,802 - INFO - Write: CALC1:THR -122
2025-07-02 14:56:11,802 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:56:11,802 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:56:11,802 - INFO - Spur detection table configured
2025-07-02 14:56:11,802 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:56:11,802 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:56:11,802 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:56:16,219 - INFO - Response: 1
2025-07-02 14:56:16,219 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:56:16,219 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:56:16,221 - INFO - Response: 4
2025-07-02 14:56:16,221 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:56:16,221 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:56:16,271 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:56:16,271 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:56:16,272 - INFO - Response: -115.782218933,-91.5920410156,-96.7011566162,-116.471557617
2025-07-02 14:56:16,272 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:56:16,273 - INFO - Response: 4
2025-07-02 14:56:16,273 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:56:16,273 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:56:16,318 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:56:16,319 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:56:16,319 - INFO - Response: -115.782218933,-91.5920410156,-96.7011566162,-116.471557617
2025-07-02 14:56:16,320 - DEBUG - SpurSearch results: {2.43: [], 2.44: []}
2025-07-02 14:56:16,320 - INFO - Socket closed
2025-07-02 14:56:16,320 - INFO - FSW connection closed
2025-07-02 14:56:16,320 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:56:16,320 - INFO - Socket closed
2025-07-02 14:56:16,320 - INFO - VSG connection closed
2025-07-02 14:56:16,322 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:56:16,550 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:56:16,580 - INFO - Socket closed
2025-07-02 14:56:16,581 - INFO - Socket closed
2025-07-02 14:57:29,435 - INFO - Starting RF measurement script
2025-07-02 14:57:29,437 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:57:29,437 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:57:29,437 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:57:29,443 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:57:29,444 - INFO - Query: *IDN?
2025-07-02 14:57:29,445 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:57:29,447 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:57:29,447 - INFO - Query: *IDN?
2025-07-02 14:57:29,448 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:57:29,448 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:57:29,448 - ERROR - SpurSearch test set 1 failed: unsupported format string passed to list.__format__
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1304.py", line 499, in <module>
    print(f"SpurSearch Fundamental: {test['fundamental_frequency_ghz']:.3f} GHz")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to list.__format__
2025-07-02 14:57:29,450 - INFO - Socket closed
2025-07-02 14:57:29,450 - INFO - FSW connection closed
2025-07-02 14:57:29,450 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:57:29,450 - INFO - Socket closed
2025-07-02 14:57:29,450 - INFO - VSG connection closed
2025-07-02 14:57:29,452 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:57:29,452 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:57:29,691 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:57:29,742 - INFO - Socket closed
2025-07-02 14:57:29,743 - INFO - Socket closed
2025-07-02 14:57:40,455 - INFO - Starting RF measurement script
2025-07-02 14:57:40,458 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:57:40,458 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:57:40,458 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:57:40,463 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:57:40,464 - INFO - Query: *IDN?
2025-07-02 14:57:40,465 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:57:40,468 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:57:40,468 - INFO - Query: *IDN?
2025-07-02 14:57:40,468 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:57:40,469 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:57:40,469 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:57:40,469 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:57:40,469 - INFO - Query: *RST;*OPC?
2025-07-02 14:57:41,515 - INFO - Response: 1
2025-07-02 14:57:41,515 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:57:41,515 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:57:41,515 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:57:41,515 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:57:41,515 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:57:41,515 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:57:41,515 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:57:41,516 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:57:41,516 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:57:44,325 - INFO - Response: 1
2025-07-02 14:57:44,326 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:57:44,326 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:57:44,326 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:57:44,326 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:57:44,326 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 14:57:44,327 - INFO - Query: *RST;*OPC?
2025-07-02 14:57:44,522 - INFO - Response: 1
2025-07-02 14:57:44,522 - INFO - FSW reset for spur search
2025-07-02 14:57:44,523 - INFO - Write: INIT:CONT OFF
2025-07-02 14:57:44,523 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:57:44,523 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:57:44,523 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:57:44,523 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:57:44,523 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:57:44,524 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:57:44,524 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:57:44,524 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:57:44,524 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:57:44,524 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:57:44,524 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:57:44,524 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:57:44,524 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:57:44,524 - INFO - Write: :INP:ATT 0
2025-07-02 14:57:44,524 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:57:44,524 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:57:44,524 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:57:44,525 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:57:44,525 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:57:44,525 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:57:44,525 - INFO - Write: CALC1:THR -122
2025-07-02 14:57:44,525 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:57:44,525 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:57:44,525 - INFO - Spur detection table configured
2025-07-02 14:57:44,525 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:57:44,525 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:57:44,525 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:57:48,940 - INFO - Response: 1
2025-07-02 14:57:48,940 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:57:48,940 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:57:48,942 - INFO - Response: 4
2025-07-02 14:57:48,942 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:57:48,943 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:57:48,997 - INFO - Response: 1430900000,1930000000,3030200000,3429100000
2025-07-02 14:57:48,998 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:57:48,999 - INFO - Response: -115.927330017,-91.5440292358,-96.6691360474,-116.437301636
2025-07-02 14:57:48,999 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:57:48,999 - INFO - Query: *RST;*OPC?
2025-07-02 14:57:50,048 - INFO - Response: 1
2025-07-02 14:57:50,048 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:57:50,048 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:57:50,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:57:50,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:57:50,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:57:50,048 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:57:50,049 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:57:50,049 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:57:52,892 - INFO - Response: 1
2025-07-02 14:57:52,892 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:57:52,892 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:57:52,892 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:57:52,892 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:57:52,892 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 14:57:52,892 - INFO - Query: *RST;*OPC?
2025-07-02 14:57:53,083 - INFO - Response: 1
2025-07-02 14:57:53,083 - INFO - FSW reset for spur search
2025-07-02 14:57:53,083 - INFO - Write: INIT:CONT OFF
2025-07-02 14:57:53,083 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:57:53,083 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:57:53,083 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:57:53,083 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:57:53,083 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:57:53,083 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:57:53,083 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:57:53,083 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:57:53,084 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:57:53,084 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:57:53,084 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:57:53,084 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:57:53,084 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:57:53,084 - INFO - Write: :INP:ATT 0
2025-07-02 14:57:53,084 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:57:53,084 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:57:53,084 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:57:53,084 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:57:53,084 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:57:53,084 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:57:53,084 - INFO - Write: CALC1:THR -122
2025-07-02 14:57:53,084 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:57:53,084 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:57:53,084 - INFO - Spur detection table configured
2025-07-02 14:57:53,084 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:57:53,084 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:57:53,084 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:57:57,500 - INFO - Response: 1
2025-07-02 14:57:57,500 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:57:57,500 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:57:57,501 - INFO - Response: 5
2025-07-02 14:57:57,501 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:57:57,501 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:57:57,551 - INFO - Response: 1440400000,1939700000,3040900000,3439600000,3959100000
2025-07-02 14:57:57,551 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:57:57,552 - INFO - Response: -115.906509399,-91.5964431763,-96.6830825806,-116.420219421,-121.940811157
2025-07-02 14:57:57,553 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:57:57,553 - INFO - Query: *RST;*OPC?
2025-07-02 14:57:58,605 - INFO - Response: 1
2025-07-02 14:57:58,605 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:57:58,605 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:57:58,605 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:57:58,605 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:57:58,606 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:57:58,607 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:57:58,607 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:58:01,402 - INFO - Response: 1
2025-07-02 14:58:01,403 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:58:01,403 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:58:01,403 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:58:01,403 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:58:01,404 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 14:58:01,404 - INFO - Query: *RST;*OPC?
2025-07-02 14:58:01,595 - INFO - Response: 1
2025-07-02 14:58:01,596 - INFO - FSW reset for spur search
2025-07-02 14:58:01,596 - INFO - Write: INIT:CONT OFF
2025-07-02 14:58:01,596 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 14:58:01,596 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 14:58:01,596 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:58:01,596 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:58:01,596 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:58:01,596 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:58:01,596 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:58:01,596 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:58:01,596 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:58:01,596 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:58:01,596 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:58:01,596 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:58:01,596 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:58:01,596 - INFO - Write: :INP:ATT 0
2025-07-02 14:58:01,597 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:58:01,597 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:58:01,597 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:58:01,597 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:58:01,597 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 14:58:01,597 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 14:58:01,597 - INFO - Write: CALC1:THR -122
2025-07-02 14:58:01,597 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:58:01,597 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:58:01,597 - INFO - Spur detection table configured
2025-07-02 14:58:01,597 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 14:58:01,597 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:58:01,597 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:58:06,010 - INFO - Response: 1
2025-07-02 14:58:06,010 - INFO - Spur search measurement completed for 2.430 GHz
2025-07-02 14:58:06,011 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:58:06,012 - INFO - Response: 5
2025-07-02 14:58:06,012 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:58:06,012 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:58:06,059 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,4017500000
2025-07-02 14:58:06,060 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:58:06,061 - INFO - Response: -115.932685852,-91.538848877,-96.6389541626,-116.05480957,-121.653305054
2025-07-02 14:58:06,061 - INFO - Measuring spurs at fundamental frequency: 2.440 GHz
2025-07-02 14:58:06,061 - INFO - Query: *RST;*OPC?
2025-07-02 14:58:07,116 - INFO - Response: 1
2025-07-02 14:58:07,116 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 14:58:07,116 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:58:07,117 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:58:07,117 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:58:09,961 - INFO - Response: 1
2025-07-02 14:58:09,961 - INFO - Write: SOURce1:POW:LEV:IMM:AMPL -70
2025-07-02 14:58:09,961 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 14:58:09,961 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 14:58:09,961 - INFO - Write: OUTPut1:STATe 1
2025-07-02 14:58:09,961 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 14:58:09,962 - INFO - Query: *RST;*OPC?
2025-07-02 14:58:10,155 - INFO - Response: 1
2025-07-02 14:58:10,155 - INFO - FSW reset for spur search
2025-07-02 14:58:10,155 - INFO - Write: INIT:CONT OFF
2025-07-02 14:58:10,155 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 14:58:10,155 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 14:58:10,156 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 14:58:10,156 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 14:58:10,156 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 14:58:10,156 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 14:58:10,156 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 14:58:10,156 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 14:58:10,156 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 14:58:10,156 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 14:58:10,156 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 14:58:10,156 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 14:58:10,156 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 14:58:10,156 - INFO - Write: :INP:ATT 0
2025-07-02 14:58:10,156 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 14:58:10,156 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 14:58:10,156 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 14:58:10,156 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 14:58:10,156 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 14:58:10,156 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 14:58:10,156 - INFO - Write: CALC1:THR -122
2025-07-02 14:58:10,156 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 14:58:10,156 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 14:58:10,156 - INFO - Spur detection table configured
2025-07-02 14:58:10,156 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 14:58:10,157 - INFO - Write: :INIT:CONT OFF
2025-07-02 14:58:10,157 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 14:58:14,574 - INFO - Response: 1
2025-07-02 14:58:14,574 - INFO - Spur search measurement completed for 2.440 GHz
2025-07-02 14:58:14,574 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 14:58:14,576 - INFO - Response: 4
2025-07-02 14:58:14,576 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 14:58:14,576 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 14:58:14,626 - INFO - Response: 1440400000,1939700000,3040900000,3439600000
2025-07-02 14:58:14,627 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 14:58:14,627 - INFO - Response: -115.991210938,-91.5909881592,-96.7396850586,-116.499427795
2025-07-02 14:58:14,628 - ERROR - SpurSearch test set 1 failed: 'tuple' object has no attribute 'items'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 315, in run_spur_search_measurement
    for freq_ghz, spurs in results_dict.items():
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'items'
2025-07-02 14:58:14,630 - INFO - Socket closed
2025-07-02 14:58:14,630 - INFO - FSW connection closed
2025-07-02 14:58:14,630 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:58:14,630 - INFO - Socket closed
2025-07-02 14:58:14,630 - INFO - VSG connection closed
2025-07-02 14:58:14,633 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:58:14,660 - INFO - Socket closed
2025-07-02 14:58:14,668 - INFO - Socket closed
2025-07-02 14:59:21,771 - INFO - Starting RF measurement script
2025-07-02 14:59:21,773 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:59:21,773 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:59:21,773 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:59:21,777 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:59:21,778 - INFO - Query: *IDN?
2025-07-02 14:59:21,779 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:59:21,781 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:59:21,781 - INFO - Query: *IDN?
2025-07-02 14:59:21,782 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:59:21,782 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:59:21,782 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, 2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 14:59:21,782 - INFO - Measuring spurs at fundamental frequency: 2.430 GHz
2025-07-02 14:59:21,782 - INFO - Query: *RST;*OPC?
2025-07-02 14:59:22,829 - INFO - Response: 1
2025-07-02 14:59:22,829 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 14:59:22,830 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 14:59:22,830 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 14:59:22,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 14:59:22,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -45
2025-07-02 14:59:22,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 14:59:22,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 14:59:22,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 14:59:22,831 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 14:59:22,831 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 14:59:25,688 - INFO - Socket closed
2025-07-02 14:59:25,697 - INFO - Socket closed
2025-07-02 14:59:30,104 - INFO - Starting RF measurement script
2025-07-02 14:59:30,107 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 14:59:30,107 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 14:59:30,108 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 14:59:30,113 - INFO - Connected to 192.168.200.20:5025
2025-07-02 14:59:30,114 - INFO - Query: *IDN?
2025-07-02 14:59:30,115 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 14:59:30,117 - INFO - Connected to 192.168.200.10:5025
2025-07-02 14:59:30,118 - INFO - Query: *IDN?
2025-07-02 14:59:30,118 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 14:59:30,118 - INFO - SpurSearch initialized: fundamental=[2.43, 2.44], RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 14:59:30,118 - ERROR - SpurSearch test set 1 failed: unsupported format string passed to list.__format__
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1304.py", line 499, in <module>
    print(f"SpurSearch Fundamental: {test['fundamental_frequency_ghz']:.3f} GHz")
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported format string passed to list.__format__
2025-07-02 14:59:30,120 - INFO - Socket closed
2025-07-02 14:59:30,120 - INFO - FSW connection closed
2025-07-02 14:59:30,120 - INFO - Write: OUTP:STAT OFF
2025-07-02 14:59:30,120 - INFO - Socket closed
2025-07-02 14:59:30,121 - INFO - VSG connection closed
2025-07-02 14:59:30,123 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 14:59:30,123 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 14:59:30,500 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 14:59:30,540 - INFO - Socket closed
2025-07-02 14:59:30,542 - INFO - Socket closed
2025-07-02 15:00:24,901 - INFO - Starting RF measurement script
2025-07-02 15:00:24,903 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 15:00:24,903 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 15:00:24,903 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 15:00:24,903 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 539, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", -70)  # Default to -70 dBm
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 15:00:24,906 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 15:00:24,906 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 15:00:25,154 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 15:00:34,934 - INFO - Starting RF measurement script
2025-07-02 15:00:34,935 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 15:00:34,935 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 15:00:34,936 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 15:00:34,936 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1328.py", line 505, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 15:00:34,938 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 15:00:34,938 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 15:00:35,239 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 15:00:51,890 - INFO - Starting RF measurement script
2025-07-02 15:00:51,892 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 15:00:51,892 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 15:00:51,892 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 15:00:51,892 - ERROR - SpurSearch test set 1 failed: can't multiply sequence by non-int of type 'float'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_worked_20250702_1304.py", line 492, in <module>
    spur_instr = SpurSearch(
        fundamental_ghz=test["fundamental_frequency_ghz"],
    ...<2 lines>...
        pwr=test.get("power_dbm", 0)
    )
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\measurements\spur_search.py", line 25, in __init__
    self.frequency = fundamental_ghz * 1e9
                     ~~~~~~~~~~~~~~~~^~~~~
TypeError: can't multiply sequence by non-int of type 'float'
2025-07-02 15:00:51,895 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 15:00:51,895 - WARNING - No test results generated. Creating empty DataFrame.
2025-07-02 15:00:52,156 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 15:09:32,493 - INFO - Starting RF measurement script
2025-07-02 15:09:32,495 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 15:09:32,495 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 15:09:32,495 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 15:09:32,495 - INFO - Initializing SpurSearch for 2.430 GHz
2025-07-02 15:09:32,500 - INFO - Connected to 192.168.200.20:5025
2025-07-02 15:09:32,500 - INFO - Query: *IDN?
2025-07-02 15:09:32,501 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 15:09:32,504 - INFO - Connected to 192.168.200.10:5025
2025-07-02 15:09:32,504 - INFO - Query: *IDN?
2025-07-02 15:09:32,505 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 15:09:32,505 - INFO - SpurSearch initialized: fundamental=2.43 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 15:09:32,505 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 15:09:32,505 - INFO - Query: *RST;*OPC?
2025-07-02 15:09:33,550 - INFO - Response: 1
2025-07-02 15:09:33,550 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 15:09:33,551 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 15:09:33,551 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 15:09:33,551 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 15:09:33,551 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 15:09:33,551 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 15:09:33,552 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 15:09:33,552 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 15:09:33,552 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 15:09:33,552 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 15:09:33,553 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 15:09:33,553 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 15:09:33,553 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 15:09:33,553 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 15:09:33,553 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 15:09:33,553 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 15:09:33,553 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 15:09:36,645 - INFO - Response: 1
2025-07-02 15:09:36,646 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 15:09:36,646 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 15:09:36,646 - INFO - Write: OUTPut1:STATe 1
2025-07-02 15:09:36,646 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 15:09:36,646 - INFO - Query: *RST;*OPC?
2025-07-02 15:09:36,841 - INFO - Response: 1
2025-07-02 15:09:36,842 - INFO - FSW reset for spur search
2025-07-02 15:09:36,842 - INFO - Write: INIT:CONT OFF
2025-07-02 15:09:36,842 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 15:09:36,842 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 15:09:36,842 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 15:09:36,842 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 15:09:36,842 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 15:09:36,842 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 15:09:36,843 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 15:09:36,843 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 15:09:36,843 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 15:09:36,843 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 15:09:36,843 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 15:09:36,843 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 15:09:36,843 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 15:09:36,843 - INFO - Write: :INP:ATT 0   
2025-07-02 15:09:36,843 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 15:09:36,843 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 15:09:36,843 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 15:09:36,843 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 15:09:36,843 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 15:09:36,843 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 15:09:36,843 - INFO - Write: CALC1:THR -122
2025-07-02 15:09:36,843 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 15:09:36,843 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 15:09:36,844 - INFO - Spur detection table configured
2025-07-02 15:09:36,844 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 15:09:36,844 - INFO - Write: :INIT:CONT OFF
2025-07-02 15:09:36,844 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 15:09:41,283 - INFO - Response: 1
2025-07-02 15:09:41,284 - INFO - Spur search measurement completed
2025-07-02 15:09:41,284 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 15:09:41,285 - INFO - Response: 6
2025-07-02 15:09:41,285 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 15:09:41,286 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 15:09:41,327 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3718800000,4017500000
2025-07-02 15:09:41,327 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 15:09:41,328 - INFO - Response: -115.907241821,-91.5219421387,-96.7182998657,-119.705528259,-121.516777039,-121.153320312
2025-07-02 15:09:41,329 - INFO - Spur 1: 1.430900 GHz, -115.91 dBm
2025-07-02 15:09:41,329 - INFO - Spur 2: 1.930000 GHz, -91.52 dBm
2025-07-02 15:09:41,329 - INFO - Spur 3: 3.030200 GHz, -96.72 dBm
2025-07-02 15:09:41,329 - INFO - Spur 4: 3.429100 GHz, -119.71 dBm
2025-07-02 15:09:41,329 - INFO - Spur 5: 3.718800 GHz, -121.52 dBm
2025-07-02 15:09:41,329 - INFO - Spur 6: 4.017500 GHz, -121.15 dBm
2025-07-02 15:09:41,329 - DEBUG - SpurSearch results for 2.430 GHz: ([(1430900000.0, -115.907241821), (1930000000.0, -91.5219421387), (3030200000.0, -96.7182998657), (3429100000.0, -119.705528259), (3718800000.0, -121.516777039), (4017500000.0, -121.153320312)], 0.04528560000471771)
2025-07-02 15:09:41,329 - ERROR - SpurSearch test set 1 failed: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 334, in run_spur_search_measurement
    "spurs": [{"frequency_hz": freq_hz, "power_dbm": power_dbm} for freq_hz, power_dbm in spurs],
                                                                    ^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025-07-02 15:09:41,331 - INFO - Socket closed
2025-07-02 15:09:41,331 - INFO - FSW connection closed
2025-07-02 15:09:41,332 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:09:41,332 - INFO - Socket closed
2025-07-02 15:09:41,332 - INFO - VSG connection closed
2025-07-02 15:09:41,332 - INFO - Initializing SpurSearch for 2.440 GHz
2025-07-02 15:09:41,335 - INFO - Connected to 192.168.200.20:5025
2025-07-02 15:09:41,335 - INFO - Query: *IDN?
2025-07-02 15:09:41,337 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 15:09:41,339 - INFO - Connected to 192.168.200.10:5025
2025-07-02 15:09:41,339 - INFO - Query: *IDN?
2025-07-02 15:09:41,341 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 15:09:41,341 - INFO - SpurSearch initialized: fundamental=2.44 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 15:09:41,342 - INFO - Socket closed
2025-07-02 15:09:41,342 - INFO - Socket closed
2025-07-02 15:09:41,342 - INFO - Starting SpurSearch test set 2: fundamental=2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 15:09:41,342 - INFO - Query: *RST;*OPC?
2025-07-02 15:09:42,389 - INFO - Response: 1
2025-07-02 15:09:42,390 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 15:09:42,390 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 15:09:42,390 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 15:09:42,390 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 15:09:42,390 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 15:09:42,390 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 15:09:42,390 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 15:09:42,390 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 15:09:42,391 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 15:09:42,391 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 15:09:45,212 - INFO - Response: 1
2025-07-02 15:09:45,213 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 15:09:45,213 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 15:09:45,213 - INFO - Write: OUTPut1:STATe 1
2025-07-02 15:09:45,213 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 15:09:45,213 - INFO - Query: *RST;*OPC?
2025-07-02 15:09:45,403 - INFO - Response: 1
2025-07-02 15:09:45,404 - INFO - FSW reset for spur search
2025-07-02 15:09:45,404 - INFO - Write: INIT:CONT OFF
2025-07-02 15:09:45,404 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 15:09:45,404 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 15:09:45,404 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 15:09:45,404 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 15:09:45,404 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 15:09:45,404 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 15:09:45,404 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 15:09:45,404 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 15:09:45,404 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 15:09:45,404 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 15:09:45,404 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 15:09:45,405 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 15:09:45,405 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 15:09:45,405 - INFO - Write: :INP:ATT 0   
2025-07-02 15:09:45,405 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 15:09:45,405 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 15:09:45,405 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 15:09:45,405 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 15:09:45,405 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 15:09:45,405 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 15:09:45,405 - INFO - Write: CALC1:THR -122
2025-07-02 15:09:45,405 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 15:09:45,405 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 15:09:45,405 - INFO - Spur detection table configured
2025-07-02 15:09:45,405 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 15:09:45,405 - INFO - Write: :INIT:CONT OFF
2025-07-02 15:09:45,405 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 15:09:49,818 - INFO - Response: 1
2025-07-02 15:09:49,818 - INFO - Spur search measurement completed
2025-07-02 15:09:49,819 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 15:09:49,820 - INFO - Response: 5
2025-07-02 15:09:49,820 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 15:09:49,820 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 15:09:49,864 - INFO - Response: 1440400000,1939700000,3040900000,3439600000,3869400000
2025-07-02 15:09:49,865 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 15:09:49,866 - INFO - Response: -115.837722778,-91.5901184082,-96.6899108887,-119.941688538,-121.702667236
2025-07-02 15:09:49,866 - INFO - Spur 1: 1.440400 GHz, -115.84 dBm
2025-07-02 15:09:49,866 - INFO - Spur 2: 1.939700 GHz, -91.59 dBm
2025-07-02 15:09:49,866 - INFO - Spur 3: 3.040900 GHz, -96.69 dBm
2025-07-02 15:09:49,866 - INFO - Spur 4: 3.439600 GHz, -119.94 dBm
2025-07-02 15:09:49,866 - INFO - Spur 5: 3.869400 GHz, -121.70 dBm
2025-07-02 15:09:49,866 - DEBUG - SpurSearch results for 2.440 GHz: ([(1440400000.0, -115.837722778), (1939700000.0, -91.5901184082), (3040900000.0, -96.6899108887), (3439600000.0, -119.941688538), (3869400000.0, -121.702667236)], 0.04726759996265173)
2025-07-02 15:09:49,866 - ERROR - SpurSearch test set 2 failed: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 334, in run_spur_search_measurement
    "spurs": [{"frequency_hz": freq_hz, "power_dbm": power_dbm} for freq_hz, power_dbm in spurs],
                                                                    ^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025-07-02 15:09:49,867 - INFO - Socket closed
2025-07-02 15:09:49,867 - INFO - FSW connection closed
2025-07-02 15:09:49,867 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:09:49,867 - INFO - Socket closed
2025-07-02 15:09:49,867 - INFO - VSG connection closed
2025-07-02 15:09:49,867 - INFO - Socket closed
2025-07-02 15:09:49,867 - INFO - FSW connection closed
2025-07-02 15:09:49,867 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:09:49,868 - ERROR - Write failed: OUTP:STAT OFF, Error: [WinError 10038] An operation was attempted on something that is not a socket
2025-07-02 15:09:49,868 - ERROR - Error closing connections: [WinError 10038] An operation was attempted on something that is not a socket
2025-07-02 15:09:49,870 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 15:09:50,129 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 15:09:50,171 - INFO - Socket closed
2025-07-02 15:09:50,172 - INFO - Socket closed
2025-07-02 15:18:10,460 - INFO - Starting RF measurement script
2025-07-02 15:18:10,463 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 15:18:10,463 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 15:18:10,463 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 15:18:10,464 - INFO - Initializing SpurSearch for 2.430 GHz
2025-07-02 15:18:10,469 - INFO - Connected to 192.168.200.20:5025
2025-07-02 15:18:10,469 - INFO - Query: *IDN?
2025-07-02 15:18:10,470 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 15:18:10,473 - INFO - Connected to 192.168.200.10:5025
2025-07-02 15:18:10,473 - INFO - Query: *IDN?
2025-07-02 15:18:10,474 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 15:18:10,474 - INFO - SpurSearch initialized: fundamental=2.43 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 15:18:10,474 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 15:18:10,474 - INFO - Query: *RST;*OPC?
2025-07-02 15:18:11,525 - INFO - Response: 1
2025-07-02 15:18:11,526 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 15:18:11,526 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 15:18:11,526 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 15:18:11,527 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 15:18:11,527 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 15:18:14,624 - INFO - Response: 1
2025-07-02 15:18:14,624 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 15:18:14,625 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 15:18:14,625 - INFO - Write: OUTPut1:STATe 1
2025-07-02 15:18:14,625 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 15:18:14,625 - INFO - Query: *RST;*OPC?
2025-07-02 15:18:14,818 - INFO - Response: 1
2025-07-02 15:18:14,818 - INFO - FSW reset for spur search
2025-07-02 15:18:14,818 - INFO - Write: INIT:CONT OFF
2025-07-02 15:18:14,818 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 15:18:14,818 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 15:18:14,818 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 15:18:14,818 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 15:18:14,818 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 15:18:14,818 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 15:18:14,818 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 15:18:14,818 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 15:18:14,819 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 15:18:14,819 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 15:18:14,819 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 15:18:14,819 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 15:18:14,819 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 15:18:14,819 - INFO - Write: :INP:ATT 0   
2025-07-02 15:18:14,819 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 15:18:14,819 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 15:18:14,819 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 15:18:14,819 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 15:18:14,819 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 15:18:14,819 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 15:18:14,819 - INFO - Write: CALC1:THR -122
2025-07-02 15:18:14,819 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 15:18:14,819 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 15:18:14,819 - INFO - Spur detection table configured
2025-07-02 15:18:14,819 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 15:18:14,819 - INFO - Write: :INIT:CONT OFF
2025-07-02 15:18:14,820 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 15:18:19,221 - INFO - Response: 1
2025-07-02 15:18:19,221 - INFO - Spur search measurement completed
2025-07-02 15:18:19,222 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 15:18:19,223 - INFO - Response: 4
2025-07-02 15:18:19,223 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 15:18:19,224 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 15:18:19,268 - INFO - Response: 1430900000,1930000000,3030200000,3429100000
2025-07-02 15:18:19,268 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 15:18:19,269 - INFO - Response: -115.73841095,-91.4977264404,-96.6855545044,-120.312286377
2025-07-02 15:18:19,269 - INFO - Spur 1: 1.430900 GHz, -115.74 dBm
2025-07-02 15:18:19,269 - INFO - Spur 2: 1.930000 GHz, -91.50 dBm
2025-07-02 15:18:19,269 - INFO - Spur 3: 3.030200 GHz, -96.69 dBm
2025-07-02 15:18:19,269 - INFO - Spur 4: 3.429100 GHz, -120.31 dBm
2025-07-02 15:18:19,269 - DEBUG - SpurSearch results for 2.430 GHz: [(1430900000.0, -115.73841095), (1930000000.0, -91.4977264404), (3030200000.0, -96.6855545044), (3429100000.0, -120.312286377)]
2025-07-02 15:18:19,270 - INFO - Socket closed
2025-07-02 15:18:19,270 - INFO - FSW connection closed
2025-07-02 15:18:19,270 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:18:19,270 - INFO - Socket closed
2025-07-02 15:18:19,270 - INFO - VSG connection closed
2025-07-02 15:18:19,270 - INFO - Socket closed
2025-07-02 15:18:19,270 - INFO - Socket closed
2025-07-02 15:18:19,270 - INFO - Initializing SpurSearch for 2.440 GHz
2025-07-02 15:18:19,274 - INFO - Connected to 192.168.200.20:5025
2025-07-02 15:18:19,274 - INFO - Query: *IDN?
2025-07-02 15:18:19,275 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 15:18:19,277 - INFO - Connected to 192.168.200.10:5025
2025-07-02 15:18:19,278 - INFO - Query: *IDN?
2025-07-02 15:18:19,279 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 15:18:19,280 - INFO - SpurSearch initialized: fundamental=2.44 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 15:18:19,280 - INFO - Starting SpurSearch test set 2: fundamental=2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 15:18:19,280 - INFO - Query: *RST;*OPC?
2025-07-02 15:18:20,328 - INFO - Response: 1
2025-07-02 15:18:20,328 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 15:18:20,328 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 15:18:20,328 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 15:18:20,328 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 15:18:20,328 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 15:18:20,328 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 15:18:20,329 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 15:18:20,329 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 15:18:23,151 - INFO - Response: 1
2025-07-02 15:18:23,151 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 15:18:23,151 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 15:18:23,151 - INFO - Write: OUTPut1:STATe 1
2025-07-02 15:18:23,151 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 15:18:23,151 - INFO - Query: *RST;*OPC?
2025-07-02 15:18:23,343 - INFO - Response: 1
2025-07-02 15:18:23,343 - INFO - FSW reset for spur search
2025-07-02 15:18:23,344 - INFO - Write: INIT:CONT OFF
2025-07-02 15:18:23,344 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 15:18:23,344 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 15:18:23,344 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 15:18:23,344 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 15:18:23,344 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 15:18:23,344 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 15:18:23,344 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 15:18:23,344 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 15:18:23,344 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 15:18:23,344 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 15:18:23,345 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 15:18:23,345 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 15:18:23,345 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 15:18:23,345 - INFO - Write: :INP:ATT 0   
2025-07-02 15:18:23,345 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 15:18:23,345 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 15:18:23,345 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 15:18:23,345 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 15:18:23,345 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 15:18:23,345 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 15:18:23,345 - INFO - Write: CALC1:THR -122
2025-07-02 15:18:23,345 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 15:18:23,346 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 15:18:23,346 - INFO - Spur detection table configured
2025-07-02 15:18:23,346 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 15:18:23,346 - INFO - Write: :INIT:CONT OFF
2025-07-02 15:18:23,346 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 15:18:27,766 - INFO - Response: 1
2025-07-02 15:18:27,767 - INFO - Spur search measurement completed
2025-07-02 15:18:27,767 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 15:18:27,768 - INFO - Response: 5
2025-07-02 15:18:27,768 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 15:18:27,768 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 15:18:27,809 - INFO - Response: 1440400000,1939700000,3040900000,3439600000,3838300000
2025-07-02 15:18:27,810 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 15:18:27,810 - INFO - Response: -115.987953186,-91.5915298462,-96.7018585205,-120.739280701,-121.286239624
2025-07-02 15:18:27,811 - INFO - Spur 1: 1.440400 GHz, -115.99 dBm
2025-07-02 15:18:27,811 - INFO - Spur 2: 1.939700 GHz, -91.59 dBm
2025-07-02 15:18:27,811 - INFO - Spur 3: 3.040900 GHz, -96.70 dBm
2025-07-02 15:18:27,811 - INFO - Spur 4: 3.439600 GHz, -120.74 dBm
2025-07-02 15:18:27,811 - INFO - Spur 5: 3.838300 GHz, -121.29 dBm
2025-07-02 15:18:27,811 - DEBUG - SpurSearch results for 2.440 GHz: [(1440400000.0, -115.987953186), (1939700000.0, -91.5915298462), (3040900000.0, -96.7018585205), (3439600000.0, -120.739280701), (3838300000.0, -121.286239624)]
2025-07-02 15:18:27,811 - INFO - Socket closed
2025-07-02 15:18:27,811 - INFO - FSW connection closed
2025-07-02 15:18:27,811 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:18:27,812 - INFO - Socket closed
2025-07-02 15:18:27,812 - INFO - VSG connection closed
2025-07-02 15:18:27,812 - INFO - Socket closed
2025-07-02 15:18:27,812 - INFO - Socket closed
2025-07-02 15:18:27,815 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 15:18:28,064 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 15:41:19,477 - INFO - Starting RF measurement script
2025-07-02 15:41:19,480 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\test_inputs.json
2025-07-02 15:41:19,480 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-02 15:41:19,481 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-02 15:41:19,481 - INFO - Initializing SpurSearch for 2.430 GHz
2025-07-02 15:41:19,487 - INFO - Connected to 192.168.200.20:5025
2025-07-02 15:41:19,487 - INFO - Query: *IDN?
2025-07-02 15:41:19,488 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 15:41:19,493 - INFO - Connected to 192.168.200.10:5025
2025-07-02 15:41:19,493 - INFO - Query: *IDN?
2025-07-02 15:41:19,494 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 15:41:19,494 - INFO - SpurSearch initialized: fundamental=2.43 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 15:41:19,494 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 15:41:19,494 - INFO - Query: *RST;*OPC?
2025-07-02 15:41:20,538 - INFO - Response: 1
2025-07-02 15:41:20,539 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-02 15:41:20,539 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 15:41:20,539 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 15:41:20,540 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 15:41:20,541 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 15:41:23,649 - INFO - Response: 1
2025-07-02 15:41:23,649 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 15:41:23,650 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 15:41:23,650 - INFO - Write: OUTPut1:STATe 1
2025-07-02 15:41:23,650 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-02 15:41:23,650 - INFO - Query: *RST;*OPC?
2025-07-02 15:41:23,845 - INFO - Response: 1
2025-07-02 15:41:23,845 - INFO - FSW reset for spur search
2025-07-02 15:41:23,845 - INFO - Write: INIT:CONT OFF
2025-07-02 15:41:23,845 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-02 15:41:23,845 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-02 15:41:23,845 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 15:41:23,845 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 15:41:23,845 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 15:41:23,845 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 15:41:23,846 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 15:41:23,846 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 15:41:23,846 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 15:41:23,846 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 15:41:23,846 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 15:41:23,846 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 15:41:23,846 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 15:41:23,846 - INFO - Write: :INP:ATT 0   
2025-07-02 15:41:23,846 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 15:41:23,846 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 15:41:23,846 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 15:41:23,846 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 15:41:23,846 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-02 15:41:23,846 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-02 15:41:23,846 - INFO - Write: CALC1:THR -122
2025-07-02 15:41:23,847 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 15:41:23,847 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 15:41:23,847 - INFO - Spur detection table configured
2025-07-02 15:41:23,847 - INFO - Range 1: 1.2152.429 GHz
2025-07-02 15:41:23,847 - INFO - Write: :INIT:CONT OFF
2025-07-02 15:41:23,847 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 15:41:28,283 - INFO - Response: 1
2025-07-02 15:41:28,283 - INFO - Spur search measurement completed
2025-07-02 15:41:28,283 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 15:41:28,284 - INFO - Response: 5
2025-07-02 15:41:28,284 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 15:41:28,284 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 15:41:28,340 - INFO - Response: 1430900000,1930000000,3030200000,3429100000,3962900000
2025-07-02 15:41:28,340 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 15:41:28,341 - INFO - Response: -115.982208252,-91.5224456787,-96.6211471558,-119.943527222,-121.326766968
2025-07-02 15:41:28,341 - INFO - Spur 1: 1.430900 GHz, -115.98 dBm
2025-07-02 15:41:28,342 - INFO - Spur 2: 1.930000 GHz, -91.52 dBm
2025-07-02 15:41:28,342 - INFO - Spur 3: 3.030200 GHz, -96.62 dBm
2025-07-02 15:41:28,342 - INFO - Spur 4: 3.429100 GHz, -119.94 dBm
2025-07-02 15:41:28,342 - INFO - Spur 5: 3.962900 GHz, -121.33 dBm
2025-07-02 15:41:28,342 - DEBUG - SpurSearch results for 2.430 GHz: [(1430900000.0, -115.982208252), (1930000000.0, -91.5224456787), (3030200000.0, -96.6211471558), (3429100000.0, -119.943527222), (3962900000.0, -121.326766968)]
2025-07-02 15:41:28,342 - INFO - Socket closed
2025-07-02 15:41:28,342 - INFO - FSW connection closed
2025-07-02 15:41:28,342 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:41:28,342 - INFO - Socket closed
2025-07-02 15:41:28,342 - INFO - VSG connection closed
2025-07-02 15:41:28,342 - INFO - Socket closed
2025-07-02 15:41:28,342 - INFO - Socket closed
2025-07-02 15:41:28,342 - INFO - Initializing SpurSearch for 2.440 GHz
2025-07-02 15:41:28,345 - INFO - Connected to 192.168.200.20:5025
2025-07-02 15:41:28,345 - INFO - Query: *IDN?
2025-07-02 15:41:28,346 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-02 15:41:28,348 - INFO - Connected to 192.168.200.10:5025
2025-07-02 15:41:28,349 - INFO - Query: *IDN?
2025-07-02 15:41:28,350 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-02 15:41:28,351 - INFO - SpurSearch initialized: fundamental=2.44 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-02 15:41:28,351 - INFO - Starting SpurSearch test set 2: fundamental=2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-02 15:41:28,351 - INFO - Query: *RST;*OPC?
2025-07-02 15:41:29,399 - INFO - Response: 1
2025-07-02 15:41:29,399 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-02 15:41:29,399 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-02 15:41:29,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-02 15:41:29,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-02 15:41:29,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-02 15:41:29,399 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-02 15:41:29,400 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-02 15:41:29,400 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-02 15:41:32,223 - INFO - Response: 1
2025-07-02 15:41:32,223 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-02 15:41:32,224 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-02 15:41:32,224 - INFO - Write: OUTPut1:STATe 1
2025-07-02 15:41:32,224 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-02 15:41:32,224 - INFO - Query: *RST;*OPC?
2025-07-02 15:41:32,414 - INFO - Response: 1
2025-07-02 15:41:32,414 - INFO - FSW reset for spur search
2025-07-02 15:41:32,414 - INFO - Write: INIT:CONT OFF
2025-07-02 15:41:32,415 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-02 15:41:32,415 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-02 15:41:32,415 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-02 15:41:32,415 - INFO - Write: :SENS:AVER:COUN 5
2025-07-02 15:41:32,415 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-02 15:41:32,415 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-02 15:41:32,416 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-02 15:41:32,416 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-02 15:41:32,416 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-02 15:41:32,416 - INFO - Write: SENS:SWE:OPT SPE
2025-07-02 15:41:32,416 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-02 15:41:32,416 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-02 15:41:32,416 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-02 15:41:32,416 - INFO - Write: :INP:ATT 0   
2025-07-02 15:41:32,417 - INFO - Write: INP:GAIN:STAT ON
2025-07-02 15:41:32,417 - INFO - Write: INP:GAIN:VAL 30
2025-07-02 15:41:32,417 - INFO - Write: SENS:POW:NCOR ON
2025-07-02 15:41:32,417 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-02 15:41:32,417 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-02 15:41:32,417 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-02 15:41:32,417 - INFO - Write: CALC1:THR -122
2025-07-02 15:41:32,417 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-02 15:41:32,417 - INFO - Write: CALC1:THR:STAT ON
2025-07-02 15:41:32,417 - INFO - Spur detection table configured
2025-07-02 15:41:32,417 - INFO - Range 1: 1.2202.439 GHz
2025-07-02 15:41:32,417 - INFO - Write: :INIT:CONT OFF
2025-07-02 15:41:32,417 - INFO - Query: INIT:IMM;*OPC?
2025-07-02 15:41:36,837 - INFO - Response: 1
2025-07-02 15:41:36,837 - INFO - Spur search measurement completed
2025-07-02 15:41:36,837 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-02 15:41:36,838 - INFO - Response: 5
2025-07-02 15:41:36,839 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-02 15:41:36,839 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-02 15:41:36,882 - INFO - Response: 1440400000,1939700000,3040900000,3439600000,3915200000
2025-07-02 15:41:36,882 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-02 15:41:36,883 - INFO - Response: -115.957214355,-91.5772171021,-96.6602783203,-119.843536377,-121.464889526
2025-07-02 15:41:36,883 - INFO - Spur 1: 1.440400 GHz, -115.96 dBm
2025-07-02 15:41:36,883 - INFO - Spur 2: 1.939700 GHz, -91.58 dBm
2025-07-02 15:41:36,883 - INFO - Spur 3: 3.040900 GHz, -96.66 dBm
2025-07-02 15:41:36,883 - INFO - Spur 4: 3.439600 GHz, -119.84 dBm
2025-07-02 15:41:36,883 - INFO - Spur 5: 3.915200 GHz, -121.46 dBm
2025-07-02 15:41:36,883 - DEBUG - SpurSearch results for 2.440 GHz: [(1440400000.0, -115.957214355), (1939700000.0, -91.5772171021), (3040900000.0, -96.6602783203), (3439600000.0, -119.843536377), (3915200000.0, -121.464889526)]
2025-07-02 15:41:36,883 - INFO - Socket closed
2025-07-02 15:41:36,884 - INFO - FSW connection closed
2025-07-02 15:41:36,884 - INFO - Write: OUTP:STAT OFF
2025-07-02 15:41:36,884 - INFO - Socket closed
2025-07-02 15:41:36,884 - INFO - VSG connection closed
2025-07-02 15:41:36,884 - INFO - Socket closed
2025-07-02 15:41:36,884 - INFO - Socket closed
2025-07-02 15:41:36,886 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.json
2025-07-02 15:41:37,136 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-02 15:41:37,139 - ERROR - Error formatting Spur columns: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\main_grok.py", line 751, in <module>
    df["Fundamental Frequency (GHz)"] = df["Fundamental Frequency (GHz)"].map("{:.3f}".format,
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
                                                                              na_action='ignore')
                                                                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\core\series.py", line 4711, in map
    new_values = self._map_values(arg, na_action=na_action)
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\.venv\Lib\site-packages\pandas\core\algorithms.py", line 1745, in map_array
    return lib.map_infer_mask(
           ~~~~~~~~~~~~~~~~~~^
        values, mapper, mask=isna(values).view(np.uint8), convert=convert
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
ValueError: Unknown format code 'f' for object of type 'str'
2025-07-02 15:41:37,157 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250701_STN_5G_LTE_Spur_tests\src\results_output.xlsx
2025-07-07 12:56:23,472 - INFO - Starting RF measurement script
2025-07-07 12:56:23,477 - INFO - Loaded test inputs from C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\src\test_inputs.json
2025-07-07 12:56:23,478 - DEBUG - Test inputs: {
  "lte": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.201,
        6.501
      ],
      "power_dbm": [
        -10.0,
        -9.0,
        -8.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 5,
      "modulation_type": "QPSK",
      "duplexing": "TDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.423
      ],
      "power_dbm": [
        -12.0,
        -11.0,
        -10.0
      ],
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QAM16",
      "duplexing": "FDD",
      "link_direction": "UL",
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "nr5g": [
    {
      "run": false,
      "center_frequency_ghz": [
        6.123,
        6.223
      ],
      "power_dbm": [
        -15,
        -5.0,
        -1.0
      ],
      "resource_blocks": 51,
      "resource_block_offset": 0,
      "channel_bandwidth_mhz": 20,
      "modulation_type": "QAM256",
      "duplexing": "FDD",
      "link_direction": "UL",
      "subcarrier_spacing_khz": 30,
      "measure_ch_pwr": true,
      "measure_aclr": true
    },
    {
      "run": false,
      "center_frequency_ghz": [
        6.323,
        6.423
      ],
      "power_dbm": [
        -7.0,
        -5.0,
        -3.0
      ],
      "resource_blocks": 25,
      "resource_block_offset": 5,
      "channel_bandwidth_mhz": 10,
      "modulation_type": "QPSK",
      "subcarrier_spacing_khz": 15,
      "measure_ch_pwr": true,
      "measure_aclr": true
    }
  ],
  "STN": [
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 0.617,
          "stop_ghz": 0.961,
          "step_mhz": 10
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "iterations": 1
    },
    {
      "run": false,
      "center_frequency_ghz": [
        2.483,
        5.75
      ],
      "iterations": 10
    }
  ],
  "spur_search": [
    {
      "run": true,
      "fundamental_frequency_ghz": [
        2.43,
        2.44
      ],
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    },
    {
      "run": false,
      "fundamental_frequency_ghz": {
        "range": {
          "start_ghz": 2.4,
          "stop_ghz": 2.481,
          "step_mhz": 20
        }
      },
      "rbw_mhz": 0.02,
      "spur_limit_dbm": -122,
      "power_dbm": -70
    }
  ]
}
2025-07-07 12:56:23,478 - DEBUG - Processing SpurSearch test: {'run': True, 'fundamental_frequency_ghz': [2.43, 2.44], 'rbw_mhz': 0.02, 'spur_limit_dbm': -122, 'power_dbm': -70}
2025-07-07 12:56:23,479 - INFO - Initializing SpurSearch for 2.430 GHz
2025-07-07 12:56:23,491 - INFO - Connected to 192.168.200.20:5025
2025-07-07 12:56:23,492 - INFO - Query: *IDN?
2025-07-07 12:56:23,508 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-07 12:56:23,514 - INFO - Connected to 192.168.200.10:5025
2025-07-07 12:56:23,514 - INFO - Query: *IDN?
2025-07-07 12:56:23,516 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-07 12:56:23,516 - INFO - SpurSearch initialized: fundamental=2.43 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-07 12:56:23,517 - INFO - Starting SpurSearch test set 1: fundamental=2.430 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-07 12:56:23,517 - INFO - Query: *RST;*OPC?
2025-07-07 12:56:25,006 - INFO - Response: 1
2025-07-07 12:56:25,006 - INFO - Write: SOUR:FREQ:CW 2430000000
2025-07-07 12:56:25,007 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-07 12:56:25,007 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-07 12:56:25,008 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-07 12:56:25,008 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-07 12:56:25,008 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-07 12:56:25,008 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-07 12:56:25,008 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-07 12:56:25,009 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-07 12:56:25,010 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-07 12:56:28,378 - INFO - Response: 1
2025-07-07 12:56:28,378 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-07 12:56:28,378 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-07 12:56:28,378 - INFO - Write: OUTPut1:STATe 1
2025-07-07 12:56:28,379 - INFO - VSG set: frequency=2.430 GHz, power=-70.00 dBm
2025-07-07 12:56:28,379 - INFO - Query: *RST;*OPC?
2025-07-07 12:56:30,297 - INFO - Response: 1
2025-07-07 12:56:30,298 - INFO - FSW reset for spur search
2025-07-07 12:56:30,298 - INFO - Write: INIT:CONT OFF
2025-07-07 12:56:30,298 - INFO - Write: SENS:FREQ:STAR 1215000000
2025-07-07 12:56:30,298 - INFO - Write: SENS:FREQ:STOP 4860000000
2025-07-07 12:56:30,298 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-07 12:56:30,299 - INFO - Write: :SENS:AVER:COUN 5
2025-07-07 12:56:30,299 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-07 12:56:30,299 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-07 12:56:30,299 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-07 12:56:30,299 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-07 12:56:30,299 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-07 12:56:30,300 - INFO - Write: SENS:SWE:OPT SPE
2025-07-07 12:56:30,300 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-07 12:56:30,300 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-07 12:56:30,300 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-07 12:56:30,300 - INFO - Write: :INP:ATT 0   
2025-07-07 12:56:30,300 - INFO - Write: INP:GAIN:STAT ON
2025-07-07 12:56:30,300 - INFO - Write: INP:GAIN:VAL 30
2025-07-07 12:56:30,300 - INFO - Write: SENS:POW:NCOR ON
2025-07-07 12:56:30,300 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-07 12:56:30,300 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1215000000.0
2025-07-07 12:56:30,300 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4860000000.0
2025-07-07 12:56:30,300 - INFO - Write: CALC1:THR -122
2025-07-07 12:56:30,300 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-07 12:56:30,300 - INFO - Write: CALC1:THR:STAT ON
2025-07-07 12:56:30,300 - INFO - Spur detection table configured
2025-07-07 12:56:30,301 - INFO - Range 1: 1.2152.429 GHz
2025-07-07 12:56:30,301 - INFO - Write: :INIT:CONT OFF
2025-07-07 12:56:30,301 - INFO - Query: INIT:IMM;*OPC?
2025-07-07 12:56:34,735 - INFO - Response: 1
2025-07-07 12:56:34,735 - INFO - Spur search measurement completed
2025-07-07 12:56:34,736 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-07 12:56:34,743 - INFO - Response: 4
2025-07-07 12:56:34,743 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-07 12:56:34,743 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-07 12:56:34,796 - INFO - Response: 1430900000,1930000000,3030200000,3429100000
2025-07-07 12:56:34,796 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-07 12:56:34,797 - INFO - Response: -115.929801941,-91.590927124,-96.7116012573,-120.875137329
2025-07-07 12:56:34,797 - INFO - Spur 1: 1.430900 GHz, -115.93 dBm
2025-07-07 12:56:34,797 - INFO - Spur 2: 1.930000 GHz, -91.59 dBm
2025-07-07 12:56:34,797 - INFO - Spur 3: 3.030200 GHz, -96.71 dBm
2025-07-07 12:56:34,797 - INFO - Spur 4: 3.429100 GHz, -120.88 dBm
2025-07-07 12:56:34,797 - DEBUG - SpurSearch results for 2.430 GHz: [(1430900000.0, -115.929801941), (1930000000.0, -91.590927124), (3030200000.0, -96.7116012573), (3429100000.0, -120.875137329)]
2025-07-07 12:56:34,798 - INFO - Socket closed
2025-07-07 12:56:34,798 - INFO - FSW connection closed
2025-07-07 12:56:34,798 - INFO - Write: OUTP:STAT OFF
2025-07-07 12:56:34,798 - INFO - Socket closed
2025-07-07 12:56:34,798 - INFO - VSG connection closed
2025-07-07 12:56:34,798 - INFO - Socket closed
2025-07-07 12:56:34,798 - INFO - Socket closed
2025-07-07 12:56:34,798 - INFO - Initializing SpurSearch for 2.440 GHz
2025-07-07 12:56:34,800 - INFO - Connected to 192.168.200.20:5025
2025-07-07 12:56:34,801 - INFO - Query: *IDN?
2025-07-07 12:56:34,803 - INFO - Response: Rohde&Schwarz,FSW-50,1331.5003K50/101878,6.20
2025-07-07 12:56:34,805 - INFO - Connected to 192.168.200.10:5025
2025-07-07 12:56:34,805 - INFO - Query: *IDN?
2025-07-07 12:56:34,807 - INFO - Response: Rohde&Schwarz,SMW200A,1412.0000K02/111891,5.30.305.48
2025-07-07 12:56:34,807 - INFO - SpurSearch initialized: fundamental=2.44 GHz, RBW=0.02 MHz, spur_limit=-122 dBm, VSG_power=-70 dBm
2025-07-07 12:56:34,807 - INFO - Starting SpurSearch test set 2: fundamental=2.440 GHz, RBW=0.020 MHz, limit=-122.00 dBm, power=-70.00 dBm
2025-07-07 12:56:34,807 - INFO - Query: *RST;*OPC?
2025-07-07 12:56:35,861 - INFO - Response: 1
2025-07-07 12:56:35,862 - INFO - Write: SOUR:FREQ:CW 2440000000
2025-07-07 12:56:35,862 - INFO - Write: SOUR:POW:LEV:IMM:AMPL -70.00
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:MODE ARB
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:COUNt 4
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:FREQuency -1000000000
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:FREQuency -500000000
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:FREQuency 600000000
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:FREQuency 1000000000
2025-07-07 12:56:35,862 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:POWer -45
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:POWer -20
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:POWer -25
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:POWer -50
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier1:STATe 1
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier2:STATe 1
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier3:STATe 1
2025-07-07 12:56:35,863 - INFO - Write: SOURce1:BB:ARBitrary:MCARrier:CARRier4:STATe 1
2025-07-07 12:56:35,863 - INFO - Query: SOURce1:BB:ARBitrary:MCARrier:CLOad;*OPC?
2025-07-07 12:56:38,695 - INFO - Response: 1
2025-07-07 12:56:38,695 - INFO - Write: SOURce1:BB:ARBitrary:TRIGger:OUTPut1:MODE REST
2025-07-07 12:56:38,695 - INFO - Write: SOURce1:BB:ARBitrary:STATe 1
2025-07-07 12:56:38,695 - INFO - Write: OUTPut1:STATe 1
2025-07-07 12:56:38,696 - INFO - VSG set: frequency=2.440 GHz, power=-70.00 dBm
2025-07-07 12:56:38,696 - INFO - Query: *RST;*OPC?
2025-07-07 12:56:38,973 - INFO - Response: 1
2025-07-07 12:56:38,973 - INFO - FSW reset for spur search
2025-07-07 12:56:38,973 - INFO - Write: INIT:CONT OFF
2025-07-07 12:56:38,973 - INFO - Write: SENS:FREQ:STAR 1220000000
2025-07-07 12:56:38,974 - INFO - Write: SENS:FREQ:STOP 4880000000
2025-07-07 12:56:38,974 - INFO - Write: :DISP:WIND1:SUBW:TRAC1:MODE AVER
2025-07-07 12:56:38,974 - INFO - Write: :SENS:AVER:COUN 5
2025-07-07 12:56:38,974 - INFO - Write: :SENS:WIND1:DET1:FUNC RMS
2025-07-07 12:56:38,974 - INFO - Write: :SENS:LIST:RANG1:FILT:TYPE NORM
2025-07-07 12:56:38,974 - INFO - Write: :SENS:BAND:RES 20000.0
2025-07-07 12:56:38,974 - INFO - Write: :SENS:SWE:TIME:AUTO ON
2025-07-07 12:56:38,974 - INFO - Write: SENS:SWE:TYPE FFT
2025-07-07 12:56:38,974 - INFO - Write: SENS:SWE:OPT SPE
2025-07-07 12:56:38,974 - INFO - Write: SENS:SWE:WIND1:POIN 2001
2025-07-07 12:56:38,974 - INFO - Write: DISP:WIND1:TRAC:Y:SCAL:RLEV -40
2025-07-07 12:56:38,974 - INFO - Write: SENS:INP:ATT:AUTO OFF
2025-07-07 12:56:38,974 - INFO - Write: :INP:ATT 0   
2025-07-07 12:56:38,974 - INFO - Write: INP:GAIN:STAT ON
2025-07-07 12:56:38,974 - INFO - Write: INP:GAIN:VAL 30
2025-07-07 12:56:38,974 - INFO - Write: SENS:POW:NCOR ON
2025-07-07 12:56:38,974 - INFO - Write: CALC1:MARK1:FUNC:FPE:STAT ON
2025-07-07 12:56:38,975 - INFO - Write: CALC1:MARK1:X:SLIM:LEFT 1220000000.0
2025-07-07 12:56:38,975 - INFO - Write: CALC1:MARK1:X:SLIM:RIGH 4880000000.0
2025-07-07 12:56:38,975 - INFO - Write: CALC1:THR -122
2025-07-07 12:56:38,975 - INFO - Write: CALC1:MARK1:X:SLIM:STAT ON
2025-07-07 12:56:38,975 - INFO - Write: CALC1:THR:STAT ON
2025-07-07 12:56:38,975 - INFO - Spur detection table configured
2025-07-07 12:56:38,975 - INFO - Range 1: 1.2202.439 GHz
2025-07-07 12:56:38,975 - INFO - Write: :INIT:CONT OFF
2025-07-07 12:56:38,975 - INFO - Query: INIT:IMM;*OPC?
2025-07-07 12:56:43,304 - INFO - Response: 1
2025-07-07 12:56:43,305 - INFO - Spur search measurement completed
2025-07-07 12:56:43,305 - INFO - Query: :CALC:MARK:FUNC:FPE:COUN?
2025-07-07 12:56:43,306 - INFO - Response: 5
2025-07-07 12:56:43,306 - INFO - Write: DISP:WIND1:SUBW:TRAC1:Y:SCAL:AUTO ONCE
2025-07-07 12:56:43,306 - INFO - Query: :CALC:MARK:FUNC:FPE:X?
2025-07-07 12:56:43,353 - INFO - Response: 1440400000,1939700000,3040900000,3439600000,3918800000
2025-07-07 12:56:43,354 - INFO - Query: :CALC:MARK:FUNC:FPE:Y?
2025-07-07 12:56:43,355 - INFO - Response: -116.047683716,-91.6228561401,-96.723487854,-120.262428284,-121.68875885
2025-07-07 12:56:43,355 - INFO - Spur 1: 1.440400 GHz, -116.05 dBm
2025-07-07 12:56:43,355 - INFO - Spur 2: 1.939700 GHz, -91.62 dBm
2025-07-07 12:56:43,355 - INFO - Spur 3: 3.040900 GHz, -96.72 dBm
2025-07-07 12:56:43,355 - INFO - Spur 4: 3.439600 GHz, -120.26 dBm
2025-07-07 12:56:43,355 - INFO - Spur 5: 3.918800 GHz, -121.69 dBm
2025-07-07 12:56:43,355 - DEBUG - SpurSearch results for 2.440 GHz: [(1440400000.0, -116.047683716), (1939700000.0, -91.6228561401), (3040900000.0, -96.723487854), (3439600000.0, -120.262428284), (3918800000.0, -121.68875885)]
2025-07-07 12:56:43,356 - INFO - Socket closed
2025-07-07 12:56:43,356 - INFO - FSW connection closed
2025-07-07 12:56:43,356 - INFO - Write: OUTP:STAT OFF
2025-07-07 12:56:43,356 - INFO - Socket closed
2025-07-07 12:56:43,357 - INFO - VSG connection closed
2025-07-07 12:56:43,357 - INFO - Socket closed
2025-07-07 12:56:43,357 - INFO - Socket closed
2025-07-07 12:56:43,359 - INFO - Saved results to: C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\src\results_output.json
2025-07-07 12:56:43,583 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\src\results_output.xlsx
2025-07-07 12:56:43,583 - ERROR - Error formatting Spur columns: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\src\main_grok.py", line 751, in <module>
    df["Fundamental Frequency (GHz)"] = df["Fundamental Frequency (GHz)"].map("{:.3f}".format,
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
                                                                              na_action='ignore')
                                                                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\.venv\Lib\site-packages\pandas\core\series.py", line 4711, in map
    new_values = self._map_values(arg, na_action=na_action)
  File "C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\.venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\.venv\Lib\site-packages\pandas\core\algorithms.py", line 1745, in map_array
    return lib.map_infer_mask(
           ~~~~~~~~~~~~~~~~~~^
        values, mapper, mask=isna(values).view(np.uint8), convert=convert
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
ValueError: Unknown format code 'f' for object of type 'str'
2025-07-07 12:56:43,599 - INFO - Successfully saved to: C:\Users\LINER\Documents\PycharmProjects\20250708_STN_5GNR_LTE_Spur_Test_Project\src\results_output.xlsx
